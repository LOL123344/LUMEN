[{"path":"create_stream_hash\\create_stream_hash_zip_tld_download.yml","content":"title: Potentially Suspicious File Download From ZIP TLD\nid: 0bb4bbeb-fe52-4044-b40c-430a04577ebe\nstatus: test\ndescription: Detects the download of a file with a potentially suspicious extension from a .zip top level domain.\nreferences:\n    - https://twitter.com/cyb3rops/status/1659175181695287297\n    - https://fabian-voith.de/2020/06/25/sysmon-v11-1-reads-alternate-data-streams/\nauthor: Florian Roth (Nextron Systems)\ndate: 2023-05-18\ntags:\n    - attack.defense-evasion\nlogsource:\n    product: windows\n    category: create_stream_hash\ndetection:\n    selection:\n        Contents|contains: '.zip/'\n        TargetFilename|contains:\n            - '.bat:Zone'\n            - '.dat:Zone'\n            - '.dll:Zone'\n            - '.doc:Zone'\n            - '.docm:Zone'\n            - '.exe:Zone'\n            - '.hta:Zone'\n            - '.pptm:Zone'\n            - '.ps1:Zone'\n            - '.rar:Zone'\n            - '.rtf:Zone'\n            - '.sct:Zone'\n            - '.vbe:Zone'\n            - '.vbs:Zone'\n            - '.ws:Zone'\n            - '.wsf:Zone'\n            - '.xll:Zone'\n            - '.xls:Zone'\n            - '.xlsm:Zone'\n            - '.zip:Zone'\n    condition: selection\nfalsepositives:\n    - Legitimate file downloads from a websites and web services that uses the \".zip\" top level domain.\nlevel: high\n"},{"path":"create_stream_hash\\create_stream_hash_winget_susp_package_source.yml","content":"title: Potential Suspicious Winget Package Installation\nid: a3f5c081-e75b-43a0-9f5b-51f26fe5dba2\nstatus: test\ndescription: Detects potential suspicious winget package installation from a suspicious source.\nreferences:\n    - https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-04-18\ntags:\n    - attack.defense-evasion\n    - attack.persistence\nlogsource:\n    product: windows\n    category: create_stream_hash\ndetection:\n    selection:\n        Contents|startswith: '[ZoneTransfer]  ZoneId=3'\n        Contents|contains:\n            # Note: Add any untrusted sources that are custom to your env\n            - '://1'\n            - '://2'\n            - '://3'\n            - '://4'\n            - '://5'\n            - '://6'\n            - '://7'\n            - '://8'\n            - '://9'\n        TargetFilename|endswith: ':Zone.Identifier'\n        TargetFilename|contains: '\\AppData\\Local\\Temp\\WinGet\\'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"create_stream_hash\\create_stream_hash_susp_ip_domains.yml","content":"title: Unusual File Download from Direct IP Address\nid: 025bd229-fd1f-4fdb-97ab-20006e1a5368\nstatus: test\ndescription: Detects the download of suspicious file type from URLs with IP\nreferences:\n    - https://github.com/trustedsec/SysmonCommunityGuide/blob/adcdfee20999f422b974c8d4149bf4c361237db7/chapters/file-stream-creation-hash.md\n    - https://labs.withsecure.com/publications/detecting-onenote-abuse\nauthor: Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)\ndate: 2022-09-07\nmodified: 2023-02-10\ntags:\n    - attack.defense-evasion\n    - attack.t1564.004\nlogsource:\n    product: windows\n    category: create_stream_hash\ndetection:\n    selection:\n        Contents|re: 'http[s]?://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}'\n        TargetFilename|contains:\n            - '.ps1:Zone'\n            - '.bat:Zone'\n            - '.exe:Zone'\n            - '.vbe:Zone'\n            - '.vbs:Zone'\n            - '.dll:Zone'\n            - '.one:Zone'\n            - '.cmd:Zone'\n            - '.hta:Zone'\n            - '.xll:Zone'\n            - '.lnk:Zone'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"create_stream_hash\\create_stream_hash_regedit_export_to_ads.yml","content":"title: Exports Registry Key To an Alternate Data Stream\nid: 0d7a9363-af70-4e7b-a3b7-1a176b7fbe84\nstatus: test\ndescription: Exports the target Registry key and hides it in the specified alternate data stream.\nreferences:\n    - https://lolbas-project.github.io/lolbas/Binaries/Regedit/\n    - https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f\nauthor: Oddvar Moe, Sander Wiebing, oscd.community\ndate: 2020-10-07\nmodified: 2021-11-27\ntags:\n    - attack.defense-evasion\n    - attack.t1564.004\nlogsource:\n    product: windows\n    category: create_stream_hash\ndetection:\n    selection:\n        Image|endswith: '\\regedit.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"create_stream_hash\\create_stream_hash_hktl_generic_download.yml","content":"title: HackTool Named File Stream Created\nid: 19b041f6-e583-40dc-b842-d6fa8011493f\nstatus: test\ndescription: Detects the creation of a named file stream with the imphash of a well-known hack tool\nreferences:\n    - https://github.com/gentilkiwi/mimikatz\n    - https://github.com/topotam/PetitPotam\n    - https://github.com/ohpe/juicy-potato\n    - https://github.com/antonioCoco/RoguePotato\n    - https://www.tarasco.org/security/pwdump_7/\n    - https://github.com/fortra/nanodump\n    - https://github.com/codewhitesec/HandleKatz\n    - https://github.com/xuanxuan0/DripLoader\n    - https://github.com/hfiref0x/UACME\n    - https://github.com/outflanknl/Dumpert\n    - https://github.com/wavestone-cdt/EDRSandblast\nauthor: Florian Roth (Nextron Systems)\ndate: 2022-08-24\nmodified: 2024-11-23\ntags:\n    - attack.defense-evasion\n    - attack.s0139\n    - attack.t1564.004\nlogsource:\n    product: windows\n    category: create_stream_hash\n    definition: 'Requirements: Sysmon config with Imphash logging activated'\ndetection:\n    selection:\n        Hash|contains: # Sysmon field hashes contains all types\n            - IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932 # PetitPotam\n            - IMPHASH=3A19059BD7688CB88E70005F18EFC439 # PetitPotam\n            - IMPHASH=bf6223a49e45d99094406777eb6004ba # PetitPotam\n            - IMPHASH=0C106686A31BFE2BA931AE1CF6E9DBC6 # Mimikatz\n            - IMPHASH=0D1447D4B3259B3C2A1D4CFB7ECE13C3 # Mimikatz\n            - IMPHASH=1B0369A1E06271833F78FFA70FFB4EAF # Mimikatz\n            - IMPHASH=4C1B52A19748428E51B14C278D0F58E3 # Mimikatz\n            - IMPHASH=4D927A711F77D62CEBD4F322CB57EC6F # Mimikatz\n            - IMPHASH=66EE036DF5FC1004D9ED5E9A94A1086A # Mimikatz\n            - IMPHASH=672B13F4A0B6F27D29065123FE882DFC # Mimikatz\n            - IMPHASH=6BBD59CEA665C4AFCC2814C1327EC91F # Mimikatz\n            - IMPHASH=725BB81DC24214F6ECACC0CFB36AD30D # Mimikatz\n            - IMPHASH=9528A0E91E28FBB88AD433FEABCA2456 # Mimikatz\n            - IMPHASH=9DA6D5D77BE11712527DCAB86DF449A3 # Mimikatz\n            - IMPHASH=A6E01BC1AB89F8D91D9EAB72032AAE88 # Mimikatz\n            - IMPHASH=B24C5EDDAEA4FE50C6A96A2A133521E4 # Mimikatz\n            - IMPHASH=D21BBC50DCC169D7B4D0F01962793154 # Mimikatz\n            - IMPHASH=FCC251CCEAE90D22C392215CC9A2D5D6 # Mimikatz\n            - IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1 # JuicyPotato\n            - IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC # JuicyPotato\n            - IMPHASH=F9A28C458284584A93B14216308D31BD # JuicyPotatoNG\n            - IMPHASH=6118619783FC175BC7EBECFF0769B46E # RoguePotato\n            - IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA # RoguePotato\n            - IMPHASH=563233BFA169ACC7892451F71AD5850A # RoguePotato\n            - IMPHASH=87575CB7A0E0700EB37F2E3668671A08 # RoguePotato\n            - IMPHASH=13F08707F759AF6003837A150A371BA1 # Pwdump\n            - IMPHASH=1781F06048A7E58B323F0B9259BE798B # Pwdump\n            - IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5 # Pwdump\n            - IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D # Pwdump\n            - IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2 # Pwdump\n            - IMPHASH=713C29B396B907ED71A72482759ED757 # Pwdump\n            - IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F # Pwdump\n            - IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E # Pwdump\n            - IMPHASH=8B114550386E31895DFAB371E741123D # Pwdump\n            - IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793 # PwDumpX\n            - IMPHASH=9D68781980370E00E0BD939EE5E6C141 # Pwdump\n            - IMPHASH=B18A1401FF8F444056D29450FBC0A6CE # Pwdump\n            - IMPHASH=CB567F9498452721D77A451374955F5F # Pwdump\n            - IMPHASH=730073214094CD328547BF1F72289752 # Htran\n            - IMPHASH=17B461A082950FC6332228572138B80C # Cobalt Strike beacons\n            - IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9 # Cobalt Strike beacons\n            - IMPHASH=819B19D53CA6736448F9325A85736792 # Cobalt Strike beacons\n            - IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E # Cobalt Strike beacons\n            - IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74 # PPLDump\n            - IMPHASH=0588081AB0E63BA785938467E1B10CCA # PPLDump\n            - IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C # NanoDump\n            - IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29 # NanoDump\n            - IMPHASH=4DA924CF622D039D58BCE71CDF05D242 # NanoDump\n            - IMPHASH=E7A3A5C377E2D29324093377D7DB1C66 # NanoDump\n            - IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF # NanoDump\n            - IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE # NanoDump\n            - IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4 # NanoDump\n            - IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338 # NanoDump\n            - IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E # NanoDump\n            - IMPHASH=E6F9D5152DA699934B30DAAB206471F6 # NanoDump\n            - IMPHASH=3AD59991CCF1D67339B319B15A41B35D # NanoDump\n            - IMPHASH=FFDD59E0318B85A3E480874D9796D872 # NanoDump\n            - IMPHASH=0CF479628D7CC1EA25EC7998A92F5051 # NanoDump\n            - IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51 # NanoDump\n            - IMPHASH=D6D0F80386E1380D05CB78E871BC72B1 # NanoDump\n            - IMPHASH=38D9E015591BBFD4929E0D0F47FA0055 # HandleKatz\n            - IMPHASH=0E2216679CA6E1094D63322E3412D650 # HandleKatz\n            - IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB # DripLoader\n            - IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798 # DripLoader\n            - IMPHASH=11083E75553BAAE21DC89CE8F9A195E4 # DripLoader\n            - IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80 # DripLoader\n            - IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F # CreateMiniDump\n            - IMPHASH=767637C23BB42CD5D7397CF58B0BE688 # UACMe Akagi\n            - IMPHASH=14C4E4C72BA075E9069EE67F39188AD8 # UACMe Akagi\n            - IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC # UACMe Akagi\n            - IMPHASH=7D010C6BB6A3726F327F7E239166D127 # UACMe Akagi\n            - IMPHASH=89159BA4DD04E4CE5559F132A9964EB3 # UACMe Akagi\n            - IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F # UACMe Akagi\n            - IMPHASH=5834ED4291BDEB928270428EBBAF7604 # UACMe Akagi\n            - IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38 # UACMe Akagi\n            - IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894 # UACMe Akagi\n            - IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74 # UACMe Akagi\n            - IMPHASH=3DE09703C8E79ED2CA3F01074719906B # UACMe Akagi\n            - IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F # WCE\n            - IMPHASH=E96A73C7BF33A464C510EDE582318BF2 # WCE\n            - IMPHASH=32089B8851BBF8BC2D014E9F37288C83 # Sliver Stagers\n            - IMPHASH=09D278F9DE118EF09163C6140255C690 # Dumpert\n            - IMPHASH=03866661686829d806989e2fc5a72606 # Dumpert\n            - IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d # Dumpert\n            - IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE # SysmonEnte\n            - IMPHASH=19584675D94829987952432E018D5056 # SysmonQuiet\n            - IMPHASH=330768A4F172E10ACB6287B87289D83B # ShaprEvtMute Hook\n            - IMPHASH=885C99CCFBE77D1CBFCB9C4E7C1A3313 # Forkatz\n            - IMPHASH=22A22BC9E4E0D2F189F1EA01748816AC # PPLKiller\n            - IMPHASH=7FA30E6BB7E8E8A69155636E50BF1B28 # PPLKiller\n            - IMPHASH=96DF3A3731912449521F6F8D183279B1 # Backstab\n            - IMPHASH=7E6CF3FF4576581271AC8A313B2AAB46 # Backstab\n            - IMPHASH=51791678F351C03A0EB4E2A7B05C6E17 # Backstab\n            - IMPHASH=25CE42B079282632708FC846129E98A5 # Forensia\n            - IMPHASH=021BCCA20BA3381B11BDDE26B4E62F20 # EDRSandBlast\n            - IMPHASH=59223B5F52D8799D38E0754855CBDF42 # EDRSandBlast\n            - IMPHASH=81E75D8F1D276C156653D3D8813E4A43 # EDRSandBlast\n            - IMPHASH=17244E8B6B8227E57FE709CCAD421420 # EDRSandBlast\n            - IMPHASH=5B76DA3ACDEDC8A5CDF23A798B5936B4 # EDRSandBlast\n            - IMPHASH=CB2B65BB77D995CC1C0E5DF1C860133C # EDRSandBlast\n            - IMPHASH=40445337761D80CF465136FAFB1F63E6 # EDRSandBlast\n            - IMPHASH=8A790F401B29FA87BC1E56F7272B3AA6 # EDRSilencer\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"create_stream_hash\\create_stream_hash_file_sharing_domains_download_unusual_extension.yml","content":"title: Unusual File Download From File Sharing Websites - File Stream\nid: ae02ed70-11aa-4a22-b397-c0d0e8f6ea99\nrelated:\n    - id: 52182dfb-afb7-41db-b4bc-5336cb29b464\n      type: similar\nstatus: test\ndescription: Detects the download of suspicious file type from a well-known file and paste sharing domain\nreferences:\n    - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90015\n    - https://www.cisa.gov/uscert/ncas/alerts/aa22-321a\n    - https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/\nauthor: Florian Roth (Nextron Systems)\ndate: 2022-08-24\nmodified: 2024-10-21\ntags:\n    - attack.defense-evasion\n    - attack.s0139\n    - attack.t1564.004\nlogsource:\n    product: windows\n    category: create_stream_hash\ndetection:\n    selection_domain:\n        Contents|contains:\n            - '.githubusercontent.com'       # Includes both gists and github repositories / Michael Haag (idea)\n            - 'anonfiles.com'\n            - 'cdn.discordapp.com'\n            - 'ddns.net'\n            - 'dl.dropboxusercontent.com'\n            - 'ghostbin.co'\n            - 'glitch.me'\n            - 'gofile.io'\n            - 'hastebin.com'\n            - 'mediafire.com'\n            - 'mega.nz'\n            - 'onrender.com'\n            - 'pages.dev'\n            - 'paste.ee'\n            - 'pastebin.com'\n            - 'pastebin.pl'\n            - 'pastetext.net'\n            - 'pixeldrain.com'\n            - 'privatlab.com'\n            - 'privatlab.net'\n            - 'send.exploit.in'\n            - 'sendspace.com'\n            - 'storage.googleapis.com'\n            - 'storjshare.io'\n            - 'supabase.co'\n            - 'temp.sh'\n            - 'transfer.sh'\n            - 'trycloudflare.com'\n            - 'ufile.io'\n            - 'w3spaces.com'\n            - 'workers.dev'\n    selection_extension:\n        TargetFilename|contains:\n            - '.bat:Zone'\n            - '.cmd:Zone'\n            - '.ps1:Zone'\n    condition: all of selection_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"create_stream_hash\\create_stream_hash_file_sharing_domains_download_susp_extension.yml","content":"title: Suspicious File Download From File Sharing Websites -  File Stream\nid: 52182dfb-afb7-41db-b4bc-5336cb29b464\nrelated:\n    - id: ae02ed70-11aa-4a22-b397-c0d0e8f6ea99\n      type: similar\nstatus: test\ndescription: Detects the download of suspicious file type from a well-known file and paste sharing domain\nreferences:\n    - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90015\n    - https://www.cisa.gov/uscert/ncas/alerts/aa22-321a\n    - https://fabian-voith.de/2020/06/25/sysmon-v11-1-reads-alternate-data-streams/\n    - https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/\nauthor: Florian Roth (Nextron Systems)\ndate: 2022-08-24\nmodified: 2024-10-21\ntags:\n    - attack.defense-evasion\n    - attack.s0139\n    - attack.t1564.004\nlogsource:\n    product: windows\n    category: create_stream_hash\ndetection:\n    selection_domain:\n        Contents|contains:\n            - '.githubusercontent.com'       # Includes both gists and github repositories / Michael Haag (idea)\n            - 'anonfiles.com'\n            - 'cdn.discordapp.com'\n            - 'ddns.net'\n            - 'dl.dropboxusercontent.com'\n            - 'ghostbin.co'\n            - 'glitch.me'\n            - 'gofile.io'\n            - 'hastebin.com'\n            - 'mediafire.com'\n            - 'mega.nz'\n            - 'onrender.com'\n            - 'pages.dev'\n            - 'paste.ee'\n            - 'pastebin.com'\n            - 'pastebin.pl'\n            - 'pastetext.net'\n            - 'pixeldrain.com'\n            - 'privatlab.com'\n            - 'privatlab.net'\n            - 'send.exploit.in'\n            - 'sendspace.com'\n            - 'storage.googleapis.com'\n            - 'storjshare.io'\n            - 'supabase.co'\n            - 'temp.sh'\n            - 'transfer.sh'\n            - 'trycloudflare.com'\n            - 'ufile.io'\n            - 'w3spaces.com'\n            - 'workers.dev'\n    selection_extension:\n        TargetFilename|contains:\n            - '.cpl:Zone'\n            - '.dll:Zone'\n            - '.exe:Zone'\n            - '.hta:Zone'\n            - '.lnk:Zone'\n            - '.one:Zone'\n            - '.vbe:Zone'\n            - '.vbs:Zone'\n            - '.xll:Zone'\n    condition: all of selection_*\nfalsepositives:\n    - Some false positives might occur with binaries download via Github\nlevel: high\n"},{"path":"create_stream_hash\\create_stream_hash_creation_internet_file.yml","content":"title: Creation Of a Suspicious ADS File Outside a Browser Download\nid: 573df571-a223-43bc-846e-3f98da481eca\nstatus: test\ndescription: Detects the creation of a suspicious ADS (Alternate Data Stream) file by software other than browsers\nreferences:\n    - https://www.bleepingcomputer.com/news/security/exploited-windows-zero-day-lets-javascript-files-bypass-security-warnings/\nauthor: frack113\ndate: 2022-10-22\nmodified: 2023-06-12\ntags:\n    - attack.defense-evasion\nlogsource:\n    product: windows\n    category: create_stream_hash\ndetection:\n    selection:\n        Contents|startswith: '[ZoneTransfer]  ZoneId=3'\n        TargetFilename|endswith: ':Zone.Identifier'\n        TargetFilename|contains:\n            - '.exe'\n            - '.scr'\n            - '.bat'\n            - '.cmd'\n            - '.docx'\n            - '.hta'\n            - '.jse'\n            - '.lnk'\n            - '.pptx'\n            - '.ps'\n            - '.reg'\n            - '.sct'\n            - '.vb'\n            - '.wsc'\n            - '.wsf'\n            - '.xlsx'\n    filter_optional_brave:\n        Image|endswith: '\\brave.exe'\n    filter_optional_chrome:\n        Image:\n            - 'C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe'\n            - 'C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe'\n    filter_optional_firefox:\n        Image:\n            - 'C:\\Program Files\\Mozilla Firefox\\firefox.exe'\n            - 'C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe'\n    filter_optional_ie:\n        Image:\n            - 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe'\n            - 'C:\\Program Files\\Internet Explorer\\iexplore.exe'\n    filter_optional_maxthon:\n        Image|endswith: '\\maxthon.exe'\n    filter_optional_edge_1:\n        - Image|startswith: 'C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\'\n        - Image|endswith: '\\WindowsApps\\MicrosoftEdge.exe'\n        - Image:\n              - 'C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe'\n              - 'C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe'\n    filter_optional_edge_2:\n        Image|startswith:\n            - 'C:\\Program Files (x86)\\Microsoft\\EdgeCore\\'\n            - 'C:\\Program Files\\Microsoft\\EdgeCore\\'\n        Image|endswith:\n            - '\\msedge.exe'\n            - '\\msedgewebview2.exe'\n    filter_optional_opera:\n        Image|endswith: '\\opera.exe'\n    filter_optional_safari:\n        Image|endswith: '\\safari.exe'\n    filter_optional_seamonkey:\n        Image|endswith: '\\seamonkey.exe'\n    filter_optional_vivaldi:\n        Image|endswith: '\\vivaldi.exe'\n    filter_optional_whale:\n        Image|endswith: '\\whale.exe'\n    filter_optional_snipping_tool:\n        Image|startswith: 'C:\\Program Files\\WindowsApps\\Microsoft.ScreenSketch_'\n        Image|endswith: '\\SnippingTool\\SnippingTool.exe'\n        TargetFilename|startswith: 'C:\\Users\\'\n        TargetFilename|contains|all:\n            - '\\AppData\\Local\\Packages\\Microsoft.ScreenSketch_'\n            - '\\TempState\\Screenshot '\n        TargetFilename|endswith: '.png:Zone.Identifier'\n    condition: selection and not 1 of filter_optional_*\nfalsepositives:\n    - Other legitimate browsers not currently included in the filter (please add them)\n    - Legitimate downloads via scripting or command-line tools (Investigate to determine if it's legitimate)\nlevel: medium\n"},{"path":"create_stream_hash\\create_stream_hash_ads_executable.yml","content":"title: Hidden Executable In NTFS Alternate Data Stream\nid: b69888d4-380c-45ce-9cf9-d9ce46e67821\nstatus: test\ndescription: Detects the creation of an ADS (Alternate Data Stream) that contains an executable by looking at a non-empty Imphash\nreferences:\n    - https://twitter.com/0xrawsec/status/1002478725605273600?s=21\nauthor: Florian Roth (Nextron Systems), @0xrawsec\ndate: 2018-06-03\nmodified: 2023-02-10\ntags:\n    - attack.defense-evasion\n    - attack.s0139\n    - attack.t1564.004\nlogsource:\n    product: windows\n    category: create_stream_hash\n    definition: 'Requirements: Sysmon or equivalent configured with Imphash logging'\ndetection:\n    selection:\n        Hash|contains: 'IMPHASH='\n    filter_main_null:\n        Hash|contains: 'IMPHASH=00000000000000000000000000000000'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - This rule isn't looking for any particular binary characteristics. As legitimate installers and programs were seen embedding hidden binaries in their ADS. Some false positives are expected from browser processes and similar.\nlevel: medium\n"}]