[{"path":"image_load\\image_load_wsman_provider_image_load.yml","content":"title: Suspicious WSMAN Provider Image Loads\nid: ad1f4bb9-8dfb-4765-adb6-2a7cfb6c0f94\nstatus: test\ndescription: Detects signs of potential use of the WSMAN provider from uncommon processes locally and remote execution.\nreferences:\n    - https://twitter.com/chadtilbury/status/1275851297770610688\n    - https://bohops.com/2020/05/12/ws-management-com-another-approach-for-winrm-lateral-movement/\n    - https://learn.microsoft.com/en-us/windows/win32/winrm/windows-remote-management-architecture\n    - https://github.com/bohops/WSMan-WinRM\nauthor: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020-06-24\nmodified: 2025-10-17\ntags:\n    - attack.execution\n    - attack.t1059.001\n    - attack.lateral-movement\n    - attack.t1021.003\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    request_client:\n        - ImageLoaded|endswith:\n              - '\\WsmSvc.dll'\n              - '\\WsmAuto.dll'\n              - '\\Microsoft.WSMan.Management.ni.dll'\n        - OriginalFileName:\n              - 'WsmSvc.dll'\n              - 'WSMANAUTOMATION.DLL'\n              - 'Microsoft.WSMan.Management.dll'\n    respond_server:\n        Image|endswith: '\\svchost.exe'\n        OriginalFileName: 'WsmWmiPl.dll'\n    filter_general:\n        Image:\n            - 'C:\\Program Files (x86)\\PowerShell\\6\\pwsh.exe'\n            - 'C:\\Program Files (x86)\\PowerShell\\7\\pwsh.exe'\n            - 'C:\\Program Files\\PowerShell\\6\\pwsh.exe'\n            - 'C:\\Program Files\\PowerShell\\7\\pwsh.exe'\n            - 'C:\\Windows\\System32\\sdiagnhost.exe'\n            - 'C:\\Windows\\System32\\services.exe'\n            - 'C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe'\n            - 'C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe'\n    filter_svchost: # not available in Sysmon data, but Aurora logs\n        CommandLine|contains:\n            - 'svchost.exe -k netsvcs -p -s BITS'\n            - 'svchost.exe -k GraphicsPerfSvcGroup -s GraphicsPerfSvc'\n            - 'svchost.exe -k NetworkService -p -s Wecsvc'\n            - 'svchost.exe -k netsvcs'\n    filter_mscorsvw: # Image: C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\mscorsvw.exe\n        Image|startswith:\n            - 'C:\\Windows\\Microsoft.NET\\Framework64\\v'\n            - 'C:\\Windows\\Microsoft.NET\\Framework\\v'\n            - 'C:\\Windows\\Microsoft.NET\\FrameworkArm\\v'\n            - 'C:\\Windows\\Microsoft.NET\\FrameworkArm64\\v'\n        Image|endswith: '\\mscorsvw.exe'\n    filter_svr_2019:\n        Image:\n            - 'C:\\Windows\\System32\\Configure-SMRemoting.exe'\n            - 'C:\\Windows\\System32\\ServerManager.exe'\n    filter_nextron:\n        Image|startswith: 'C:\\Windows\\Temp\\asgard2-agent\\'\n    filter_citrix:\n        Image|startswith: 'C:\\Program Files\\Citrix\\'\n    filter_upgrade:\n        Image|startswith: 'C:\\$WINDOWS.~BT\\Sources\\'\n    filter_mmc:\n        Image|endswith: '\\mmc.exe'\n    svchost:\n        Image|endswith: '\\svchost.exe'\n    commandline_null:\n        CommandLine: null\n    condition: ( request_client or respond_server ) and not 1 of filter* and not ( svchost and commandline_null )\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_wmi_persistence_commandline_event_consumer.yml","content":"title: WMI Persistence - Command Line Event Consumer\nid: 05936ce2-ee05-4dae-9d03-9a391cf2d2c6\nstatus: test\ndescription: Detects WMI command line event consumers\nreferences:\n    - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\nauthor: Thomas Patzke\ndate: 2018-03-07\nmodified: 2021-11-27\ntags:\n    - attack.privilege-escalation\n    - attack.t1546.003\n    - attack.persistence\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe'\n        ImageLoaded|endswith: '\\wbemcons.dll'\n    condition: selection\nfalsepositives:\n    - Unknown (data set is too small; further testing needed)\nlevel: high\n"},{"path":"image_load\\image_load_wmiprvse_wbemcomn_dll_hijack.yml","content":"title: Wmiprvse Wbemcomn DLL Hijack\nid: 7707a579-e0d8-4886-a853-ce47e4575aaa\nstatus: test\ndescription: Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\\Windows\\System32\\wbem\\` directory over the network and loading it for a WMI DLL Hijack scenario.\nreferences:\n    - https://threathunterplaybook.com/hunts/windows/201009-RemoteWMIWbemcomnDLLHijack/notebook.html\nauthor: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020-10-12\nmodified: 2022-10-09\ntags:\n    - attack.execution\n    - attack.t1047\n    - attack.lateral-movement\n    - attack.t1021.002\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        Image|endswith: '\\wmiprvse.exe'\n        ImageLoaded|endswith: '\\wbem\\wbemcomn.dll'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_wmic_remote_xsl_scripting_dlls.yml","content":"title: WMIC Loading Scripting Libraries\nid: 06ce37c2-61ab-4f05-9ff5-b1a96d18ae32\nstatus: test\ndescription: Detects threat actors proxy executing code and bypassing application controls by leveraging wmic and the `/FORMAT` argument switch to download and execute an XSL file (i.e js, vbs, etc).\nreferences:\n    - https://securitydatasets.com/notebooks/atomic/windows/defense_evasion/SDWIN-201017061100.html\n    - https://twitter.com/dez_/status/986614411711442944\n    - https://lolbas-project.github.io/lolbas/Binaries/Wmic/\nauthor: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020-10-17\nmodified: 2022-10-13\ntags:\n    - attack.defense-evasion\n    - attack.t1220\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\wmic.exe'\n        ImageLoaded|endswith:\n            - '\\jscript.dll'\n            - '\\vbscript.dll'\n    condition: selection\nfalsepositives:\n    - The command wmic os get lastboottuptime loads vbscript.dll\n    - The command wmic os get locale loads vbscript.dll\n    - Since the ImageLoad event doesn't have enough information in this case. It's better to look at the recent process creation events that spawned the WMIC process and investigate the command line and parent/child processes to get more insights\nlevel: medium\n"},{"path":"image_load\\image_load_win_trusted_path_bypass.yml","content":"title: Trusted Path Bypass via Windows Directory Spoofing\nid: 0cbe38c0-270c-41d9-ab79-6e5a9a669290\nrelated:\n    - id: 4ac47ed3-44c2-4b1f-9d51-bf46e8914126\n      type: similar\nstatus: experimental\ndescription: |\n    Detects DLLs loading from a spoofed Windows directory path with an extra space (e.g \"C:\\Windows \\System32\") which can bypass Windows trusted path verification.\n    This technique tricks Windows into treating the path as trusted, allowing malicious DLLs to load with high integrity privileges bypassing UAC.\nreferences:\n    - https://x.com/Wietze/status/1933495426952421843\nauthor: Swachchhanda Shrawan Poudel (Nextron Systems)\ndate: 2025-06-17\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.007\n    - attack.t1548.002\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|contains:\n            - ':\\Windows \\System32\\'  # Note the space between \"Windows\" and \"System32\"\n            - ':\\Windows \\SysWOW64\\'  # Note the space between \"Windows\" and \"SysWOW64\"\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_win_mmc_loads_script_engine_dll.yml","content":"title: MMC Loading Script Engines DLLs\nid: a9c73e8b-3b2d-4c45-8ef2-5f9a9c9998ad\nstatus: experimental\ndescription: |\n    Detects when the Microsoft Management Console (MMC) loads the DLL libraries like vbscript, jscript etc which might indicate an attempt\n    to execute malicious scripts within a trusted system process for bypassing application whitelisting or defense evasion.\nreferences:\n    - https://tria.ge/241015-l98snsyeje/behavioral2\n    - https://www.elastic.co/security-labs/grimresource\nauthor: Swachchhanda Shrawan Poudel (Nextron Systems)\ndate: 2025-02-05\ntags:\n    - attack.execution\n    - attack.defense-evasion\n    - attack.t1059.005\n    - attack.t1218.014\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\mmc.exe'\n        ImageLoaded|endswith:\n            - '\\vbscript.dll'\n            - '\\jscript.dll'\n            - '\\jscript9.dll'\n    condition: selection\nfalsepositives:\n    - Legitimate MMC operations or extensions loading these libraries\nlevel: medium\n"},{"path":"image_load\\image_load_uac_bypass_via_dism.yml","content":"title: UAC Bypass With Fake DLL\nid: a5ea83a7-05a5-44c1-be2e-addccbbd8c03\nstatus: test\ndescription: Attempts to load dismcore.dll after dropping it\nreferences:\n    - https://steemit.com/utopian-io/@ah101/uac-bypassing-utility\nauthor: oscd.community, Dmitry Uchakin\ndate: 2020-10-06\nmodified: 2022-12-25\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1548.002\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\dism.exe'\n        ImageLoaded|endswith: '\\dismcore.dll'\n    filter:\n        ImageLoaded: 'C:\\Windows\\System32\\Dism\\dismcore.dll'\n    condition: selection and not filter\nfalsepositives:\n    - Actions of a legitimate telnet client\nlevel: high\n"},{"path":"image_load\\image_load_uac_bypass_iscsicpl.yml","content":"title: UAC Bypass Using Iscsicpl - ImageLoad\nid: 9ed5959a-c43c-4c59-84e3-d28628429456\nstatus: test\ndescription: Detects the \"iscsicpl.exe\" UAC bypass technique that leverages a DLL Search Order hijacking technique to load a custom DLL's from temp or a any user controlled location in the users %PATH%\nreferences:\n    - https://github.com/hackerhouse-opensource/iscsicpl_bypassUAC\n    - https://twitter.com/wdormann/status/1547583317410607110\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-07-17\nmodified: 2022-07-25\ntags:\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1548.002\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        Image: C:\\Windows\\SysWOW64\\iscsicpl.exe\n        ImageLoaded|endswith: '\\iscsiexe.dll'\n    filter:\n        ImageLoaded|contains|all:\n            - 'C:\\Windows\\'\n            - 'iscsiexe.dll'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_thor_unsigned_execution.yml","content":"title: Suspicious Unsigned Thor Scanner Execution\nid: ea5c131b-380d-49f9-aeb3-920694da4d4b\nstatus: stable\ndescription: Detects loading and execution of an unsigned thor scanner binary.\nreferences:\n    - Internal Research\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-10-29\ntags:\n    - attack.privilege-escalation\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\thor.exe'\n            - '\\thor64.exe'\n        ImageLoaded|endswith:\n            - '\\thor.exe'\n            - '\\thor64.exe'\n    filter_main:\n        Signed: 'true'\n        SignatureStatus: 'valid'\n        Signature: 'Nextron Systems GmbH'\n    condition: selection and not filter_main\nfalsepositives:\n    - Other legitimate binaries named \"thor.exe\" that aren't published by Nextron Systems\nlevel: high\n"},{"path":"image_load\\image_load_susp_unsigned_dll.yml","content":"title: Unsigned DLL Loaded by Windows Utility\nid: b5de0c9a-6f19-43e0-af4e-55ad01f550af\nstatus: test\ndescription: |\n    Detects windows utilities loading an unsigned or untrusted DLL.\n    Adversaries often abuse those programs to proxy execution of malicious code.\nreferences:\n    - https://www.elastic.co/security-labs/Hunting-for-Suspicious-Windows-Libraries-for-Execution-and-Evasion\n    - https://akhere.hashnode.dev/hunting-unsigned-dlls-using-kql\n    - https://unit42.paloaltonetworks.com/unsigned-dlls/?web_view=true\nauthor: Swachchhanda Shrawan Poudel\ndate: 2024-02-28\nmodified: 2025-10-07\ntags:\n    - attack.t1218.011\n    - attack.t1218.010\n    - attack.defense-evasion\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        Image|endswith:\n            # Note: Add additional utilities that allow the loading of DLLs\n            - '\\InstallUtil.exe'\n            - '\\RegAsm.exe'\n            - '\\RegSvcs.exe'\n            - '\\regsvr32.exe'\n            - '\\rundll32.exe'\n    filter_main_signed:\n        Signed: 'true'\n    filter_main_sig_status:\n        SignatureStatus:\n            - 'errorChaining'\n            - 'errorCode_endpoint'\n            - 'errorExpired'\n            - 'trusted'\n            - 'Valid'\n    filter_main_signed_null:\n        Signed: null\n    filter_main_signed_empty:\n        Signed:\n            - ''\n            - '-'\n    filter_main_sig_status_null:\n        SignatureStatus: null\n    filter_main_sig_status_empty:\n        SignatureStatus:\n            - ''\n            - '-'\n    filter_main_windows_installer:\n        Image:\n            - 'C:\\Windows\\SysWOW64\\rundll32.exe'\n            - 'C:\\Windows\\System32\\rundll32.exe'\n        ImageLoaded|startswith: 'C:\\Windows\\Installer\\'\n        ImageLoaded|endswith:\n            - '.tmp-\\Microsoft.Deployment.WindowsInstaller.dll'\n            - '.tmp-\\Avira.OE.Setup.CustomActions.dll'\n    filter_main_assembly:\n        Image|startswith:\n            - 'C:\\Windows\\SysWOW64\\'\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\Microsoft.NET\\Framework64'\n        Image|endswith: '\\RegAsm.exe'\n        ImageLoaded|endswith: '.dll'\n        ImageLoaded|startswith: 'C:\\Windows\\assembly\\NativeImages'\n    filter_optional_klite_codec:\n        Image:\n            - 'C:\\Windows\\SysWOW64\\regsvr32.exe'\n            - 'C:\\Windows\\System32\\regsvr32.exe'\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\K-Lite Codec Pack\\'\n            - 'C:\\Program Files\\K-Lite Codec Pack\\'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_susp_script_dotnet_clr_dll_load.yml","content":"title: DotNet CLR DLL Loaded By Scripting Applications\nid: 4508a70e-97ef-4300-b62b-ff27992990ea\nstatus: test\ndescription: Detects .NET CLR DLLs being loaded by scripting applications such as wscript or cscript. This could be an indication of potential suspicious execution.\nreferences:\n    - https://github.com/tyranid/DotNetToJScript\n    - https://thewover.github.io/Introducing-Donut/\n    - https://web.archive.org/web/20230329154538/https://blog.menasec.net/2019/07/interesting-difr-traces-of-net-clr.html\n    - https://web.archive.org/web/20221026202428/https://gist.github.com/code-scrap/d7f152ffcdb3e0b02f7f394f5187f008\nauthor: omkar72, oscd.community\ndate: 2020-10-14\nmodified: 2023-02-23\ntags:\n    - attack.defense-evasion\n    - attack.execution\n    - attack.privilege-escalation\n    - attack.t1055\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\cmstp.exe'\n            - '\\cscript.exe'\n            - '\\mshta.exe'\n            - '\\msxsl.exe'\n            - '\\regsvr32.exe'\n            # - '\\svchost.exe'\n            - '\\wmic.exe'\n            - '\\wscript.exe'\n        ImageLoaded|endswith:\n            - '\\clr.dll'\n            - '\\mscoree.dll'\n            - '\\mscorlib.dll'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_susp_python_image_load.yml","content":"title: Python Image Load By Non-Python Process\nid: cbb56d62-4060-40f7-9466-d8aaf3123f83\nstatus: test\ndescription: |\n    Detects the image load of \"Python Core\" by a non-Python process. This might be indicative of a execution of executable that has been bundled from Python code.\n    Various tools like Py2Exe, PyInstaller, and cx_Freeze are used to bundle Python code into standalone executables.\n    Threat actors often use these tools to bundle malicious Python scripts into executables, sometimes to obfuscate the code or to bypass security measures.\nreferences:\n    - https://www.py2exe.org/\n    - https://unit42.paloaltonetworks.com/unit-42-technical-analysis-seaduke/\nauthor: Patrick St. John, OTR (Open Threat Research)\ndate: 2020-05-03\nmodified: 2025-08-18\ntags:\n    - attack.defense-evasion\n    - attack.t1027.002\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        Description: 'Python Core'\n    filter_main_generic:\n        - Image|contains: 'Python'  # FPs with python38.dll, python.exe etc.\n        - Image|startswith:\n              - 'C:\\Program Files\\'\n              - 'C:\\Program Files (x86)\\'\n              - 'C:\\ProgramData\\Anaconda3\\' # Comment out if you don't use Anaconda in your environment\n    filter_optional_null_image:\n        Image: null\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Legitimate Py2Exe Binaries\n    - Known false positive caused with Python Anaconda\n    - Various legitimate software is bundled from Python code into executables\nlevel: low\n"},{"path":"image_load\\image_load_susp_dll_load_system_process.yml","content":"title: DLL Load By System Process From Suspicious Locations\nid: 9e9a9002-56c4-40fd-9eff-e4b09bfa5f6c\nstatus: test\ndescription: Detects when a system process (i.e. located in system32, syswow64, etc.) loads a DLL from a suspicious location or a location with permissive permissions such as \"C:\\Users\\Public\"\nreferences:\n    - https://github.com/hackerhouse-opensource/iscsicpl_bypassUAC (Idea)\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-07-17\nmodified: 2023-09-18\ntags:\n    - attack.defense-evasion\n    - attack.t1070\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        Image|startswith: 'C:\\Windows\\'\n        ImageLoaded|startswith:\n            # TODO: Add more suspicious paths as you see fit in your env\n            - 'C:\\Users\\Public\\'\n            - 'C:\\PerfLogs\\'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_susp_clickonce_unsigned_module_loaded.yml","content":"title: Unsigned Module Loaded by ClickOnce Application\nid: 060d5ad4-3153-47bb-8382-43e5e29eda92\nstatus: test\ndescription: Detects unsigned module load by ClickOnce application.\nreferences:\n    - https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5\nauthor: '@SerkinValery'\ndate: 2023-06-08\ntags:\n    - attack.privilege-escalation\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection_path:\n        Image|contains: '\\AppData\\Local\\Apps\\2.0\\'\n    selection_sig_status:\n        - Signed: 'false'\n        - SignatureStatus: 'Expired'\n    condition: all of selection_*\nfalsepositives:\n    - Unlikely\nlevel: medium\n"},{"path":"image_load\\image_load_susp_baaupdate_dll_load.yml","content":"title: BaaUpdate.exe Suspicious DLL Load\nid: 6e8fe0a8-ba0b-4a93-8f9e-82657e7a5984\nrelated:\n    - id: 9f38c1db-e2ae-40bf-81d0-5b68f73fb512 # Suspicious BitLocker Access Agent Update Utility Execution\n      type: similar\nstatus: experimental\ndescription: |\n    Detects BitLocker Access Agent Update Utility (baaupdate.exe) loading DLLs from suspicious locations that are publicly writable which could indicate an attempt to lateral movement via BitLocker DCOM & COM Hijacking.\n    This technique abuses COM Classes configured as INTERACTIVE USER to spawn processes in the context of the logged-on user's session. Specifically, it targets the BDEUILauncher Class (CLSID ab93b6f1-be76-4185-a488-a9001b105b94)\n    which can launch BaaUpdate.exe, which is vulnerable to COM Hijacking when started with input parameters. This allows attackers to execute code in the user's context without needing to steal credentials or use additional techniques to compromise the account.\nreferences:\n    - https://github.com/rtecCyberSec/BitlockMove\nauthor: Swachchhanda Shrawan Poudel (Nextron Systems)\ndate: 2025-10-18\ntags:\n    - attack.defense-evasion\n    - attack.t1218\n    - attack.lateral-movement\n    - attack.t1021.003\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\BaaUpdate.exe'\n        ImageLoaded|endswith: '.dll'\n        ImageLoaded|contains:\n            - ':\\Perflogs\\'\n            - ':\\Users\\Default\\'\n            - ':\\Users\\Public\\'\n            - ':\\Windows\\Temp\\'\n            - '\\AppData\\Local\\Temp\\'\n            - '\\AppData\\Roaming\\'\n            - '\\Contacts\\'\n            - '\\Favorites\\'\n            - '\\Favourites\\'\n            - '\\Links\\'\n            - '\\Music\\'\n            - '\\Pictures\\'\n            - '\\ProgramData\\'\n            - '\\Temporary Internet'\n            - '\\Videos\\'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_side_load_wwlib.yml","content":"title: Potential WWlib.DLL Sideloading\nid: e2e01011-5910-4267-9c3b-4149ed5479cf\nstatus: test\ndescription: Detects potential DLL sideloading of \"wwlib.dll\"\nreferences:\n    - https://twitter.com/WhichbufferArda/status/1658829954182774784\n    - https://news.sophos.com/en-us/2022/11/03/family-tree-dll-sideloading-cases-may-be-related/\n    - https://securelist.com/apt-luminousmoth/103332/\nauthor: X__Junior (Nextron Systems)\ndate: 2023-05-18\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\wwlib.dll'\n    filter_main_path:\n        Image|startswith:\n            - 'C:\\Program Files (x86)\\Microsoft Office\\'\n            - 'C:\\Program Files\\Microsoft Office\\'\n        Image|endswith: '\\winword.exe'\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\Microsoft Office\\'\n            - 'C:\\Program Files\\Microsoft Office\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_windows_defender.yml","content":"title: Potential Mpclient.DLL Sideloading\nid: 418dc89a-9808-4b87-b1d7-e5ae0cb6effc\nrelated:\n    - id: 7002aa10-b8d4-47ae-b5ba-51ab07e228b9\n      type: similar\nstatus: test\ndescription: Detects potential sideloading of \"mpclient.dll\" by Windows Defender processes (\"MpCmdRun\" and \"NisSrv\") from their non-default directory.\nreferences:\n    - https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool\nauthor: Bhabesh Raj\ndate: 2022-08-02\nmodified: 2023-08-04\ntags:\n    - attack.privilege-escalation\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.t1574.001\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\mpclient.dll'\n        Image|endswith:\n            - '\\MpCmdRun.exe'\n            - '\\NisSrv.exe'\n    filter_main_known_locations:\n        Image|startswith:\n            - 'C:\\Program Files (x86)\\Windows Defender\\'\n            - 'C:\\Program Files\\Microsoft Security Client\\'\n            - 'C:\\Program Files\\Windows Defender\\'\n            - 'C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\'\n            - 'C:\\Windows\\WinSxS\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_wazuh.yml","content":"title: Potential Wazuh Security Platform DLL Sideloading\nid: db77ce78-7e28-4188-9337-cf30e2b3ba9f\nstatus: test\ndescription: Detects potential DLL side loading of DLLs that are part of the Wazuh security platform\nreferences:\n    - https://www.trendmicro.com/en_us/research/23/c/iron-tiger-sysupdate-adds-linux-targeting.html\nauthor: X__Junior (Nextron Systems)\ndate: 2023-03-13\nmodified: 2023-05-12\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith:\n            - '\\libwazuhshared.dll'\n            - '\\libwinpthread-1.dll'\n    filter_main_generic:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files\\'\n            - 'C:\\Program Files (x86)\\'\n    filter_optional_mingw64:\n        # Note: Many third party apps installed in \"AppData\" or \"ProgramData\" and leverage \"mingw64\" make use of \"libwinpthread-1.dll\"\n        # In production its best to make a list of these apps and replace this filter with a specific one.\n        ImageLoaded|contains:\n            - '\\AppData\\Local\\'\n            - '\\ProgramData\\'\n        ImageLoaded|endswith: '\\mingw64\\bin\\libwinpthread-1.dll'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Many legitimate applications leverage this DLL. (Visual Studio, JetBrains, Ruby, Anaconda, GithubDesktop, etc.)\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_waveedit.yml","content":"title: Potential Waveedit.DLL Sideloading\nid: 71b31e99-9ad0-47d4-aeb5-c0ca3928eeeb\nstatus: test\ndescription: Detects potential DLL sideloading of \"waveedit.dll\", which is part of the Nero WaveEditor audio editing software.\nreferences:\n    - https://www.trendmicro.com/en_us/research/23/f/behind-the-scenes-unveiling-the-hidden-workings-of-earth-preta.html\nauthor: X__Junior (Nextron Systems)\ndate: 2023-06-14\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\waveedit.dll'\n    filter_main_legit_path:\n        Image:\n            - 'C:\\Program Files (x86)\\Nero\\Nero Apps\\Nero WaveEditor\\waveedit.exe'\n            - 'C:\\Program Files\\Nero\\Nero Apps\\Nero WaveEditor\\waveedit.exe'\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\Nero\\Nero Apps\\Nero WaveEditor\\'\n            - 'C:\\Program Files\\Nero\\Nero Apps\\Nero WaveEditor\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_vmware_xfer.yml","content":"title: Potential DLL Sideloading Via VMware Xfer\nid: 9313dc13-d04c-46d8-af4a-a930cc55d93b\nstatus: test\ndescription: Detects loading of a DLL by the VMware Xfer utility from the non-default directory which may be an attempt to sideload arbitrary DLL\nreferences:\n    - https://www.sentinelone.com/labs/lockbit-ransomware-side-loads-cobalt-strike-beacon-with-legitimate-vmware-utility/\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-02\nmodified: 2023-02-17\ntags:\n    - attack.privilege-escalation\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.t1574.001\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        Image|endswith: '\\VMwareXferlogs.exe'\n        ImageLoaded|endswith: '\\glib-2.0.dll'\n    filter: # VMware might be installed in another path so update the rule accordingly\n        ImageLoaded|startswith: 'C:\\Program Files\\VMware\\'\n    condition: selection and not filter\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_vmmap_dbghelp_unsigned.yml","content":"title: VMMap Unsigned Dbghelp.DLL Potential Sideloading\nid: 273a8dd8-3742-4302-bcc7-7df5a80fe425\nrelated:\n    - id: 98ffaed4-aec2-4e04-9b07-31492fe68b3d\n      type: similar\nstatus: test\ndescription: Detects potential DLL sideloading of an unsigned dbghelp.dll by the Sysinternals VMMap.\nreferences:\n    - https://techcommunity.microsoft.com/t5/sysinternals-blog/zoomit-v7-1-procdump-2-0-for-linux-process-explorer-v17-05/ba-p/3884766\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-07-28\nmodified: 2023-09-05\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|contains: 'C:\\Debuggers\\dbghelp.dll'\n        Image|endswith:\n            - '\\vmmap.exe'\n            - '\\vmmap64.exe'\n    filter_main_signed:\n        Signed: 'true'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_side_load_vmmap_dbghelp_signed.yml","content":"title: VMMap Signed Dbghelp.DLL Potential Sideloading\nid: 98ffaed4-aec2-4e04-9b07-31492fe68b3d\nrelated:\n    - id: 273a8dd8-3742-4302-bcc7-7df5a80fe425\n      type: similar\nstatus: test\ndescription: Detects potential DLL sideloading of a signed dbghelp.dll by the Sysinternals VMMap.\nreferences:\n    - https://techcommunity.microsoft.com/t5/sysinternals-blog/zoomit-v7-1-procdump-2-0-for-linux-process-explorer-v17-05/ba-p/3884766\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-09-05\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|contains: 'C:\\Debuggers\\dbghelp.dll'\n        Image|endswith:\n            - '\\vmmap.exe'\n            - '\\vmmap64.exe'\n        Signed: 'true'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_vmguestlib.yml","content":"title: VMGuestLib DLL Sideload\nid: 70e8e9b4-6a93-4cb7-8cde-da69502e7aff\nstatus: test\ndescription: Detects DLL sideloading of VMGuestLib.dll by the WmiApSrv service.\nreferences:\n    - https://decoded.avast.io/martinchlumecky/png-steganography/\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-12-01\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|contains|all:\n            - '\\VMware\\VMware Tools\\vmStatsProvider\\win32'\n            - '\\vmGuestLib.dll'\n        Image|endswith: '\\Windows\\System32\\wbem\\WmiApSrv.exe'\n    filter:\n        Signed: 'true'\n    condition: selection and not filter\nfalsepositives:\n    - FP could occur if the legitimate version of vmGuestLib already exists on the system\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_vivaldi_elf.yml","content":"title: Potential Vivaldi_elf.DLL Sideloading\nid: 2092cacb-d77b-4f98-ab0d-32b32f99a054\nstatus: test\ndescription: Detects potential DLL sideloading of \"vivaldi_elf.dll\"\nreferences:\n    - https://research.checkpoint.com/2023/beyond-the-horizon-traveling-the-world-on-camaro-dragons-usb-flash-drives/\nauthor: X__Junior (Nextron Systems)\ndate: 2023-08-03\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\vivaldi_elf.dll'\n    filter_main_legit_path:\n        Image|endswith: '\\Vivaldi\\Application\\vivaldi.exe'\n        ImageLoaded|contains: '\\Vivaldi\\Application\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_ualapi.yml","content":"title: Fax Service DLL Search Order Hijack\nid: 828af599-4c53-4ed2-ba4a-a9f835c434ea\nstatus: test\ndescription: The Fax service attempts to load ualapi.dll, which is non-existent. An attacker can then (side)load their own malicious DLL using this service.\nreferences:\n    - https://windows-internals.com/faxing-your-way-to-system/\nauthor: NVISO\ndate: 2020-05-04\nmodified: 2022-06-02\ntags:\n    - attack.privilege-escalation\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\fxssvc.exe'\n        ImageLoaded|endswith: 'ualapi.dll'\n    filter:\n        ImageLoaded|startswith: 'C:\\Windows\\WinSxS\\'\n    condition: selection and not filter\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_third_party.yml","content":"title: Third Party Software DLL Sideloading\nid: f9df325d-d7bc-4a32-8a1a-2cc61dcefc63\nstatus: test\ndescription: Detects DLL sideloading of DLLs that are part of third party software (zoom, discord....etc)\nreferences:\n    - https://hijacklibs.net/ # For list of DLLs that could be sideloaded (search for dlls mentioned here in there)\nauthor: Nasreddine Bencherchali (Nextron Systems), Wietze Beukema (project and research)\ndate: 2022-08-17\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    # Lenovo\n    selection_lenovo:\n        ImageLoaded|endswith: '\\commfunc.dll'\n    filter_lenovo:\n        - ImageLoaded|contains: '\\AppData\\local\\Google\\Chrome\\Application\\'\n        - ImageLoaded|startswith:\n              - 'C:\\Program Files\\Lenovo\\Communications Utility\\'\n              - 'C:\\Program Files (x86)\\Lenovo\\Communications Utility\\'\n    # Toshiba\n    selection_toshiba:\n        ImageLoaded|endswith: '\\tosbtkbd.dll'\n    filter_toshiba:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files\\Toshiba\\Bluetooth Toshiba Stack\\'\n            - 'C:\\Program Files (x86)\\Toshiba\\Bluetooth Toshiba Stack\\'\n    # Zoom (FP with System32)\n    # selection_zoom:\n    #     ImageLoaded|endswith: '\\version.dll'\n    # filter_zoom:\n    #     ImageLoaded|startswith: 'C:\\Users\\'\n    #     ImageLoaded|contains: '\\AppData\\Roaming\\Zoom\\bin\\'\n    condition: (selection_lenovo and not filter_lenovo) or (selection_toshiba and not filter_toshiba)\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_solidpdfcreator.yml","content":"title: Potential SolidPDFCreator.DLL Sideloading\nid: a2edbce1-95c8-4291-8676-0d45146862b3\nstatus: test\ndescription: Detects potential DLL sideloading of \"SolidPDFCreator.dll\"\nreferences:\n    - https://lab52.io/blog/new-mustang-pandas-campaing-against-australia/\nauthor: X__Junior (Nextron Systems)\ndate: 2023-05-07\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\SolidPDFCreator.dll'\n    filter_main_path:\n        Image|endswith: '\\SolidPDFCreator.exe'\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\SolidDocuments\\SolidPDFCreator\\'\n            - 'C:\\Program Files\\SolidDocuments\\SolidPDFCreator\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_smadhook.yml","content":"title: Potential SmadHook.DLL Sideloading\nid: 24b6cf51-6122-469e-861a-22974e9c1e5b\nstatus: test\ndescription: Detects potential DLL sideloading of \"SmadHook.dll\", a DLL used by SmadAV antivirus\nreferences:\n    - https://research.checkpoint.com/2023/malware-spotlight-camaro-dragons-tinynote-backdoor/\n    - https://www.qurium.org/alerts/targeted-malware-against-crph/\nauthor: X__Junior (Nextron Systems)\ndate: 2023-06-01\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith:\n            - '\\SmadHook32c.dll'\n            - '\\SmadHook64c.dll'\n    filter_main_legit_path:\n        Image:\n            - 'C:\\Program Files (x86)\\SMADAV\\SmadavProtect32.exe'\n            - 'C:\\Program Files (x86)\\SMADAV\\SmadavProtect64.exe'\n            - 'C:\\Program Files\\SMADAV\\SmadavProtect32.exe'\n            - 'C:\\Program Files\\SMADAV\\SmadavProtect64.exe'\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\SMADAV\\'\n            - 'C:\\Program Files\\SMADAV\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_shell_chrome_api.yml","content":"title: DLL Sideloading Of ShellChromeAPI.DLL\nid: ee4c5d06-3abc-48cc-8885-77f1c20f4451\nrelated:\n    - id: e173ad47-4388-4012-ae62-bd13f71c18a8\n      type: similar\nstatus: test\ndescription: |\n    Detects processes loading the non-existent DLL \"ShellChromeAPI\". One known example is the \"DeviceEnroller\" binary in combination with the \"PhoneDeepLink\" flag tries to load this DLL.\n    Adversaries can drop their own renamed DLL and execute it via DeviceEnroller.exe using this parameter\nreferences:\n    - https://mobile.twitter.com/0gtweet/status/1564131230941122561\n    - https://strontic.github.io/xcyclopedia/library/DeviceEnroller.exe-24BEF0D6B0ECED36BB41831759FDE18D.html\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-12-01\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        # The DLL shouldn't exist on Windows anymore. If for some reason you still have it. You could filter out legitimate calls\n        ImageLoaded|endswith: '\\ShellChromeAPI.dll'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_side_load_shelldispatch.yml","content":"title: Potential ShellDispatch.DLL Sideloading\nid: 844f8eb2-610b-42c8-89a4-47596e089663\nstatus: test\ndescription: Detects potential DLL sideloading of \"ShellDispatch.dll\"\nreferences:\n    - https://www.hexacorn.com/blog/2023/06/07/this-lolbin-doesnt-exist/\nauthor: X__Junior (Nextron Systems)\ndate: 2023-06-20\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\ShellDispatch.dll'\n    filter_main_legit_path:\n        - ImageLoaded|contains|all:\n              - ':\\Users\\'\n              - '\\AppData\\Local\\Temp\\'\n        - ImageLoaded|contains: ':\\Windows\\Temp\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Some installers may trigger some false positives\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_robform.yml","content":"title: Potential RoboForm.DLL Sideloading\nid: f64c9b2d-b0ad-481d-9d03-7fc75020892a\nstatus: test\ndescription: Detects potential DLL sideloading of \"roboform.dll\", a DLL used by RoboForm Password Manager\nreferences:\n    - https://twitter.com/StopMalvertisin/status/1648604148848549888\n    - https://twitter.com/t3ft3lb/status/1656194831830401024\n    - https://www.roboform.com/\nauthor: X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-05-14\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith:\n            - '\\roboform.dll'\n            - '\\roboform-x64.dll'\n    filter_main_path:\n        Image|startswith:\n            - ' C:\\Program Files (x86)\\Siber Systems\\AI RoboForm\\'\n            - ' C:\\Program Files\\Siber Systems\\AI RoboForm\\'\n        Image|endswith:\n            - '\\robotaskbaricon.exe'\n            - '\\robotaskbaricon-x64.exe'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - If installed on a per-user level, the path would be located in \"AppData\\Local\". Add additional filters to reflect this mode of installation\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_rjvplatform_non_default_location.yml","content":"title: Potential RjvPlatform.DLL Sideloading From Non-Default Location\nid: 0e0bc253-07ed-43f1-816d-e1b220fe8971\nstatus: test\ndescription: Detects potential DLL sideloading of \"RjvPlatform.dll\" by \"SystemResetPlatform.exe\" located in a non-default location.\nreferences:\n    - https://twitter.com/0gtweet/status/1666716511988330499\nauthor: X__Junior (Nextron Systems)\ndate: 2023-06-09\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\RjvPlatform.dll'\n        Image: '\\SystemResetPlatform.exe'\n    filter_main_legit_path:\n        Image|startswith: 'C:\\Windows\\System32\\SystemResetPlatform\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_rjvplatform_default_location.yml","content":"title: Potential RjvPlatform.DLL Sideloading From Default Location\nid: 259dda31-b7a3-444f-b7d8-17f96e8a7d0d\nstatus: test\ndescription: Detects loading of \"RjvPlatform.dll\" by the \"SystemResetPlatform.exe\" binary which can be abused as a method of DLL side loading since the \"$SysReset\" directory isn't created by default.\nreferences:\n    - https://twitter.com/0gtweet/status/1666716511988330499\nauthor: X__Junior (Nextron Systems)\ndate: 2023-06-09\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image: 'C:\\Windows\\System32\\SystemResetPlatform\\SystemResetPlatform.exe'\n        ImageLoaded: 'C:\\$SysReset\\Framework\\Stack\\RjvPlatform.dll'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_rcdll.yml","content":"title: Potential Rcdll.DLL Sideloading\nid: 6e78b74f-c762-4800-82ad-f66787f10c8a\nstatus: test\ndescription: Detects potential DLL sideloading of rcdll.dll\nreferences:\n    - https://www.trendmicro.com/en_us/research/23/c/iron-tiger-sysupdate-adds-linux-targeting.html\nauthor: X__Junior (Nextron Systems)\ndate: 2023-03-13\nmodified: 2023-03-15\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\rcdll.dll'\n    filter:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\Microsoft Visual Studio\\'\n            - 'C:\\Program Files (x86)\\Windows Kits\\'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_side_load_python.yml","content":"title: Potential Python DLL SideLoading\nid: d36f7c12-14a3-4d48-b6b8-774b9c66f44d\nstatus: test\ndescription: Detects potential DLL sideloading of Python DLL files.\nreferences:\n    - https://www.securonix.com/blog/seolurker-attack-campaign-uses-seo-poisoning-fake-google-ads-to-install-malware/\n    - https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/\n    - https://github.com/wietze/HijackLibs/tree/dc9c9f2f94e6872051dab58fbafb043fdd8b4176/yml/3rd_party/python\nauthor: Swachchhanda Shrawan Poudel\ndate: 2024-10-06\nmodified: 2025-08-18\ntags:\n    - attack.privilege-escalation\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith:\n            - '\\python39.dll'\n            - '\\python310.dll'\n            - '\\python311.dll'\n            - '\\python312.dll'\n    filter_main_default_install_paths:\n        - ImageLoaded|startswith:\n              - 'C:\\Program Files\\Python3'\n              - 'C:\\Program Files (x86)\\Python3'\n        - ImageLoaded|contains: '\\AppData\\Local\\Programs\\Python\\Python3'\n    filter_optional_visual_studio:\n        ImageLoaded|startswith: 'C:\\Program Files\\Microsoft Visual Studio\\'\n    filter_optional_anaconda:\n        ImageLoaded|startswith: 'C:\\ProgramData\\Anaconda3\\' # Comment out if you don't use Anaconda in your environment\n    filter_optional_cpython:\n        ImageLoaded|contains:\n            - '\\cpython\\externals\\'\n            - '\\cpython\\PCbuild\\'\n    filter_optional_pyinstaller:\n        # Triggered by programs bundled with PyInstaller\n        ImageLoaded|startswith: 'C:\\Users'\n        ImageLoaded|contains: '\\AppData\\Local\\Temp\\_MEI'\n    filter_main_legit_signature_details:\n        Product: 'Python'\n        Signed: 'true'\n        Description: 'Python'\n        Company: 'Python Software Foundation'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Legitimate software using Python DLLs\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_office_dlls.yml","content":"title: Microsoft Office DLL Sideload\nid: 829a3bdf-34da-4051-9cf4-8ed221a8ae4f\nstatus: test\ndescription: Detects DLL sideloading of DLLs that are part of Microsoft Office from non standard location\nreferences:\n    - https://hijacklibs.net/ # For list of DLLs that could be sideloaded (search for dlls mentioned here in there)\nauthor: Nasreddine Bencherchali (Nextron Systems), Wietze Beukema (project and research)\ndate: 2022-08-17\nmodified: 2023-03-15\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\outllib.dll'\n    filter:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files\\Microsoft Office\\OFFICE'\n            - 'C:\\Program Files (x86)\\Microsoft Office\\OFFICE'\n            - 'C:\\Program Files\\Microsoft Office\\Root\\OFFICE'\n            - 'C:\\Program Files (x86)\\Microsoft Office\\Root\\OFFICE'\n    condition: selection and not filter\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_non_existent_dlls.yml","content":"title: Potential DLL Sideloading Of Non-Existent DLLs From System Folders\nid: 6b98b92b-4f00-4f62-b4fe-4d1920215771\nrelated:\n    - id: df6ecb8b-7822-4f4b-b412-08f524b4576c # FileEvent rule\n      type: similar\n    - id: 602a1f13-c640-4d73-b053-be9a2fa58b77\n      type: obsolete\nstatus: test\ndescription: |\n    Detects DLL sideloading of system DLLs that are not present on the system by default (at least not in system directories).\n    Usually this technique is used to achieve UAC bypass or privilege escalation.\nreferences:\n    - https://decoded.avast.io/martinchlumecky/png-steganography/\n    - https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992\n    - https://clement.notin.org/blog/2020/09/12/CVE-2020-7315-McAfee-Agent-DLL-injection/\n    - https://github.com/Wh04m1001/SysmonEoP\n    - https://www.hexacorn.com/blog/2013/12/08/beyond-good-ol-run-key-part-5/\n    - http://remoteawesomethoughts.blogspot.com/2019/05/windows-10-task-schedulerservice.html\nauthor: Nasreddine Bencherchali (Nextron Systems), SBousseaden\ndate: 2022-12-09\nmodified: 2024-01-10\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith:\n            # Add other DLLs\n            - ':\\Windows\\System32\\TSMSISrv.dll'\n            - ':\\Windows\\System32\\TSVIPSrv.dll'\n            - ':\\Windows\\System32\\wbem\\wbemcomn.dll'\n            - ':\\Windows\\System32\\WLBSCTRL.dll'\n            - ':\\Windows\\System32\\wow64log.dll'\n            - ':\\Windows\\System32\\WptsExtensions.dll'\n    filter_main_ms_signed:\n        Signed: 'true'\n        SignatureStatus: 'Valid'\n        # There could be other signatures (please add when found)\n        Signature: 'Microsoft Windows'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_side_load_mscorsvc.yml","content":"title: Potential DLL Sideloading Of MsCorSvc.DLL\nid: cdb15e19-c2d0-432a-928e-e49c8c60dcf2\nstatus: test\ndescription: Detects potential DLL sideloading of \"mscorsvc.dll\".\nreferences:\n    - https://hijacklibs.net/entries/microsoft/built-in/mscorsvc.html\nauthor: Wietze Beukema\ndate: 2024-07-11\nmodified: 2025-02-26\ntags:\n    - attack.privilege-escalation\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.t1574.001\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\mscorsvc.dll'\n    filter_main_generic:\n        ImageLoaded|startswith:\n            - 'C:\\Windows\\Microsoft.NET\\Framework\\'\n            - 'C:\\Windows\\Microsoft.NET\\Framework64\\'\n            - 'C:\\Windows\\Microsoft.NET\\FrameworkArm\\'\n            - 'C:\\Windows\\Microsoft.NET\\FrameworkArm64\\'\n            - 'C:\\Windows\\WinSxS\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Legitimate applications loading their own versions of the DLL mentioned in this rule.\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_mpsvc.yml","content":"title: Potential DLL Sideloading Of MpSvc.DLL\nid: 5ba243e5-8165-4cf7-8c69-e1d3669654c1\nstatus: test\ndescription: Detects potential DLL sideloading of \"MpSvc.dll\".\nreferences:\n    - https://hijacklibs.net/entries/microsoft/built-in/mpsvc.html\nauthor: Nasreddine Bencherchali (Nextron Systems), Wietze Beukema\ndate: 2024-07-11\ntags:\n    - attack.privilege-escalation\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.t1574.001\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\MpSvc.dll'\n    filter_main_generic:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files\\Windows Defender\\'\n            - 'C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\'\n            - 'C:\\Windows\\WinSxS\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Legitimate applications loading their own versions of the DLL mentioned in this rule.\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_mfdetours_unsigned.yml","content":"title: Unsigned Mfdetours.DLL Sideloading\nid: 948a0953-f287-4806-bbcb-3b2e396df89f\nrelated:\n    - id: d2605a99-2218-4894-8fd3-2afb7946514d\n      type: similar\nstatus: test\ndescription: Detects DLL sideloading of unsigned \"mfdetours.dll\". Executing \"mftrace.exe\" can be abused to attach to an arbitrary process and force load any DLL named \"mfdetours.dll\" from the current directory of execution.\nreferences:\n    - Internal Research\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-08-11\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\mfdetours.dll'\n    filter_main_legit_path:\n        ImageLoaded|contains: ':\\Program Files (x86)\\Windows Kits\\10\\bin\\'\n        SignatureStatus: 'Valid'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_mfdetours.yml","content":"title: Potential Mfdetours.DLL Sideloading\nid: d2605a99-2218-4894-8fd3-2afb7946514d\nstatus: test\ndescription: Detects potential DLL sideloading of \"mfdetours.dll\". While using \"mftrace.exe\" it can be abused to attach to an arbitrary process and force load any DLL named \"mfdetours.dll\" from the current directory of execution.\nreferences:\n    - Internal Research\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-08-03\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\mfdetours.dll'\n    filter_main_legit_path:\n        ImageLoaded|contains: ':\\Program Files (x86)\\Windows Kits\\10\\bin\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unlikely\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_libvlc.yml","content":"title: Potential Libvlc.DLL Sideloading\nid: bf9808c4-d24f-44a2-8398-b65227d406b6\nstatus: test\ndescription: Detects potential DLL sideloading of \"libvlc.dll\", a DLL that is legitimately used by \"VLC.exe\"\nreferences:\n    - https://www.trendmicro.com/en_us/research/23/c/earth-preta-updated-stealthy-strategies.html\n    - https://hijacklibs.net/entries/3rd_party/vlc/libvlc.html\nauthor: X__Junior\ndate: 2023-04-17\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\libvlc.dll'\n    filter_main_vlc:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\VideoLAN\\VLC\\'\n            - 'C:\\Program Files\\VideoLAN\\VLC\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - False positives are expected if VLC is installed in non-default locations\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_keyscrambler.yml","content":"title: Potential DLL Sideloading Of KeyScramblerIE.DLL Via KeyScrambler.EXE\nid: d2451be2-b582-4e15-8701-4196ac180260\nrelated:\n    - id: ca5583e9-8f80-46ac-ab91-7f314d13b984\n      type: similar\nstatus: test\ndescription: |\n    Detects potential DLL side loading of \"KeyScramblerIE.dll\" by \"KeyScrambler.exe\".\n    Various threat actors and malware have been found side loading a masqueraded \"KeyScramblerIE.dll\" through \"KeyScrambler.exe\".\nreferences:\n    - https://thehackernews.com/2024/03/two-chinese-apt-groups-ramp-up-cyber.html\n    - https://csirt-cti.net/2024/02/01/stately-taurus-continued-new-information-on-cyberespionage-attacks-against-myanmar-military-junta/\n    - https://bazaar.abuse.ch/sample/5cb9876681f78d3ee8a01a5aaa5d38b05ec81edc48b09e3865b75c49a2187831/\n    - https://twitter.com/Max_Mal_/status/1775222576639291859\n    - https://twitter.com/DTCERT/status/1712785426895839339\nauthor: Swachchhanda Shrawan Poudel\ndate: 2024-04-15\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\KeyScrambler.exe'\n            - '\\KeyScramblerLogon.exe'\n        ImageLoaded|endswith: '\\KeyScramblerIE.dll'\n    filter_main_legitimate_path:\n        Image|contains:\n            - 'C:\\Program Files (x86)\\KeyScrambler\\'\n            - 'C:\\Program Files\\KeyScrambler\\'\n        ImageLoaded|contains:\n            - 'C:\\Program Files (x86)\\KeyScrambler\\'\n            - 'C:\\Program Files\\KeyScrambler\\'\n    filter_main_signature:\n        Signature: 'QFX Software Corporation'\n        SignatureStatus: 'Valid'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_side_load_jsschhlp.yml","content":"title: Potential DLL Sideloading Via JsSchHlp\nid: 68654bf0-4412-43d5-bfe8-5eaa393cd939\nstatus: test\ndescription: Detects potential DLL sideloading using JUSTSYSTEMS Japanese word processor\nreferences:\n    - https://www.welivesecurity.com/2022/12/14/unmasking-mirrorface-operation-liberalface-targeting-japanese-political-entities/\n    - http://www.windowexe.com/bbs/board.php?q=jsschhlp-exe-c-program-files-common-files-justsystem-jsschhlp-jsschhlp\nauthor: frack113\ndate: 2022-12-14\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\JSESPR.dll'\n    filter:\n        ImageLoaded|startswith: 'C:\\Program Files\\Common Files\\Justsystem\\JsSchHlp\\'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_jli.yml","content":"title: Potential JLI.dll Side-Loading\nid: 7a3b6d1f-4a2b-4f8c-9d7e-e9f8cbf21a35\nstatus: experimental\ndescription: |\n    Detects potential DLL side-loading of jli.dll.\n    JLI.dll has been observed being side-loaded by Java processes by various threat actors, including APT41, XWorm,\n    and others in order to load malicious payloads in context of legitimate Java processes.\nreferences:\n    - https://securelist.com/apt41-in-africa/116986/\n    - https://lab52.io/blog/snake-keylogger-in-geopolitical-affairs-abuse-of-trusted-java-utilities-in-cybercrime-operations/\n    - https://hijacklibs.net/entries/3rd_party/oracle/jli.html\n    - https://www.proofpoint.com/us/blog/threat-insight/phish-china-aligned-espionage-actors-ramp-up-taiwan-semiconductor-targeting\nauthor: Swachchhanda Shrawan Poudel (Nextron Systems)\ndate: 2025-07-25\nmodified: 2025-10-06\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\jli.dll'\n    filter_main_legitimate_install_paths:\n        ImageLoaded|startswith:\n            # Keeping the paths generic as jli.dll was found inside various directories of installed software\n            - 'C:\\Program Files\\'\n            - 'C:\\Program Files (x86)\\'\n        Description: 'OpenJDK Platform binary'\n        OriginalFileName: 'jli.dll'\n        Product|startswith: 'OpenJDK Platform'\n        Signed: 'true'\n    filter_optional_eclipse:\n        ImageLoaded|startswith: 'C:\\eclipse\\plugins\\'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_side_load_iviewers.yml","content":"title: Potential Iviewers.DLL Sideloading\nid: 4c21b805-4dd7-469f-b47d-7383a8fcb437\nstatus: test\ndescription: Detects potential DLL sideloading of \"iviewers.dll\" (OLE/COM Object Interface Viewer)\nreferences:\n    - https://www.secureworks.com/research/shadowpad-malware-analysis\nauthor: X__Junior (Nextron Systems)\ndate: 2023-03-21\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\iviewers.dll'\n    filter:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\Windows Kits\\'\n            - 'C:\\Program Files\\Windows Kits\\'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_side_load_gup_libcurl.yml","content":"title: Potential DLL Sideloading Of Libcurl.DLL Via GUP.EXE\nid: e49b5745-1064-4ac1-9a2e-f687bc2dd37e\nstatus: test\ndescription: Detects potential DLL sideloading of \"libcurl.dll\" by the \"gup.exe\" process from an uncommon location\nreferences:\n    - https://labs.withsecure.com/publications/fin7-target-veeam-servers\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-05-05\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\gup.exe'\n        ImageLoaded|endswith: '\\libcurl.dll'\n    filter_main_notepad_plusplus:\n        Image|endswith: '\\Notepad++\\updater\\GUP.exe'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_goopdate.yml","content":"title: Potential Goopdate.DLL Sideloading\nid: b6188d2f-b3c4-4d2c-a17d-9706e0851af0\nstatus: test\ndescription: Detects potential DLL sideloading of \"goopdate.dll\", a DLL used by googleupdate.exe\nreferences:\n    - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf\nauthor: X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-05-15\nmodified: 2025-10-07\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\goopdate.dll'\n    filter_main_generic:\n        ImageLoaded|startswith:\n            # Many third party chromium based apps use this DLLs. It's better to create a baseline and add specific filters\n            - 'C:\\Program Files (x86)\\'\n            - 'C:\\Program Files\\'\n    filter_optional_dropbox_installer_temp:\n        Image|contains|all:\n            - '\\AppData\\Local\\Temp\\GUM'\n            - '.tmp\\Dropbox'\n        ImageLoaded|contains|all:\n            - '\\AppData\\Local\\Temp\\GUM'\n            - '.tmp\\goopdate.dll'\n    filter_optional_googleupdate_temp:\n        Image|contains:\n            - '\\AppData\\Local\\Temp\\GUM'\n            - ':\\Windows\\SystemTemp\\GUM'\n        Image|endswith: '.tmp\\GoogleUpdate.exe'\n        ImageLoaded|contains:\n            - '\\AppData\\Local\\Temp\\GUM'\n            - ':\\Windows\\SystemTemp\\GUM'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - False positives are expected from Google Chrome installations running from user locations (AppData) and other custom locations. Apply additional filters accordingly.\n    - Other third party chromium browsers located in AppData\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_from_non_system_location.yml","content":"title: Potential System DLL Sideloading From Non System Locations\nid: 4fc0deee-0057-4998-ab31-d24e46e0aba4\nstatus: test\ndescription: Detects DLL sideloading of DLLs usually located in system locations (System32, SysWOW64, etc.).\nreferences:\n    - https://hijacklibs.net/ # For list of DLLs that could be sideloaded (search for dlls mentioned here in there). Wietze Beukema (project and research)\n    - https://blog.cyble.com/2022/07/21/qakbot-resurfaces-with-new-playbook/ # WindowsCodecs.dll\n    - https://blog.cyble.com/2022/07/27/targeted-attacks-being-carried-out-via-dll-sideloading/ # iphlpapi.dll\n    - https://github.com/XForceIR/SideLoadHunter/blob/cc7ef2e5d8908279b0c4cee4e8b6f85f7b8eed52/SideLoads/README.md # XForceIR (SideLoadHunter Project), Chris Spehn (research WFH Dridex)\n    - https://www.hexacorn.com/blog/2023/12/26/1-little-known-secret-of-runonce-exe-32-bit/\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-14\nmodified: 2025-02-26\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith:\n            - '\\aclui.dll'\n            - '\\activeds.dll'\n            - '\\adsldpc.dll'\n            - '\\aepic.dll'\n            - '\\apphelp.dll'\n            - '\\applicationframe.dll'\n            - '\\appvpolicy.dll'\n            - '\\appxalluserstore.dll'\n            - '\\appxdeploymentclient.dll'\n            - '\\archiveint.dll'\n            - '\\atl.dll'\n            - '\\audioses.dll'\n            - '\\auditpolcore.dll'\n            - '\\authfwcfg.dll'\n            - '\\authz.dll'\n            - '\\avrt.dll'\n            - '\\batmeter.dll'\n            - '\\bcd.dll'\n            - '\\bcp47langs.dll'\n            - '\\bcp47mrm.dll'\n            - '\\bcrypt.dll'\n            - '\\bderepair.dll'\n            - '\\bootmenuux.dll'\n            - '\\bootux.dll'\n            - '\\cabinet.dll'\n            - '\\cabview.dll'\n            - '\\certcli.dll'\n            - '\\certenroll.dll'\n            - '\\cfgmgr32.dll'\n            - '\\cldapi.dll'\n            - '\\clipc.dll'\n            - '\\clusapi.dll'\n            - '\\cmpbk32.dll'\n            - '\\cmutil.dll'\n            - '\\coloradapterclient.dll'\n            - '\\colorui.dll'\n            - '\\comdlg32.dll'\n            - '\\configmanager2.dll'\n            - '\\connect.dll'\n            - '\\coredplus.dll'\n            - '\\coremessaging.dll'\n            - '\\coreuicomponents.dll'\n            - '\\credui.dll'\n            - '\\cryptbase.dll'\n            - '\\cryptdll.dll'\n            - '\\cryptsp.dll'\n            - '\\cryptui.dll'\n            - '\\cryptxml.dll'\n            - '\\cscapi.dll'\n            - '\\cscobj.dll'\n            - '\\cscui.dll'\n            - '\\d2d1.dll'\n            - '\\d3d10_1.dll'\n            - '\\d3d10_1core.dll'\n            - '\\d3d10.dll'\n            - '\\d3d10core.dll'\n            - '\\d3d10warp.dll'\n            - '\\d3d11.dll'\n            - '\\d3d12.dll'\n            - '\\d3d9.dll'\n            - '\\d3dx9_43.dll'\n            - '\\dataexchange.dll'\n            - '\\davclnt.dll'\n            - '\\dcntel.dll'\n            - '\\dcomp.dll'\n            - '\\defragproxy.dll'\n            - '\\desktopshellext.dll'\n            - '\\deviceassociation.dll'\n            - '\\devicecredential.dll'\n            - '\\devicepairing.dll'\n            - '\\devobj.dll'\n            - '\\devrtl.dll'\n            - '\\dhcpcmonitor.dll'\n            - '\\dhcpcsvc.dll'\n            - '\\dhcpcsvc6.dll'\n            - '\\directmanipulation.dll'\n            - '\\dismapi.dll'\n            - '\\dismcore.dll'\n            - '\\dmcfgutils.dll'\n            - '\\dmcmnutils.dll'\n            - '\\dmcommandlineutils.dll'\n            - '\\dmenrollengine.dll'\n            - '\\dmenterprisediagnostics.dll'\n            - '\\dmiso8601utils.dll'\n            - '\\dmoleaututils.dll'\n            - '\\dmprocessxmlfiltered.dll'\n            - '\\dmpushproxy.dll'\n            - '\\dmxmlhelputils.dll'\n            - '\\dnsapi.dll'\n            - '\\dot3api.dll'\n            - '\\dot3cfg.dll'\n            - '\\dpx.dll'\n            - '\\drprov.dll'\n            - '\\drvstore.dll'\n            - '\\dsclient.dll'\n            - '\\dsparse.dll'\n            - '\\dsprop.dll'\n            - '\\dsreg.dll'\n            - '\\dsrole.dll'\n            - '\\dui70.dll'\n            - '\\duser.dll'\n            - '\\dusmapi.dll'\n            - '\\dwmapi.dll'\n            - '\\dwmcore.dll'\n            - '\\dwrite.dll'\n            - '\\dxcore.dll'\n            - '\\dxgi.dll'\n            - '\\dxva2.dll'\n            - '\\dynamoapi.dll'\n            - '\\eappcfg.dll'\n            - '\\eappprxy.dll'\n            - '\\edgeiso.dll'\n            - '\\edputil.dll'\n            - '\\efsadu.dll'\n            - '\\efsutil.dll'\n            - '\\esent.dll'\n            - '\\execmodelproxy.dll'\n            - '\\explorerframe.dll'\n            - '\\fastprox.dll'\n            - '\\faultrep.dll'\n            - '\\fddevquery.dll'\n            - '\\feclient.dll'\n            - '\\fhcfg.dll'\n            - '\\fhsvcctl.dll'\n            - '\\firewallapi.dll'\n            - '\\flightsettings.dll'\n            - '\\fltlib.dll'\n            - '\\framedynos.dll'\n            - '\\fveapi.dll'\n            - '\\fveskybackup.dll'\n            - '\\fvewiz.dll'\n            - '\\fwbase.dll'\n            - '\\fwcfg.dll'\n            - '\\fwpolicyiomgr.dll'\n            - '\\fwpuclnt.dll'\n            - '\\fxsapi.dll'\n            - '\\fxsst.dll'\n            - '\\fxstiff.dll'\n            - '\\getuname.dll'\n            - '\\gpapi.dll'\n            - '\\hid.dll'\n            - '\\hnetmon.dll'\n            - '\\httpapi.dll'\n            - '\\icmp.dll'\n            - '\\idstore.dll'\n            - '\\ieadvpack.dll'\n            - '\\iedkcs32.dll'\n            - '\\iernonce.dll'\n            - '\\iertutil.dll'\n            - '\\ifmon.dll'\n            - '\\ifsutil.dll'\n            - '\\inproclogger.dll'\n            - '\\iphlpapi.dll'\n            - '\\iri.dll'\n            - '\\iscsidsc.dll'\n            - '\\iscsium.dll'\n            - '\\isv.exe_rsaenh.dll'\n            - '\\iumbase.dll'\n            - '\\iumsdk.dll'\n            - '\\joinutil.dll'\n            - '\\kdstub.dll'\n            - '\\ksuser.dll'\n            - '\\ktmw32.dll'\n            - '\\licensemanagerapi.dll'\n            - '\\licensingdiagspp.dll'\n            - '\\linkinfo.dll'\n            - '\\loadperf.dll'\n            - '\\lockhostingframework.dll'\n            - '\\logoncli.dll'\n            - '\\logoncontroller.dll'\n            - '\\lpksetupproxyserv.dll'\n            - '\\lrwizdll.dll'\n            - '\\magnification.dll'\n            - '\\maintenanceui.dll'\n            - '\\mapistub.dll'\n            - '\\mbaexmlparser.dll'\n            - '\\mdmdiagnostics.dll'\n            - '\\mfc42u.dll'\n            - '\\mfcore.dll'\n            - '\\mfplat.dll'\n            - '\\mi.dll'\n            - '\\midimap.dll'\n            - '\\mintdh.dll'\n            - '\\miutils.dll'\n            - '\\mlang.dll'\n            - '\\mmdevapi.dll'\n            - '\\mobilenetworking.dll'\n            - '\\mpr.dll'\n            - '\\mprapi.dll'\n            - '\\mrmcorer.dll'\n            - '\\msacm32.dll'\n            - '\\mscms.dll'\n            - '\\mscoree.dll'\n            - '\\msctf.dll'\n            - '\\msctfmonitor.dll'\n            - '\\msdrm.dll'\n            - '\\msdtctm.dll'\n            - '\\msftedit.dll'\n            - '\\msi.dll'\n            - '\\msiso.dll'\n            - '\\msutb.dll'\n            - '\\msvcp110_win.dll'\n            - '\\mswb7.dll'\n            - '\\mswsock.dll'\n            - '\\msxml3.dll'\n            - '\\mtxclu.dll'\n            - '\\napinsp.dll'\n            - '\\ncrypt.dll'\n            - '\\ndfapi.dll'\n            - '\\netapi32.dll'\n            - '\\netid.dll'\n            - '\\netiohlp.dll'\n            - '\\netjoin.dll'\n            - '\\netplwiz.dll'\n            - '\\netprofm.dll'\n            - '\\netprovfw.dll'\n            - '\\netsetupapi.dll'\n            - '\\netshell.dll'\n            - '\\nettrace.dll'\n            - '\\netutils.dll'\n            - '\\networkexplorer.dll'\n            - '\\newdev.dll'\n            - '\\ninput.dll'\n            - '\\nlaapi.dll'\n            - '\\nlansp_c.dll'\n            - '\\npmproxy.dll'\n            - '\\nshhttp.dll'\n            - '\\nshipsec.dll'\n            - '\\nshwfp.dll'\n            - '\\ntdsapi.dll'\n            - '\\ntlanman.dll'\n            - '\\ntlmshared.dll'\n            - '\\ntmarta.dll'\n            - '\\ntshrui.dll'\n            - '\\oleacc.dll'\n            - '\\omadmapi.dll'\n            - '\\onex.dll'\n            - '\\opcservices.dll'\n            - '\\osbaseln.dll'\n            - '\\osksupport.dll'\n            - '\\osuninst.dll'\n            - '\\p2p.dll'\n            - '\\p2pnetsh.dll'\n            - '\\p9np.dll'\n            - '\\pcaui.dll'\n            - '\\pdh.dll'\n            - '\\peerdistsh.dll'\n            - '\\pkeyhelper.dll'\n            - '\\pla.dll'\n            - '\\playsndsrv.dll'\n            - '\\pnrpnsp.dll'\n            - '\\policymanager.dll'\n            - '\\polstore.dll'\n            - '\\powrprof.dll'\n            - '\\printui.dll'\n            - '\\prntvpt.dll'\n            - '\\profapi.dll'\n            - '\\propsys.dll'\n            - '\\proximitycommon.dll'\n            - '\\proximityservicepal.dll'\n            - '\\prvdmofcomp.dll'\n            - '\\puiapi.dll'\n            - '\\radcui.dll'\n            - '\\rasapi32.dll'\n            - '\\rasdlg.dll'\n            - '\\rasgcw.dll'\n            - '\\rasman.dll'\n            - '\\rasmontr.dll'\n            - '\\reagent.dll'\n            - '\\regapi.dll'\n            - '\\reseteng.dll'\n            - '\\resetengine.dll'\n            - '\\resutils.dll'\n            - '\\rmclient.dll'\n            - '\\rpcnsh.dll'\n            - '\\rsaenh.dll'\n            - '\\rtutils.dll'\n            - '\\rtworkq.dll'\n            - '\\samcli.dll'\n            - '\\samlib.dll'\n            - '\\sapi_onecore.dll'\n            - '\\sas.dll'\n            - '\\scansetting.dll'\n            - '\\scecli.dll'\n            - '\\schedcli.dll'\n            - '\\secur32.dll'\n            - '\\security.dll'\n            - '\\sensapi.dll'\n            - '\\shell32.dll'\n            - '\\shfolder.dll'\n            - '\\slc.dll'\n            - '\\snmpapi.dll'\n            - '\\spectrumsyncclient.dll'\n            - '\\spp.dll'\n            - '\\sppc.dll'\n            - '\\sppcext.dll'\n            - '\\srclient.dll'\n            - '\\srcore.dll'\n            - '\\srmtrace.dll'\n            - '\\srpapi.dll'\n            - '\\srvcli.dll'\n            - '\\ssp_isv.exe_rsaenh.dll'\n            - '\\ssp.exe_rsaenh.dll'\n            - '\\sspicli.dll'\n            - '\\ssshim.dll'\n            - '\\staterepository.core.dll'\n            - '\\structuredquery.dll'\n            - '\\sxshared.dll'\n            - '\\systemsettingsthresholdadminflowui.dll'\n            - '\\tapi32.dll'\n            - '\\tbs.dll'\n            - '\\tdh.dll'\n            - '\\textshaping.dll'\n            - '\\timesync.dll'\n            - '\\tpmcoreprovisioning.dll'\n            - '\\tquery.dll'\n            - '\\tsworkspace.dll'\n            - '\\ttdrecord.dll'\n            - '\\twext.dll'\n            - '\\twinapi.dll'\n            - '\\twinui.appcore.dll'\n            - '\\uianimation.dll'\n            - '\\uiautomationcore.dll'\n            - '\\uireng.dll'\n            - '\\uiribbon.dll'\n            - '\\umpdc.dll'\n            - '\\unattend.dll'\n            - '\\updatepolicy.dll'\n            - '\\upshared.dll'\n            - '\\urlmon.dll'\n            - '\\userenv.dll'\n            - '\\utildll.dll'\n            - '\\uxinit.dll'\n            - '\\uxtheme.dll'\n            - '\\vaultcli.dll'\n            - '\\vdsutil.dll'\n            - '\\version.dll'\n            - '\\virtdisk.dll'\n            - '\\vssapi.dll'\n            - '\\vsstrace.dll'\n            - '\\wbemprox.dll'\n            - '\\wbemsvc.dll'\n            - '\\wcmapi.dll'\n            - '\\wcnnetsh.dll'\n            - '\\wdi.dll'\n            - '\\wdscore.dll'\n            - '\\webservices.dll'\n            - '\\wecapi.dll'\n            - '\\wer.dll'\n            - '\\wevtapi.dll'\n            - '\\whhelper.dll'\n            - '\\wimgapi.dll'\n            - '\\winbio.dll'\n            - '\\winbrand.dll'\n            - '\\windows.storage.dll'\n            - '\\windows.storage.search.dll'\n            - '\\windows.ui.immersive.dll'\n            - '\\windowscodecs.dll'\n            - '\\windowscodecsext.dll'\n            - '\\windowsudk.shellcommon.dll'\n            - '\\winhttp.dll'\n            - '\\wininet.dll'\n            - '\\winipsec.dll'\n            - '\\winmde.dll'\n            - '\\winmm.dll'\n            - '\\winnsi.dll'\n            - '\\winrnr.dll'\n            - '\\winscard.dll'\n            - '\\winsqlite3.dll'\n            - '\\winsta.dll'\n            - '\\winsync.dll'\n            - '\\wkscli.dll'\n            - '\\wlanapi.dll'\n            - '\\wlancfg.dll'\n            - '\\wldp.dll'\n            - '\\wlidprov.dll'\n            - '\\wmiclnt.dll'\n            - '\\wmidcom.dll'\n            - '\\wmiutils.dll'\n            - '\\wmpdui.dll'\n            - '\\wmsgapi.dll'\n            - '\\wofutil.dll'\n            - '\\wpdshext.dll'\n            - '\\wscapi.dll'\n            - '\\wsdapi.dll'\n            - '\\wshbth.dll'\n            - '\\wshelper.dll'\n            - '\\wsmsvc.dll'\n            - '\\wtsapi32.dll'\n            - '\\wwancfg.dll'\n            - '\\wwapi.dll'\n            - '\\xmllite.dll'\n            - '\\xolehlp.dll'\n            - '\\xpsservices.dll'\n            - '\\xwizards.dll'\n            - '\\xwtpw32.dll'\n            # From https://github.com/XForceIR/SideLoadHunter/blob/main/SideLoads/README.md\n            - '\\amsi.dll'\n            - '\\appraiser.dll'\n            - '\\COMRES.DLL'\n            - '\\cryptnet.dll'\n            - '\\DispBroker.dll'\n            - '\\dsound.dll'\n            - '\\dxilconv.dll'\n            - '\\FxsCompose.dll'\n            - '\\FXSRESM.DLL'\n            - '\\msdtcVSp1res.dll'\n            - '\\PrintIsolationProxy.dll'\n            - '\\rdpendp.dll'\n            - '\\rpchttp.dll'\n            - '\\storageusage.dll'\n            - '\\utcutil.dll'\n            - '\\WfsR.dll'\n            # The DLLs below exists in \"C:\\Windows\\System32\\DriverStore\\FileRepository\\\" folder. But there is also a copy located in \"C:\\ProgramData\\Package Cache\\XXXXXXX\\Graphics\\\". If you see them being loaded from there. Please comment them out, don't add a filter for ProgramData :)\n            - '\\igd10iumd64.dll'\n            - '\\igd12umd64.dll'\n            - '\\igdumdim64.dll'\n            - '\\igdusc64.dll'\n            # Other\n            - '\\TSMSISrv.dll'\n            - '\\TSVIPSrv.dll'\n            - '\\wbemcomn.dll'\n            - '\\WLBSCTRL.dll'\n            - '\\wow64log.dll'\n            - '\\WptsExtensions.dll'\n    filter_main_generic:\n        # Note: this filter is generic on purpose to avoid insane amount of FP from legitimate third party applications. A better approach would be to baseline everything and add specific filters to avoid blind spots\n        ImageLoaded|contains:\n            - 'C:\\$WINDOWS.~BT\\'\n            - 'C:\\$WinREAgent\\'\n            - 'C:\\Windows\\SoftwareDistribution\\'\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\SystemTemp\\'\n            - 'C:\\Windows\\SysWOW64\\'\n            - 'C:\\Windows\\WinSxS\\'\n            - 'C:\\Windows\\SyChpe32\\' # hybrid binaries containing x86-to-ARM stubs to improve the x86 emulation performance\n    filter_main_dot_net:\n        ImageLoaded|startswith: 'C:\\Windows\\Microsoft.NET\\'\n        ImageLoaded|endswith: '\\cscui.dll'\n    filter_main_defender:\n        ImageLoaded|startswith: 'C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\'\n        ImageLoaded|endswith: '\\version.dll'\n    filter_main_directx:\n        ImageLoaded|startswith: 'C:\\Program Files\\WindowsApps\\Microsoft.DirectXRuntime_'\n        ImageLoaded|endswith: '\\d3dx9_43.dll'\n    filter_optional_exchange:\n        ImageLoaded|startswith: 'C:\\Program Files\\Microsoft\\Exchange Server\\'\n        ImageLoaded|endswith: '\\mswb7.dll'\n    filter_optional_arsenal_image_mounter:\n        ImageLoaded|startswith: 'C:\\Program Files\\Arsenal-Image-Mounter-'\n        ImageLoaded|endswith:\n            - '\\mi.dll'\n            - '\\miutils.dl'\n    filter_optional_office_appvpolicy:\n        Image: 'C:\\Program Files\\Common Files\\microsoft shared\\ClickToRun\\OfficeClickToRun.exe'\n        ImageLoaded: 'C:\\Program Files\\Common Files\\microsoft shared\\ClickToRun\\AppVPolicy.dll'\n    filter_optional_azure:\n        ImageLoaded|startswith: 'C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\'\n    filter_optional_dell:\n        Image|contains:\n            - 'C:\\Program Files\\WindowsApps\\DellInc.DellSupportAssistforPCs'\n            - 'C:\\Windows\\System32\\backgroundTaskHost.exe'\n        ImageLoaded|startswith: 'C:\\Program Files\\WindowsApps\\DellInc.DellSupportAssistforPCs'\n    filter_optional_dell_wldp:\n        Image|startswith: 'C:\\Program Files\\WindowsApps\\DellInc.DellSupportAssistforPCs'\n        Image|endswith: '\\wldp.dll'\n    filter_optional_checkpoint:\n        Image|startswith:\n            - 'C:\\Program Files\\CheckPoint\\'\n            - 'C:\\Program Files (x86)\\CheckPoint\\'\n        Image|endswith: '\\SmartConsole.exe'\n        ImageLoaded|startswith:\n            - 'C:\\Program Files\\CheckPoint\\'\n            - 'C:\\Program Files (x86)\\CheckPoint\\'\n        ImageLoaded|endswith: '\\PolicyManager.dll'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Legitimate applications loading their own versions of the DLLs mentioned in this rule\nlevel: high\n"},{"path":"image_load\\image_load_side_load_edputil.yml","content":"title: Potential Edputil.DLL Sideloading\nid: e4903324-1a10-4ed3-981b-f6fe3be3a2c2\nstatus: test\ndescription: Detects potential DLL sideloading of \"edputil.dll\"\nreferences:\n    - https://alternativeto.net/news/2023/5/cybercriminals-use-wordpad-vulnerability-to-spread-qbot-malware/\nauthor: X__Junior (Nextron Systems)\ndate: 2023-06-09\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\edputil.dll'\n    filter_main_generic:\n        ImageLoaded|startswith:\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\SysWOW64\\'\n            - 'C\\Windows\\WinSxS\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_eacore.yml","content":"title: Potential EACore.DLL Sideloading\nid: edd3ddc3-386f-4ba5-9ada-4376b2cfa7b5\nstatus: test\ndescription: Detects potential DLL sideloading of \"EACore.dll\"\nreferences:\n    - https://research.checkpoint.com/2023/beyond-the-horizon-traveling-the-world-on-camaro-dragons-usb-flash-drives/\nauthor: X__Junior (Nextron Systems)\ndate: 2023-08-03\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\EACore.dll'\n    filter_main_legit_path:\n        Image|contains|all:\n            - 'C:\\Program Files\\Electronic Arts\\EA Desktop\\'\n            - '\\EACoreServer.exe'\n        ImageLoaded|startswith: 'C:\\Program Files\\Electronic Arts\\EA Desktop\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_dbgmodel.yml","content":"title: Potential DLL Sideloading Of DbgModel.DLL\nid: fef394cd-f44d-4040-9b18-95d92fe278c0\nstatus: test\ndescription: Detects potential DLL sideloading of \"DbgModel.dll\"\nreferences:\n    - https://hijacklibs.net/entries/microsoft/built-in/dbgmodel.html\nauthor: Gary Lobermier\ndate: 2024-07-11\nmodified: 2024-07-22\ntags:\n    - attack.privilege-escalation\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.t1574.001\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\dbgmodel.dll'\n    filter_main_generic:\n        ImageLoaded|startswith:\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\SysWOW64\\'\n            - 'C:\\Windows\\WinSxS\\'\n    filter_optional_windbg:\n        ImageLoaded|startswith: 'C:\\Program Files\\WindowsApps\\Microsoft.WinDbg_'\n    filter_optional_windows_kits:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\Windows Kits\\'\n            - 'C:\\Program Files\\Windows Kits\\'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Legitimate applications loading their own versions of the DLL mentioned in this rule\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_dbghelp.yml","content":"title: Potential DLL Sideloading Of DBGHELP.DLL\nid: 6414b5cd-b19d-447e-bb5e-9f03940b5784\nstatus: test\ndescription: Detects potential DLL sideloading of \"dbghelp.dll\"\nreferences:\n    - https://hijacklibs.net/ # For list of DLLs that could be sideloaded (search for dlls mentioned here in there)\nauthor: Nasreddine Bencherchali (Nextron Systems), Wietze Beukema (project and research)\ndate: 2022-10-25\nmodified: 2025-10-07\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\dbghelp.dll'\n    filter_main_generic:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\'\n            - 'C:\\Program Files\\'\n            - 'C:\\Windows\\SoftwareDistribution\\'\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\SystemTemp\\'\n            - 'C:\\Windows\\SysWOW64\\'\n            - 'C:\\Windows\\WinSxS\\'\n    filter_optional_anaconda:\n        ImageLoaded|endswith:\n            - '\\Anaconda3\\Lib\\site-packages\\vtrace\\platforms\\windll\\amd64\\dbghelp.dll'\n            - '\\Anaconda3\\Lib\\site-packages\\vtrace\\platforms\\windll\\i386\\dbghelp.dll'\n    filter_optional_epicgames:\n        ImageLoaded|endswith:\n            - '\\Epic Games\\Launcher\\Engine\\Binaries\\ThirdParty\\DbgHelp\\dbghelp.dll'\n            - '\\Epic Games\\MagicLegends\\x86\\dbghelp.dll'\n    filter_optional_opera:\n        ImageLoaded|contains: 'opera\\Opera Installer Temp\\opera_package'\n        ImageLoaded|endswith: '\\assistant\\dbghelp.dll'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Legitimate applications loading their own versions of the DLL mentioned in this rule\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_dbgcore.yml","content":"title: Potential DLL Sideloading Of DBGCORE.DLL\nid: 9ca2bf31-0570-44d8-a543-534c47c33ed7\nstatus: test\ndescription: Detects DLL sideloading of \"dbgcore.dll\"\nreferences:\n    - https://hijacklibs.net/ # For list of DLLs that could be sideloaded (search for dlls mentioned here in there)\nauthor: Nasreddine Bencherchali (Nextron Systems), Wietze Beukema (project and research)\ndate: 2022-10-25\nmodified: 2025-10-06\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\dbgcore.dll'\n    filter_main_generic:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\'\n            - 'C:\\Program Files\\'\n            - 'C:\\Windows\\SoftwareDistribution\\'\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\SystemTemp\\'\n            - 'C:\\Windows\\SysWOW64\\'\n            - 'C:\\Windows\\WinSxS\\'\n    filter_optional_steam:\n        ImageLoaded|endswith: '\\Steam\\bin\\cef\\cef.win7x64\\dbgcore.dll'\n    filter_optional_opera:\n        # C:\\\\Users\\\\User\\\\AppData\\\\Local\\\\Temp\\\\.opera\\\\Opera Installer Temp\\\\opera_package_202311051506321\\\\assistant\\\\dbgcore.dll\n        ImageLoaded|contains: 'opera\\Opera Installer Temp\\opera_package'\n        ImageLoaded|endswith: '\\assistant\\dbgcore.dll'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Legitimate applications loading their own versions of the DLL mentioned in this rule\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_cpl_from_non_system_location.yml","content":"title: System Control Panel Item Loaded From Uncommon Location\nid: 2b140a5c-dc02-4bb8-b6b1-8bdb45714cde\nstatus: test\ndescription: Detects image load events of system control panel items (.cpl) from uncommon or non-system locations which might be the result of sideloading.\nreferences:\n    - https://www.hexacorn.com/blog/2024/01/06/1-little-known-secret-of-fondue-exe/\n    - https://www.hexacorn.com/blog/2024/01/01/1-little-known-secret-of-hdwwiz-exe/\nauthor: Anish Bogati\ndate: 2024-01-09\ntags:\n    - attack.defense-evasion\n    - attack.t1036\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        ImageLoaded|endswith:\n            - '\\hdwwiz.cpl' # Usually loaded by hdwwiz.exe\n            - '\\appwiz.cpl' # Usually loaded by fondue.exe\n    filter_main_legit_location:\n        ImageLoaded|contains:\n            - ':\\Windows\\System32\\'\n            - ':\\Windows\\SysWOW64\\'\n            - ':\\Windows\\WinSxS\\'\n    condition: selection and not 1 of filter_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_coregen.yml","content":"title: Potential DLL Sideloading Using Coregen.exe\nid: 0fa66f66-e3f6-4a9c-93f8-4f2610b00171\nstatus: test\ndescription: Detect usage of the \"coregen.exe\" (Microsoft CoreCLR Native Image Generator) binary to sideload arbitrary DLLs.\nreferences:\n    - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Coregen/\nauthor: frack113\ndate: 2022-12-31\ntags:\n    - attack.privilege-escalation\n    - attack.defense-evasion\n    - attack.t1218\n    - attack.t1055\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\coregen.exe'\n    filter_main_legit_paths:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\Microsoft Silverlight\\'\n            - 'C:\\Program Files\\Microsoft Silverlight\\'\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\SysWOW64\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_comctl32.yml","content":"title: Potential DLL Sideloading Via comctl32.dll\nid: 6360757a-d460-456c-8b13-74cf0e60cceb\nstatus: test\ndescription: Detects potential DLL sideloading using comctl32.dll to obtain system privileges\nreferences:\n    - https://github.com/binderlabs/DirCreate2System\n    - https://github.com/sailay1996/awesome_windows_logical_bugs/blob/60cbb23a801f4c3195deac1cc46df27c225c3d07/dir_create2system.txt\nauthor: Nasreddine Bencherchali (Nextron Systems), Subhash Popuri (@pbssubhash)\ndate: 2022-12-16\nmodified: 2022-12-19\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|startswith:\n            - 'C:\\Windows\\System32\\logonUI.exe.local\\'\n            - 'C:\\Windows\\System32\\werFault.exe.local\\'\n            - 'C:\\Windows\\System32\\consent.exe.local\\'\n            - 'C:\\Windows\\System32\\narrator.exe.local\\'\n            - 'C:\\windows\\system32\\wermgr.exe.local\\'\n        ImageLoaded|endswith: '\\comctl32.dll'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_classicexplorer32.yml","content":"title: Potential DLL Sideloading Via ClassicExplorer32.dll\nid: caa02837-f659-466f-bca6-48bde2826ab4\nstatus: test\ndescription: Detects potential DLL sideloading using ClassicExplorer32.dll from the Classic Shell software\nreferences:\n    - https://blogs.blackberry.com/en/2022/12/mustang-panda-uses-the-russian-ukrainian-war-to-attack-europe-and-asia-pacific-targets\n    - https://app.any.run/tasks/6d8cabb0-dcda-44b6-8050-28d6ce281687/\nauthor: frack113\ndate: 2022-12-13\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection_classicexplorer:\n        ImageLoaded|endswith: '\\ClassicExplorer32.dll'\n    filter_classicexplorer:\n        ImageLoaded|startswith: 'C:\\Program Files\\Classic Shell\\'\n    condition: selection_classicexplorer and not filter_classicexplorer\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_chrome_frame_helper.yml","content":"title: Potential Chrome Frame Helper DLL Sideloading\nid: 72ca7c75-bf85-45cd-aca7-255d360e423c\nstatus: test\ndescription: Detects potential DLL sideloading of \"chrome_frame_helper.dll\"\nreferences:\n    - https://hijacklibs.net/entries/3rd_party/google/chrome_frame_helper.html\nauthor: Nasreddine Bencherchali (Nextron Systems), Wietze Beukema (project and research)\ndate: 2022-08-17\nmodified: 2023-05-15\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\chrome_frame_helper.dll'\n    filter_main_path:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files\\Google\\Chrome\\Application\\'\n            - 'C:\\Program Files (x86)\\Google\\Chrome\\Application\\'\n    filter_optional_user_path:\n        ImageLoaded|contains: '\\AppData\\local\\Google\\Chrome\\Application\\'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_ccleaner_reactivator.yml","content":"title: Potential CCleanerReactivator.DLL Sideloading\nid: 3735d5ac-d770-4da0-99ff-156b180bc600\nstatus: test\ndescription: Detects potential DLL sideloading of \"CCleanerReactivator.dll\"\nreferences:\n    - https://lab52.io/blog/2344-2/\nauthor: X__Junior\ndate: 2023-07-13\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\CCleanerReactivator.dll'\n    filter_main_path:\n        Image|startswith:\n            - 'C:\\Program Files\\CCleaner\\'\n            - 'C:\\Program Files (x86)\\CCleaner\\'\n        Image|endswith: '\\CCleanerReactivator.exe'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - False positives could occur from other custom installation paths. Apply additional filters accordingly.\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_ccleaner_du.yml","content":"title: Potential CCleanerDU.DLL Sideloading\nid: 1fbc0671-5596-4e17-8682-f020a0b995dc\nstatus: test\ndescription: Detects potential DLL sideloading of \"CCleanerDU.dll\"\nreferences:\n    - https://lab52.io/blog/2344-2/\nauthor: X__Junior (Nextron Systems)\ndate: 2023-07-13\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\CCleanerDU.dll'\n    filter_main_path:\n        Image|startswith:\n            - 'C:\\Program Files\\CCleaner\\'\n            - 'C:\\Program Files (x86)\\CCleaner\\'\n        Image|endswith:\n            - '\\CCleaner.exe'\n            - '\\CCleaner64.exe'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - False positives could occur from other custom installation paths. Apply additional filters accordingly.\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_avkkid.yml","content":"title: Potential AVKkid.DLL Sideloading\nid: 952ed57c-8f99-453d-aee0-53a49c22f95d\nstatus: test\ndescription: Detects potential DLL sideloading of \"AVKkid.dll\"\nreferences:\n    - https://research.checkpoint.com/2023/beyond-the-horizon-traveling-the-world-on-camaro-dragons-usb-flash-drives/\nauthor: X__Junior (Nextron Systems)\ndate: 2023-08-03\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\AVKkid.dll'\n    filter_main_legit_path:\n        Image|contains:\n            - 'C:\\Program Files (x86)\\G DATA\\'\n            - 'C:\\Program Files\\G DATA\\'\n        Image|endswith: '\\AVKKid.exe'\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\G DATA\\'\n            - 'C:\\Program Files\\G DATA\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_aruba_networks_virtual_intranet_access.yml","content":"title: Aruba Network Service Potential DLL Sideloading\nid: 90ae0469-0cee-4509-b67f-e5efcef040f7\nstatus: test\ndescription: Detects potential DLL sideloading activity via the Aruba Networks Virtual Intranet Access \"arubanetsvc.exe\" process using DLL Search Order Hijacking\nreferences:\n    - https://twitter.com/wdormann/status/1616581559892545537?t=XLCBO9BziGzD7Bmbt8oMEQ&s=09\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-01-22\nmodified: 2023-03-15\ntags:\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.persistence\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\arubanetsvc.exe'\n        ImageLoaded|endswith:\n            - '\\wtsapi32.dll'\n            - '\\msvcr100.dll'\n            - '\\msvcp100.dll'\n            - '\\dbghelp.dll'\n            - '\\dbgcore.dll'\n            - '\\wininet.dll'\n            - '\\iphlpapi.dll'\n            - '\\version.dll'\n            - '\\cryptsp.dll'\n            - '\\cryptbase.dll'\n            - '\\wldp.dll'\n            - '\\profapi.dll'\n            - '\\sspicli.dll'\n            - '\\winsta.dll'\n            - '\\dpapi.dll'\n    filter:\n        ImageLoaded|startswith:\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\SysWOW64\\'\n            - 'C:\\Windows\\WinSxS\\'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_side_load_appverifui.yml","content":"title: Potential appverifUI.DLL Sideloading\nid: ee6cea48-c5b6-4304-a332-10fc6446f484\nstatus: test\ndescription: Detects potential DLL sideloading of \"appverifUI.dll\"\nreferences:\n    - https://web.archive.org/web/20220519091349/https://fatrodzianko.com/2020/02/15/dll-side-loading-appverif-exe/\nauthor: X__Junior (Nextron Systems)\ndate: 2023-06-20\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\appverifUI.dll'\n    filter_main_legit_path:\n        Image:\n            - 'C:\\Windows\\SysWOW64\\appverif.exe'\n            - 'C:\\Windows\\System32\\appverif.exe'\n        ImageLoaded|startswith:\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\SysWOW64\\'\n            - 'C:\\Windows\\WinSxS\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_side_load_antivirus.yml","content":"title: Potential Antivirus Software DLL Sideloading\nid: 552b6b65-df37-4d3e-a258-f2fc4771ae54\nstatus: test\ndescription: Detects potential DLL sideloading of DLLs that are part of antivirus software suchas McAfee, Symantec...etc\nreferences:\n    - https://hijacklibs.net/ # For list of DLLs that could be sideloaded (search for dlls mentioned here in there)\nauthor: Nasreddine Bencherchali (Nextron Systems), Wietze Beukema (project and research)\ndate: 2022-08-17\nmodified: 2025-10-07\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    # Bitdefender\n    selection_bitdefender:\n        ImageLoaded|endswith: '\\log.dll'\n    filter_log_dll_bitdefender:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files\\Bitdefender Antivirus Free\\'\n            - 'C:\\Program Files (x86)\\Bitdefender Antivirus Free\\'\n    filter_log_dll_dell_sar:\n        Image: 'C:\\Program Files\\Dell\\SARemediation\\audit\\TelemetryUtility.exe'\n        ImageLoaded:\n            - 'C:\\Program Files\\Dell\\SARemediation\\plugin\\log.dll'\n            - 'C:\\Program Files\\Dell\\SARemediation\\audit\\log.dll'\n    filter_log_dll_canon:\n        ImageLoaded|startswith: 'C:\\Program Files\\Canon\\MyPrinter\\'\n    filter_log_dll_avast:\n        ImageLoaded:\n            - 'C:\\Program Files\\AVAST Software\\Avast\\log.dll'\n            - 'C:\\Program Files (x86)\\AVAST Software\\Avast\\log.dll'\n    filter_log_dll_avg:\n        ImageLoaded:\n            - 'C:\\Program Files\\AVG\\Antivirus\\log.dll'\n            - 'C:\\Program Files (x86)\\AVG\\Antivirus\\log.dll'\n    # F-Secure\n    selection_fsecure:\n        ImageLoaded|endswith: '\\qrt.dll'\n    filter_fsecure:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files\\F-Secure\\Anti-Virus\\'\n            - 'C:\\Program Files (x86)\\F-Secure\\Anti-Virus\\'\n    # McAfee\n    selection_mcafee:\n        ImageLoaded|endswith:\n            - '\\ashldres.dll'\n            - '\\lockdown.dll'\n            - '\\vsodscpl.dll'\n    filter_mcafee:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files\\McAfee\\'\n            - 'C:\\Program Files (x86)\\McAfee\\'\n    # CyberArk\n    selection_cyberark:\n        ImageLoaded|endswith: '\\vftrace.dll'\n    filter_cyberark:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files\\CyberArk\\Endpoint Privilege Manager\\Agent\\x32\\'\n            - 'C:\\Program Files (x86)\\CyberArk\\Endpoint Privilege Manager\\Agent\\x32\\'\n    # Avast\n    selection_avast:\n        ImageLoaded|endswith: '\\wsc.dll'\n    filter_wsc_dll_avast:\n        ImageLoaded|startswith:\n            - 'C:\\program Files\\AVAST Software\\Avast\\'\n            - 'C:\\program Files (x86)\\AVAST Software\\Avast\\'\n    filter_wsc_dll_avg:\n        ImageLoaded|startswith:\n            - 'C:\\Program Files\\AVG\\Antivirus\\'\n            - 'C:\\Program Files (x86)\\AVG\\Antivirus\\'\n    # ESET\n    selection_eset_deslock:\n        ImageLoaded|endswith: '\\DLPPREM32.dll'\n    filter_eset_deslock:\n        ImageLoaded|startswith:\n            - 'C:\\program Files\\ESET'\n            - 'C:\\program Files (x86)\\ESET'\n    # Trend Micro Titanium\n    selection_titanium:\n        ImageLoaded|endswith: '\\tmdbglog.dll'\n    filter_titanium:\n        ImageLoaded|startswith:\n            - 'C:\\program Files\\Trend Micro\\Titanium\\'\n            - 'C:\\program Files (x86)\\Trend Micro\\Titanium\\'\n    condition: (selection_bitdefender and not 1 of filter_log_dll_*)\n               or (selection_fsecure and not filter_fsecure)\n               or (selection_mcafee and not filter_mcafee)\n               or (selection_cyberark and not filter_cyberark)\n               or (selection_avast and not 1 of filter_wsc_dll_*)\n               or (selection_titanium and not filter_titanium)\n               or (selection_eset_deslock and not filter_eset_deslock)\nfalsepositives:\n    - Applications that load the same dlls mentioned in the detection section. Investigate them and filter them out if a lot FPs are caused.\n    - Dell SARemediation plugin folder (C:\\Program Files\\Dell\\SARemediation\\plugin\\log.dll) is known to contain the 'log.dll' file.\n    - The Canon MyPrinter folder 'C:\\Program Files\\Canon\\MyPrinter\\' is known to contain the 'log.dll' file\nlevel: medium\n"},{"path":"image_load\\image_load_side_load_abused_dlls_susp_paths.yml","content":"title: Abusable DLL Potential Sideloading From Suspicious Location\nid: 799a5f48-0ac1-4e0f-9152-71d137d48c2a\nstatus: test\ndescription: Detects potential DLL sideloading of DLLs that are known to be abused from suspicious locations\nreferences:\n    - https://www.trendmicro.com/en_us/research/23/f/behind-the-scenes-unveiling-the-hidden-workings-of-earth-preta.html\n    - https://research.checkpoint.com/2023/beyond-the-horizon-traveling-the-world-on-camaro-dragons-usb-flash-drives/\nauthor: X__Junior (Nextron Systems)\ndate: 2023-07-11\ntags:\n    - attack.execution\n    - attack.t1059\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection_dll:\n        ImageLoaded|endswith:\n            # Note: Add more generic DLLs that cannot be pin-pointed to a single application\n            - '\\coreclr.dll'\n            - '\\facesdk.dll'\n            - '\\HPCustPartUI.dll'\n            - '\\libcef.dll'\n            - '\\ZIPDLL.dll'\n    selection_folders_1:\n        ImageLoaded|contains:\n            - ':\\Perflogs\\'\n            - ':\\Users\\Public\\'\n            - '\\Temporary Internet'\n            - '\\Windows\\Temp\\'\n    selection_folders_2:\n        - ImageLoaded|contains|all:\n              - ':\\Users\\'\n              - '\\Favorites\\'\n        - ImageLoaded|contains|all:\n              - ':\\Users\\'\n              - '\\Favourites\\'\n        - ImageLoaded|contains|all:\n              - ':\\Users\\'\n              - '\\Contacts\\'\n        - ImageLoaded|contains|all:\n              - ':\\Users\\'\n              - '\\Pictures\\'\n    condition: selection_dll and 1 of selection_folders_*\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_side_load_7za.yml","content":"title: Potential 7za.DLL Sideloading\nid: 4f6edb78-5c21-42ab-a558-fd2a6fc1fd57\nstatus: test\ndescription: Detects potential DLL sideloading of \"7za.dll\"\nreferences:\n    - https://www.gov.pl/attachment/ee91f24d-3e67-436d-aa50-7fa56acf789d\nauthor: X__Junior\ndate: 2023-06-09\ntags:\n    - attack.defense-evasion\n    - attack.persistence\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\7za.dll'\n    filter_main_legit_path:\n        Image|startswith:\n            - 'C:\\Program Files (x86)\\'\n            - 'C:\\Program Files\\'\n        ImageLoaded|startswith:\n            - 'C:\\Program Files (x86)\\'\n            - 'C:\\Program Files\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Legitimate third party application located in \"AppData\" may leverage this DLL to offer 7z compression functionality and may generate false positives. Apply additional filters as needed.\nlevel: low\n"},{"path":"image_load\\image_load_scrcons_wmi_scripteventconsumer.yml","content":"title: WMI ActiveScriptEventConsumers Activity Via Scrcons.EXE DLL Load\nid: b439f47d-ef52-4b29-9a2f-57d8a96cb6b8\nstatus: test\ndescription: Detects signs of the WMI script host process \"scrcons.exe\" loading scripting DLLs which could indicates WMI ActiveScriptEventConsumers EventConsumers activity.\nreferences:\n    - https://twitter.com/HunterPlaybook/status/1301207718355759107\n    - https://www.mdsec.co.uk/2020/09/i-like-to-move-it-windows-lateral-movement-part-1-wmi-event-subscription/\n    - https://threathunterplaybook.com/hunts/windows/200902-RemoteWMIActiveScriptEventConsumers/notebook.html\nauthor: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020-09-02\nmodified: 2023-02-22\ntags:\n    - attack.lateral-movement\n    - attack.privilege-escalation\n    - attack.persistence\n    - attack.t1546.003\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\scrcons.exe'\n        ImageLoaded|endswith:\n            - '\\vbscript.dll'\n            - '\\wbemdisp.dll'\n            - '\\wshom.ocx'\n            - '\\scrrun.dll'\n    condition: selection\nfalsepositives:\n    - Legitimate event consumers\n    - Dell computers on some versions register an event consumer that is known to cause false positives when brightness is changed by the corresponding keyboard button\nlevel: medium\n"},{"path":"image_load\\image_load_rundll32_remote_share_load.yml","content":"title: Remote DLL Load Via Rundll32.EXE\nid: f40017b3-cb2e-4335-ab5d-3babf679c1de\nstatus: test\ndescription: Detects a remote DLL load event via \"rundll32.exe\".\nreferences:\n    - https://github.com/gabe-k/themebleed\n    - Internal Research\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-09-18\ntags:\n    - attack.execution\n    - attack.t1204.002\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\rundll32.exe'\n        ImageLoaded|startswith: '\\\\\\\\'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_office_vbadll_load.yml","content":"title: VBA DLL Loaded Via Office Application\nid: e6ce8457-68b1-485b-9bdd-3c2b5d679aa9\nstatus: test\ndescription: Detects VB DLL's loaded by an office application. Which could indicate the presence of VBA Macros.\nreferences:\n    - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nauthor: Antonlovesdnb\ndate: 2020-02-19\nmodified: 2023-02-10\ntags:\n    - attack.execution\n    - attack.t1204.002\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\excel.exe'\n            - '\\mspub.exe'\n            - '\\onenote.exe'\n            - '\\onenoteim.exe' # Just in case\n            - '\\outlook.exe'\n            - '\\powerpnt.exe'\n            - '\\winword.exe'\n        ImageLoaded|endswith:\n            - '\\VBE7.DLL'\n            - '\\VBEUI.DLL'\n            - '\\VBE7INTL.DLL'\n    condition: selection\nfalsepositives:\n    - Legitimate macro usage. Add the appropriate filter according to your environment\nlevel: high\n"},{"path":"image_load\\image_load_office_powershell_dll_load.yml","content":"title: PowerShell Core DLL Loaded Via Office Application\nid: bb2ba6fb-95d4-4a25-89fc-30bb736c021a\nstatus: test\ndescription: Detects PowerShell core DLL being loaded by an Office Product\nreferences:\n    - Internal Research\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-06-01\ntags:\n    - attack.defense-evasion\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\excel.exe'\n            - '\\mspub.exe'\n            - '\\outlook.exe'\n            - '\\onenote.exe'\n            - '\\onenoteim.exe' # Just in case\n            - '\\powerpnt.exe'\n            - '\\winword.exe'\n        ImageLoaded|contains:\n            - '\\System.Management.Automation.Dll'\n            - '\\System.Management.Automation.ni.Dll'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_office_outlook_outlvba_load.yml","content":"title: Microsoft VBA For Outlook Addin Loaded Via Outlook\nid: 9a0b8719-cd3c-4f0a-90de-765a4cb3f5ed\nstatus: test\ndescription: Detects outlvba (Microsoft VBA for Outlook Addin) DLL being loaded by the outlook process\nreferences:\n    - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=58\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-02-08\nmodified: 2024-03-12\ntags:\n    - attack.execution\n    - attack.t1204.002\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\outlook.exe'\n        ImageLoaded|endswith: '\\outlvba.dll'\n    condition: selection\nfalsepositives:\n    - Legitimate macro usage. Add the appropriate filter according to your environment\nlevel: medium\n"},{"path":"image_load\\image_load_office_excel_xll_susp_load.yml","content":"title: Microsoft Excel Add-In Loaded From Uncommon Location\nid: af4c4609-5755-42fe-8075-4effb49f5d44\nrelated:\n    - id: c5f4b5cb-4c25-4249-ba91-aa03626e3185\n      type: derived\nstatus: test\ndescription: Detects Microsoft Excel loading an Add-In (.xll) file from an uncommon location\nreferences:\n    - https://www.mandiant.com/resources/blog/lnk-between-browsers\n    - https://wazuh.com/blog/detecting-xll-files-used-for-dropping-fin7-jssloader-with-wazuh/\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-05-12\ntags:\n    - attack.execution\n    - attack.t1204.002\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\excel.exe'\n        ImageLoaded|contains:\n            # Note: Add or remove locations from this list based on your internal policy\n            - '\\Desktop\\'\n            - '\\Downloads\\'\n            - '\\Perflogs\\'\n            - '\\Temp\\'\n            - '\\Users\\Public\\'\n            - '\\Windows\\Tasks\\'\n        ImageLoaded|endswith: '.xll'\n    condition: selection\nfalsepositives:\n    - Some tuning might be required to allow or remove certain locations used by the rule if you consider them as safe locations\nlevel: medium\n"},{"path":"image_load\\image_load_office_dotnet_gac_dll_load.yml","content":"title: GAC DLL Loaded Via Office Applications\nid: 90217a70-13fc-48e4-b3db-0d836c5824ac\nstatus: test\ndescription: Detects any GAC DLL being loaded by an Office Product\nreferences:\n    - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nauthor: Antonlovesdnb\ndate: 2020-02-19\nmodified: 2023-02-10\ntags:\n    - attack.execution\n    - attack.t1204.002\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\excel.exe'\n            - '\\mspub.exe'\n            - '\\onenote.exe'\n            - '\\onenoteim.exe' # Just in case\n            - '\\outlook.exe'\n            - '\\powerpnt.exe'\n            - '\\winword.exe'\n        ImageLoaded|startswith: 'C:\\Windows\\Microsoft.NET\\assembly\\GAC_MSIL'\n    condition: selection\nfalsepositives:\n    - Legitimate macro usage. Add the appropriate filter according to your environment\nlevel: high\n"},{"path":"image_load\\image_load_office_dotnet_clr_dll_load.yml","content":"title: CLR DLL Loaded Via Office Applications\nid: d13c43f0-f66b-4279-8b2c-5912077c1780\nstatus: test\ndescription: Detects CLR DLL being loaded by an Office Product\nreferences:\n    - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nauthor: Antonlovesdnb\ndate: 2020-02-19\nmodified: 2023-03-29\ntags:\n    - attack.execution\n    - attack.t1204.002\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\excel.exe'\n            - '\\mspub.exe'\n            - '\\outlook.exe'\n            - '\\onenote.exe'\n            - '\\onenoteim.exe' # Just in case\n            - '\\powerpnt.exe'\n            - '\\winword.exe'\n        ImageLoaded|contains: '\\clr.dll'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_office_dotnet_assembly_dll_load.yml","content":"title: DotNET Assembly DLL Loaded Via Office Application\nid: ff0f2b05-09db-4095-b96d-1b75ca24894a\nstatus: test\ndescription: Detects any assembly DLL being loaded by an Office Product\nreferences:\n    - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nauthor: Antonlovesdnb\ndate: 2020-02-19\nmodified: 2023-03-29\ntags:\n    - attack.execution\n    - attack.t1204.002\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\excel.exe'\n            - '\\mspub.exe'\n            - '\\onenote.exe'\n            - '\\onenoteim.exe' # Just in case\n            - '\\outlook.exe'\n            - '\\powerpnt.exe'\n            - '\\winword.exe'\n        ImageLoaded|startswith: 'C:\\Windows\\assembly\\'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_lsass_unsigned_image_load.yml","content":"title: Unsigned Image Loaded Into LSASS Process\nid: 857c8db3-c89b-42fb-882b-f681c7cf4da2\nstatus: test\ndescription: Loading unsigned image (DLL, EXE) into LSASS process\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\nauthor: Teymur Kheirkhabarov, oscd.community\ndate: 2019-10-22\nmodified: 2021-11-27\ntags:\n    - attack.credential-access\n    - attack.t1003.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\lsass.exe'\n        Signed: 'false'\n    condition: selection\nfalsepositives:\n    - Valid user connecting using RDP\nlevel: medium\n"},{"path":"image_load\\image_load_iexplore_dcom_iertutil_dll_hijack.yml","content":"title: Potential DCOM InternetExplorer.Application DLL Hijack - Image Load\nid: f354eba5-623b-450f-b073-0b5b2773b6aa\nrelated:\n    - id: e554f142-5cf3-4e55-ace9-a1b59e0def65\n      type: obsolete\n    - id: 2f7979ae-f82b-45af-ac1d-2b10e93b0baa\n      type: similar\nstatus: test\ndescription: Detects potential DLL hijack of \"iertutil.dll\" found in the DCOM InternetExplorer.Application Class\nreferences:\n    - https://threathunterplaybook.com/hunts/windows/201009-RemoteDCOMIErtUtilDLLHijack/notebook.html\nauthor: Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR), wagga\ndate: 2020-10-12\nmodified: 2022-12-18\ntags:\n    - attack.lateral-movement\n    - attack.t1021.002\n    - attack.t1021.003\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        Image|endswith: '\\Internet Explorer\\iexplore.exe'\n        ImageLoaded|endswith: '\\Internet Explorer\\iertutil.dll'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n"},{"path":"image_load\\image_load_hktl_silenttrinity_stager.yml","content":"title: HackTool - SILENTTRINITY Stager DLL Load\nid: 75c505b1-711d-4f68-a357-8c3fe37dbf2d\nrelated:\n    - id: 03552375-cc2c-4883-bbe4-7958d5a980be # Process Creation\n      type: derived\nstatus: test\ndescription: Detects SILENTTRINITY stager dll loading activity\nreferences:\n    - https://github.com/byt3bl33d3r/SILENTTRINITY\nauthor: Aleksey Potapov, oscd.community\ndate: 2019-10-22\nmodified: 2023-02-17\ntags:\n    - attack.command-and-control\n    - attack.t1071\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Description|contains: 'st2stager'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_hktl_sharpevtmute.yml","content":"title: HackTool - SharpEvtMute DLL Load\nid: 49329257-089d-46e6-af37-4afce4290685\nrelated:\n    - id: bedfc8ad-d1c7-4e37-a20e-e2b0dbee759c # Process Creation\n      type: similar\nstatus: test\ndescription: Detects the load of EvtMuteHook.dll, a key component of SharpEvtHook, a tool that tampers with the Windows event logs\nreferences:\n    - https://github.com/bats3c/EvtMute\nauthor: Florian Roth (Nextron Systems)\ndate: 2022-09-07\nmodified: 2024-11-23\ntags:\n    - attack.defense-evasion\n    - attack.t1562.002\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Hashes|contains: 'IMPHASH=330768A4F172E10ACB6287B87289D83B'\n    condition: selection\nfalsepositives:\n    - Other DLLs with the same Imphash\nlevel: high\n"},{"path":"image_load\\image_load_dll_vss_ps_susp_load.yml","content":"title: Suspicious Volume Shadow Copy VSS_PS.dll Load\nid: 333cdbe8-27bb-4246-bf82-b41a0dca4b70\nrelated:\n    - id: 48bfd177-7cf2-412b-ad77-baf923489e82 # vsstrace.dll\n      type: similar\n    - id: 37774c23-25a1-4adb-bb6d-8bb9fd59c0f8 # vssapi.dll\n      type: similar\nstatus: test\ndescription: |\n    Detects the image load of vss_ps.dll by uncommon executables. This DLL is used by the Volume Shadow Copy Service (VSS) to manage shadow copies of files and volumes.\n    It is often abused by attackers to delete or manipulate shadow copies, which can hinder forensic investigations and data recovery efforts.\n    The fact that it is loaded by processes that are not typically associated with VSS operations can indicate suspicious activity.\nreferences:\n    - https://www.virustotal.com/gui/file/ba88ca45589fae0139a40ca27738a8fc2dfbe1be5a64a9558f4e0f52b35c5add\n    - https://twitter.com/am0nsec/status/1412232114980982787\nauthor: Markus Neis, @markus_neis\ndate: 2021-07-07\nmodified: 2025-07-11\ntags:\n    - attack.defense-evasion\n    - attack.impact\n    - attack.t1490\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\vss_ps.dll'\n    filter_main_legit:\n        Image|startswith: 'C:\\Windows\\'\n        Image|endswith:\n            - '\\clussvc.exe'\n            - '\\dismhost.exe'\n            - '\\dllhost.exe'\n            - '\\inetsrv\\appcmd.exe'\n            - '\\inetsrv\\iissetup.exe'\n            - '\\msiexec.exe'\n            - '\\rundll32.exe'\n            - '\\searchindexer.exe'\n            - '\\srtasks.exe'\n            - '\\svchost.exe'\n            - '\\System32\\SystemPropertiesAdvanced.exe'\n            - '\\taskhostw.exe'\n            - '\\thor.exe'\n            - '\\thor64.exe'\n            - '\\tiworker.exe'\n            - '\\vssvc.exe'\n            - '\\vssadmin.exe'\n            - '\\WmiPrvSE.exe'\n            - '\\wsmprovhost.exe'\n    filter_main_update:\n        CommandLine|startswith: 'C:\\$WinREAgent\\Scratch\\'\n        CommandLine|contains: '\\dismhost.exe {'\n    filter_main_image_null:\n        Image: null\n    filter_optional_programfiles:\n        # When using this rule in your environment replace the \"Program Files\" folder by the exact applications you know use this. Examples would be software such as backup solutions\n        Image|startswith:\n            - 'C:\\Program Files\\'\n            - 'C:\\Program Files (x86)\\'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_dll_vsstrace_susp_load.yml","content":"title: Potentially Suspicious Volume Shadow Copy Vsstrace.dll Load\nid: 48bfd177-7cf2-412b-ad77-baf923489e82\nrelated:\n    - id: 333cdbe8-27bb-4246-bf82-b41a0dca4b70 # vss_ps.dll\n      type: similar\n    - id: 37774c23-25a1-4adb-bb6d-8bb9fd59c0f8 # vssapi.dll\n      type: similar\nstatus: test\ndescription: Detects the image load of VSS DLL by uncommon executables\nreferences:\n    - https://github.com/ORCx41/DeleteShadowCopies\nauthor: frack113\ndate: 2023-02-17\nmodified: 2025-10-17\ntags:\n    - attack.defense-evasion\n    - attack.impact\n    - attack.t1490\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\vsstrace.dll'\n    filter_main_windows:\n        - Image:\n              - 'C:\\Windows\\explorer.exe'\n              - 'C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe'\n        - Image|startswith:\n              - 'C:\\Windows\\System32\\'\n              - 'C:\\Windows\\SysWOW64\\'\n              - 'C:\\Windows\\Temp\\{' # Installers\n              - 'C:\\Windows\\WinSxS\\'\n              - 'C:\\ProgramData\\Package Cache\\{'  # Microsoft Visual Redistributable installer  VC_redist/vcredist EXE\n    filter_main_null_image:\n        Image: null # Observed through Aurora\n    filter_main_program_files:\n        # When using this rule in your environment replace the \"Program Files\" folder by the exact applications you know use this. Examples would be software such as backup solutions\n        Image|startswith:\n            - 'C:\\Program Files\\'\n            - 'C:\\Program Files (x86)\\'\n    filter_optional_avira:\n        Image|contains|all:\n            - '\\temp\\is-'\n            - '\\avira_system_speedup.tmp'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_dll_vssapi_susp_load.yml","content":"title: Suspicious Volume Shadow Copy Vssapi.dll Load\nid: 37774c23-25a1-4adb-bb6d-8bb9fd59c0f8\nrelated:\n    - id: 333cdbe8-27bb-4246-bf82-b41a0dca4b70 # vss_ps.dll\n      type: similar\n    - id: 48bfd177-7cf2-412b-ad77-baf923489e82 # vsstrace.dll\n      type: similar\nstatus: test\ndescription: Detects the image load of VSS DLL by uncommon executables\nreferences:\n    - https://github.com/ORCx41/DeleteShadowCopies\nauthor: frack113\ndate: 2022-10-31\nmodified: 2025-10-17\ntags:\n    - attack.defense-evasion\n    - attack.impact\n    - attack.t1490\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\vssapi.dll'\n    filter_main_windows:\n        - Image:\n              - 'C:\\Windows\\explorer.exe'\n              - 'C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe'\n        - Image|startswith:\n              - 'C:\\Windows\\System32\\'\n              - 'C:\\Windows\\SysWOW64\\'\n              - 'C:\\Windows\\Temp\\{' # Installers\n              - 'C:\\Windows\\WinSxS\\'\n    filter_main_program_files:\n        # When using this rule in your environment replace the \"Program Files\" folder by the exact applications you know use this. Examples would be software such as backup solutions\n        Image|startswith:\n            - 'C:\\Program Files\\'\n            - 'C:\\Program Files (x86)\\'\n    filter_main_null_image:\n        Image: null\n    filter_optional_programdata_packagecache:\n        # The following filter is required because of many FPs cause by:\n        #   C:\\ProgramData\\Package Cache\\{10c6cfdc-27af-43fe-bbd3-bd20aae88451}\\dotnet-sdk-3.1.425-win-x64.exe\n        #   C:\\ProgramData\\Package Cache\\{b9cfa33e-ace4-49f4-8bb4-82ded940990a}\\windowsdesktop-runtime-6.0.11-win-x86.exe\n        #   C:\\ProgramData\\Package Cache\\{50264ff2-ad47-4569-abc4-1c350f285fb9}\\aspnetcore-runtime-6.0.11-win-x86.exe\n        #   C:\\ProgramData\\Package Cache\\{2dcef8c3-1563-4149-a6ec-5b6c98500d7d}\\dotnet-sdk-6.0.306-win-x64.exe\n        #   etc.\n        Image|startswith: 'C:\\ProgramData\\Package Cache\\'\n    filter_optional_avira:\n        Image|contains|all:\n            - '\\temp\\is-'\n            - '\\avira_system_speedup.tmp'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_dll_tttracer_module_load.yml","content":"title: Time Travel Debugging Utility Usage - Image\nid: e76c8240-d68f-4773-8880-5c6f63595aaf\nstatus: test\ndescription: Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.\nreferences:\n    - https://lolbas-project.github.io/lolbas/Binaries/Tttracer/\n    - https://twitter.com/mattifestation/status/1196390321783025666\n    - https://twitter.com/oulusoyum/status/1191329746069655553\nauthor: 'Ensar amil, @sblmsrsn, @oscd_initiative'\ndate: 2020-10-06\nmodified: 2022-12-02\ntags:\n    - attack.defense-evasion\n    - attack.credential-access\n    - attack.t1218\n    - attack.t1003.001\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        ImageLoaded|endswith:\n            - '\\ttdrecord.dll'\n            - '\\ttdwriter.dll'\n            - '\\ttdloader.dll'\n    condition: selection\nfalsepositives:\n    - Legitimate usage by software developers/testers\nlevel: high\n"},{"path":"image_load\\image_load_dll_system_management_automation_susp_load.yml","content":"title: PowerShell Core DLL Loaded By Non PowerShell Process\nid: 092bc4b9-3d1d-43b4-a6b4-8c8acd83522f\nrelated:\n    - id: 867613fb-fa60-4497-a017-a82df74a172c\n      type: obsolete\n    - id: fe6e002f-f244-4278-9263-20e4b593827f\n      type: obsolete\nstatus: test\ndescription: |\n    Detects loading of essential DLLs used by PowerShell by non-PowerShell process.\n    Detects behavior similar to meterpreter's \"load powershell\" extension.\nreferences:\n    - https://adsecurity.org/?p=2921\n    - https://github.com/p3nt4/PowerShdll\nauthor: Tom Kern, oscd.community, Natalia Shornikova, Tim Shelton, Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2019-11-14\nmodified: 2025-10-07\ntags:\n    - attack.t1059.001\n    - attack.execution\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        - Description: 'System.Management.Automation'\n        - OriginalFileName: 'System.Management.Automation.dll'\n        - ImageLoaded|endswith:\n              - '\\System.Management.Automation.dll'\n              - '\\System.Management.Automation.ni.dll'\n    filter_main_powershell:\n        Image:\n            - 'C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe' # PowerShell 7 preview\n            - 'C:\\Program Files\\PowerShell\\7\\pwsh.exe' # PowerShell 7\n            - 'C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe'\n            - 'C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe'\n            - 'C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell_ise.exe'\n            - 'C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe'\n    filter_main_pwsh_preview:\n        Image|contains:\n            - 'C:\\Program Files\\WindowsApps\\Microsoft.PowerShellPreview'\n            - '\\AppData\\Local\\Microsoft\\WindowsApps\\Microsoft.PowerShellPreview'\n        Image|endswith: '\\pwsh.exe'\n    filter_main_generic:\n        Image:\n            - 'C:\\Windows\\System32\\dsac.exe'\n            - 'C:\\WINDOWS\\System32\\RemoteFXvGPUDisablement.exe'\n            - 'C:\\Windows\\System32\\runscripthelper.exe'\n            - 'C:\\WINDOWS\\System32\\sdiagnhost.exe'\n            - 'C:\\Windows\\System32\\ServerManager.exe'\n            - 'C:\\Windows\\System32\\SyncAppvPublishingServer.exe'\n            - 'C:\\Windows\\System32\\winrshost.exe'\n            - 'C:\\Windows\\System32\\wsmprovhost.exe'\n            - 'C:\\Windows\\SysWOW64\\winrshost.exe'\n            - 'C:\\Windows\\SysWOW64\\wsmprovhost.exe'\n    filter_main_dotnet:\n        Image|startswith:\n            - 'C:\\Windows\\Microsoft.NET\\Framework\\'\n            - 'C:\\Windows\\Microsoft.NET\\FrameworkArm\\'\n            - 'C:\\Windows\\Microsoft.NET\\FrameworkArm64\\'\n            - 'C:\\Windows\\Microsoft.NET\\Framework64\\'\n        Image|endswith: '\\mscorsvw.exe'\n    filter_optional_sql_server_mgmt:\n        Image|startswith:\n            - 'C:\\Program Files (x86)\\Microsoft SQL Server Management Studio'\n            - 'C:\\Program Files\\Microsoft SQL Server Management Studio'\n        Image|endswith: '\\IDE\\Ssms.exe'\n    filter_optional_sql_server_tools:\n        Image|startswith:\n            - 'C:\\Program Files (x86)\\Microsoft SQL Server\\'\n            - 'C:\\Program Files\\Microsoft SQL Server\\'\n        Image|endswith: '\\Tools\\Binn\\SQLPS.exe'\n    filter_optional_citrix:\n        Image|endswith: '\\Citrix\\ConfigSync\\ConfigSyncRun.exe'\n    filter_optional_vs:\n        Image|startswith:\n            - 'C:\\Program Files (x86)\\Microsoft Visual Studio\\'\n            - 'C:\\Program Files\\Microsoft Visual Studio\\'\n    filter_optional_chocolatey:\n        Image|startswith: 'C:\\ProgramData\\chocolatey\\choco.exe'\n    filter_optional_nextron:\n        Image|startswith: 'C:\\Windows\\Temp\\asgard2-agent\\'\n        Image|endswith:\n            - '\\thor64.exe'\n            - '\\thor.exe'\n        # User: 'NT AUTHORITY\\SYSTEM'   # if set, matches all powershell processes not launched by SYSTEM\n    filter_optional_aurora:\n        # This filter is to avoid a race condition FP with this specific ETW provider in aurora\n        Image: null\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Used by some .NET binaries, minimal on user workstation.\n    - Used by Microsoft SQL Server Management Studio\nlevel: medium\n"},{"path":"image_load\\image_load_dll_sdiageng_load_by_msdt.yml","content":"title: Diagnostic Library Sdiageng.DLL Loaded By Msdt.EXE\nid: ec8c4047-fad9-416a-8c81-0f479353d7f6\nstatus: test\ndescription: Detects both of CVE-2022-30190 (Follina) and DogWalk vulnerabilities exploiting msdt.exe binary to load the \"sdiageng.dll\" library\nreferences:\n    - https://www.securonix.com/blog/detecting-microsoft-msdt-dogwalk/\nauthor: Greg (rule)\ndate: 2022-06-17\nmodified: 2023-02-17\ntags:\n    - attack.defense-evasion\n    - attack.t1202\n    - cve.2022-30190\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\msdt.exe'\n        ImageLoaded|endswith: '\\sdiageng.dll'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_dll_rstrtmgr_uncommon_load.yml","content":"title: Load Of RstrtMgr.DLL By An Uncommon Process\nid: 3669afd2-9891-4534-a626-e5cf03810a61\nrelated:\n    - id: b48492dc-c5ef-4572-8dff-32bc241c15c8\n      type: derived\nstatus: test\ndescription: |\n    Detects the load of RstrtMgr DLL (Restart Manager) by an uncommon process.\n    This library has been used during ransomware campaigns to kill processes that would prevent file encryption by locking them (e.g. Conti ransomware, Cactus ransomware). It has also recently been seen used by the BiBi wiper for Windows.\n    It could also be used for anti-analysis purposes by shut downing specific processes.\nreferences:\n    - https://www.crowdstrike.com/blog/windows-restart-manager-part-1/\n    - https://www.crowdstrike.com/blog/windows-restart-manager-part-2/\n    - https://web.archive.org/web/20231221193106/https://www.swascan.com/cactus-ransomware-malware-analysis/\n    - https://taiwan.postsen.com/business/88601/Hamas-hackers-use-data-destruction-software-BiBi-which-consumes-a-lot-of-processor-resources-to-wipe-Windows-computer-data--iThome.html\nauthor: Luc Gnaux\ndate: 2023-11-28\ntags:\n    - attack.impact\n    - attack.defense-evasion\n    - attack.t1486\n    - attack.t1562.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        - ImageLoaded|endswith: '\\RstrtMgr.dll'\n        - OriginalFileName: 'RstrtMgr.dll'\n    filter_main_generic:\n        Image|contains:\n            - ':\\$WINDOWS.~BT\\'\n            - ':\\$WinREAgent\\'\n            - ':\\Program Files (x86)\\'\n            - ':\\Program Files\\'\n            - ':\\ProgramData\\'\n            - ':\\Windows\\explorer.exe'\n            - ':\\Windows\\SoftwareDistribution\\'\n            - ':\\Windows\\SysNative\\'\n            - ':\\Windows\\System32\\'\n            - ':\\Windows\\SysWOW64\\'\n            - ':\\Windows\\WinSxS\\'\n            - ':\\WUDownloadCache\\'\n    filter_main_user_software_installations:\n        Image|contains|all:\n            - ':\\Users\\'\n            - '\\AppData\\Local\\Temp\\is-'\n            - '.tmp\\'\n        Image|endswith: '.tmp'\n    filter_main_admin_software_installations:\n        Image|contains: ':\\Windows\\Temp\\'\n    condition: selection and not 1 of filter_main_*\nfalsepositives:\n    - Other legitimate Windows processes not currently listed\n    - Processes related to software installation\nlevel: low\n"},{"path":"image_load\\image_load_dll_rstrtmgr_suspicious_load.yml","content":"title: Load Of RstrtMgr.DLL By A Suspicious Process\nid: b48492dc-c5ef-4572-8dff-32bc241c15c8\nrelated:\n    - id: 3669afd2-9891-4534-a626-e5cf03810a61\n      type: derived\nstatus: test\ndescription: |\n    Detects the load of RstrtMgr DLL (Restart Manager) by a suspicious process.\n    This library has been used during ransomware campaigns to kill processes that would prevent file encryption by locking them (e.g. Conti ransomware, Cactus ransomware). It has also recently been seen used by the BiBi wiper for Windows.\n    It could also be used for anti-analysis purposes by shut downing specific processes.\nreferences:\n    - https://www.crowdstrike.com/blog/windows-restart-manager-part-1/\n    - https://www.crowdstrike.com/blog/windows-restart-manager-part-2/\n    - https://web.archive.org/web/20231221193106/https://www.swascan.com/cactus-ransomware-malware-analysis/\n    - https://taiwan.postsen.com/business/88601/Hamas-hackers-use-data-destruction-software-BiBi-which-consumes-a-lot-of-processor-resources-to-wipe-Windows-computer-data--iThome.html\nauthor: Luc Gnaux\ndate: 2023-11-28\ntags:\n    - attack.impact\n    - attack.defense-evasion\n    - attack.t1486\n    - attack.t1562.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection_img:\n        - ImageLoaded|endswith: '\\RstrtMgr.dll'\n        - OriginalFileName: 'RstrtMgr.dll'\n    selection_folders_1:\n        Image|contains:\n            # Note: increase coverage by adding more suspicious paths\n            - ':\\Perflogs\\'\n            - ':\\Users\\Public\\'\n            - '\\Temporary Internet'\n    selection_folders_2:\n        - Image|contains|all:\n              - ':\\Users\\'\n              - '\\Favorites\\'\n        - Image|contains|all:\n              - ':\\Users\\'\n              - '\\Favourites\\'\n        - Image|contains|all:\n              - ':\\Users\\'\n              - '\\Contacts\\'\n    condition: selection_img and 1 of selection_folders_*\nfalsepositives:\n    - Processes related to software installation\nlevel: high\n"},{"path":"image_load\\image_load_dll_pcre_dotnet_dll_load.yml","content":"title: PCRE.NET Package Image Load\nid: 84b0a8f3-680b-4096-a45b-e9a89221727c\nstatus: test\ndescription: Detects processes loading modules related to PCRE.NET package\nreferences:\n    - https://twitter.com/rbmaslen/status/1321859647091970051\n    - https://twitter.com/tifkin_/status/1321916444557365248\nauthor: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020-10-29\nmodified: 2022-10-09\ntags:\n    - attack.execution\n    - attack.t1059\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|contains: \\AppData\\Local\\Temp\\ba9ea7344a4a5f591d6e5dc32a13494b\\\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_dll_dbghelp_dbgcore_unsigned_load.yml","content":"title: Suspicious Unsigned Dbghelp/Dbgcore DLL Loaded\nid: bdc64095-d59a-42a2-8588-71fd9c9d9abc\nrelated:\n    - id: 0e277796-5f23-4e49-a490-483131d4f6e1 # Suspicious Loading\n      type: similar\nstatus: test\ndescription: |\n    Detects the load of dbghelp/dbgcore DLL (used to make memory dumps) by suspicious processes.\n    Tools like ProcessHacker and some attacker tradecract use MiniDumpWriteDump API found in dbghelp.dll or dbgcore.dll.\n    As an example, SilentTrynity C2 Framework has a module that leverages this API to dump the contents of Lsass.exe and transfer it over the network back to the attacker's machine.\nreferences:\n    - https://learn.microsoft.com/en-us/windows/win32/api/minidumpapiset/nf-minidumpapiset-minidumpwritedump\n    - https://www.pinvoke.net/default.aspx/dbghelp/MiniDumpWriteDump.html\n    - https://medium.com/@fsx30/bypass-edrs-memory-protection-introduction-to-hooking-2efb21acffd6\nauthor: Perez Diego (@darkquassar), oscd.community, Ecco\ndate: 2019-10-27\nmodified: 2022-12-09\ntags:\n    - attack.credential-access\n    - attack.t1003.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith:\n            - '\\dbghelp.dll'\n            - '\\dbgcore.dll'\n        Signed: 'false'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"image_load\\image_load_dll_credui_uncommon_process_load.yml","content":"title: CredUI.DLL Loaded By Uncommon Process\nid: 9ae01559-cf7e-4f8e-8e14-4c290a1b4784\nstatus: test\ndescription: Detects loading of \"credui.dll\" and related DLLs by an uncommon process. Attackers might leverage this DLL for potential use of \"CredUIPromptForCredentials\" or \"CredUnPackAuthenticationBufferW\".\nreferences:\n    - https://securitydatasets.com/notebooks/atomic/windows/credential_access/SDWIN-201020013208.html\n    - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.002/T1056.002.md#atomic-test-2---powershell---prompt-user-for-password\n    - https://learn.microsoft.com/en-us/windows/win32/api/wincred/nf-wincred-creduipromptforcredentialsa\n    - https://github.com/S12cybersecurity/RDPCredentialStealer\nauthor: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020-10-20\nmodified: 2023-07-28\ntags:\n    - attack.credential-access\n    - attack.collection\n    - attack.t1056.002\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        - ImageLoaded|endswith:\n              - '\\credui.dll'\n              - '\\wincredui.dll'\n        - OriginalFileName:\n              - 'credui.dll'\n              - 'wincredui.dll'\n    filter_main_generic:\n        Image|startswith:\n            - 'C:\\Program Files (x86)\\'\n            - 'C:\\Program Files\\'\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\SysWOW64\\'\n    filter_main_full:\n        Image:\n            - 'C:\\Windows\\explorer.exe'\n            - 'C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe'\n            - 'C:\\Windows\\regedit.exe' # This FP is triggered for example when choosing the \"Connect Network Registry\" from the menu\n    filter_optional_opera:\n        Image|endswith: '\\opera_autoupdate.exe'\n    filter_optional_process_explorer:\n        Image|endswith:\n            - '\\procexp64.exe'\n            - '\\procexp.exe'\n    filter_optional_teams:\n        Image|startswith: 'C:\\Users\\'\n        Image|contains: '\\AppData\\Local\\Microsoft\\Teams\\'\n        Image|endswith: '\\Teams.exe'\n    filter_optional_onedrive:\n        Image|startswith: 'C:\\Users\\'\n        Image|contains: '\\AppData\\Local\\Microsoft\\OneDrive\\'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Other legitimate processes loading those DLLs in your environment.\nlevel: medium\n"},{"path":"image_load\\image_load_dll_comsvcs_load_renamed_version_by_rundll32.yml","content":"title: Suspicious Renamed Comsvcs DLL Loaded By Rundll32\nid: 8cde342c-ba48-4b74-b615-172c330f2e93\nstatus: test\ndescription: Detects rundll32 loading a renamed comsvcs.dll to dump process memory\nreferences:\n    - https://twitter.com/sbousseaden/status/1555200155351228419\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-14\nmodified: 2023-02-17\ntags:\n    - attack.credential-access\n    - attack.defense-evasion\n    - attack.t1003.001\nlogsource:\n    product: windows\n    category: image_load\ndetection:\n    selection:\n        Image|endswith: '\\rundll32.exe'\n        Hashes|contains:\n            # Add more hashes for other windows versions\n            - IMPHASH=eed93054cb555f3de70eaa9787f32ebb # Windows 11 21H2 x64\n            - IMPHASH=5e0dbdec1fce52daae251a110b4f309d # Windows 10 1607\n            - IMPHASH=eadbccbb324829acb5f2bbe87e5549a8 # Windows 10 1809\n            - IMPHASH=407ca0f7b523319d758a40d7c0193699 # Windows 10 2004 x64\n            - IMPHASH=281d618f4e6271e527e6386ea6f748de # Windows 10 2004 x86\n    filter:\n        ImageLoaded|endswith: '\\comsvcs.dll'\n    condition: selection and not filter\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"image_load\\image_load_dll_azure_microsoft_account_token_provider_dll_load.yml","content":"title: Potential Azure Browser SSO Abuse\nid: 50f852e6-af22-4c78-9ede-42ef36aa3453\nstatus: test\ndescription: |\n    Detects abusing Azure Browser SSO by requesting OAuth 2.0 refresh tokens for an Azure-AD-authenticated Windows user (i.e. the machine is joined to Azure AD and a user logs in with their Azure AD account) wanting to perform SSO authentication in the browser.\n    An attacker can use this to authenticate to Azure AD in a browser as that user.\nreferences:\n    - https://posts.specterops.io/requesting-azure-ad-request-tokens-on-azure-ad-joined-machines-for-browser-sso-2b0409caad30\nauthor: Den Iuzvyk\ndate: 2020-07-15\nmodified: 2023-04-18\ntags:\n    - attack.persistence\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1574.001\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded: 'C:\\Windows\\System32\\MicrosoftAccountTokenProvider.dll'\n    filter_main_bgtaskhost:\n        Image|startswith:\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\SysWOW64\\'\n        Image|endswith: '\\BackgroundTaskHost.exe'\n        # CommandLine|contains: '-ServerNameBackgroundTaskHost.WebAccountProvider'\n    filter_optional_devenv:\n        Image|startswith:\n            - 'C:\\Program Files\\Microsoft Visual Studio\\'\n            - 'C:\\Program Files (x86)\\Microsoft Visual Studio\\'\n        Image|endswith: '\\IDE\\devenv.exe'\n    filter_optional_ie:\n        Image:\n            - 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe'\n            - 'C:\\Program Files\\Internet Explorer\\iexplore.exe'\n    filter_optional_edge_1:\n        - Image|startswith: 'C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\'\n        - Image|endswith: '\\WindowsApps\\MicrosoftEdge.exe'\n        - Image:\n              - 'C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe'\n              - 'C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe'\n    filter_optional_edge_2:\n        Image|startswith:\n            - 'C:\\Program Files (x86)\\Microsoft\\EdgeCore\\'\n            - 'C:\\Program Files\\Microsoft\\EdgeCore\\'\n        Image|endswith:\n            - '\\msedge.exe'\n            - '\\msedgewebview2.exe'\n    filter_optional_onedrive:\n        Image|endswith: '\\AppData\\Local\\Microsoft\\OneDrive\\OneDrive.exe'\n    filter_optional_null:\n        Image: null\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - False positives are expected since this rules is only looking for the DLL load event. This rule is better used in correlation with related activity\nlevel: low\n"},{"path":"image_load\\image_load_dll_amsi_suspicious_process.yml","content":"title: Amsi.DLL Loaded Via LOLBIN Process\nid: 6ec86d9e-912e-4726-91a2-209359b999b9\nstatus: test\ndescription: Detects loading of \"Amsi.dll\" by a living of the land process. This could be an indication of a \"PowerShell without PowerShell\" attack\nreferences:\n    - Internal Research\n    - https://www.paloaltonetworks.com/blog/security-operations/stopping-powershell-without-powershell/\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-06-01\nmodified: 2025-10-07\ntags:\n    - attack.defense-evasion\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        ImageLoaded|endswith: '\\amsi.dll'\n        Image|endswith:\n            # TODO: Add more interesting processes\n            - '\\ExtExport.exe'\n            - '\\odbcconf.exe'\n            # - '\\regsvr32.exe' # legitimately calls amsi.dll\n            - '\\rundll32.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"image_load\\image_load_cmstp_load_dll_from_susp_location.yml","content":"title: DLL Loaded From Suspicious Location Via Cmspt.EXE\nid: 75e508f7-932d-4ebc-af77-269237a84ce1\nstatus: test\ndescription: Detects cmstp loading \"dll\" or \"ocx\" files from suspicious locations\nreferences:\n    - https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/TTPs/Defense%20Evasion/T1218%20-%20Signed%20Binary%20Proxy%20Execution/T1218.003%20-%20CMSTP/Procedures.yaml\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-30\nmodified: 2023-02-17\ntags:\n    - attack.defense-evasion\n    - attack.t1218.003\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\cmstp.exe'\n        ImageLoaded|contains:\n            # Add more suspicious paths as you see fit in your env\n            - '\\PerfLogs\\'\n            - '\\ProgramData\\'\n            - '\\Users\\'\n            - '\\Windows\\Temp\\'\n            - 'C:\\Temp\\'\n        ImageLoaded|endswith:\n            - '.dll'\n            - '.ocx'\n    condition: selection\nfalsepositives:\n    - Unikely\nlevel: high\n"},{"path":"image_load\\image_load_clfs_load.yml","content":"title: Clfs.SYS Loaded By Process Located In a Potential Suspicious Location\nid: fb4e2211-6d08-426b-8e6f-0d4a161e3b1d\nstatus: experimental\ndescription: Detects Clfs.sys being loaded by a process running from a potentially suspicious location. Clfs.sys is loaded as part of many CVEs exploits that targets Common Log File.\nreferences:\n    - https://ssd-disclosure.com/ssd-advisory-common-log-file-system-clfs-driver-pe/\n    - https://x.com/Threatlabz/status/1879956781360976155\nauthor: X__Junior\ndate: 2025-01-20\ntags:\n    - attack.execution\n    - attack.t1059\nlogsource:\n    category: image_load\n    product: windows\ndetection:\n    selection_dll:\n        ImageLoaded|endswith: '\\clfs.sys'\n    selection_folders_1:\n        Image|contains:\n            - ':\\Perflogs\\'\n            - ':\\Users\\Public\\'\n            - '\\Temporary Internet'\n            - '\\Windows\\Temp\\'\n    selection_folders_2:\n        - Image|contains|all:\n              - ':\\Users\\'\n              - '\\Favorites\\'\n        - Image|contains|all:\n              - ':\\Users\\'\n              - '\\Favourites\\'\n        - Image|contains|all:\n              - ':\\Users\\'\n              - '\\Contacts\\'\n        - Image|contains|all:\n              - ':\\Users\\'\n              - '\\Pictures\\'\n    condition: selection_dll and 1 of selection_folders_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"}]