[{"path":"create_remote_thread\\create_remote_thread_win_ttdinjec.yml","content":"title: Remote Thread Creation Ttdinject.exe Proxy\nid: c15e99a3-c474-48ab-b9a7-84549a7a9d16\nstatus: test\ndescription: Detects a remote thread creation of Ttdinject.exe used as proxy\nreferences:\n    - https://lolbas-project.github.io/lolbas/Binaries/Ttdinject/\nauthor: frack113\ndate: 2022-05-16\nmodified: 2022-06-02\ntags:\n    - attack.defense-evasion\n    - attack.t1127\nlogsource:\n    product: windows\n    category: create_remote_thread\ndetection:\n    selection:\n        SourceImage|endswith: '\\ttdinject.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"create_remote_thread\\create_remote_thread_win_susp_uncommon_target_image.yml","content":"title: Remote Thread Creation In Uncommon Target Image\nid: a1a144b7-5c9b-4853-a559-2172be8d4a03\nrelated:\n    - id: f016c716-754a-467f-a39e-63c06f773987\n      type: obsolete\nstatus: test\ndescription: Detects uncommon target processes for remote thread creation\nreferences:\n    - https://web.archive.org/web/20220319032520/https://blog.redbluepurple.io/offensive-research/bypassing-injection-detection\nauthor: Florian Roth (Nextron Systems)\ndate: 2022-03-16\nmodified: 2025-07-04\ntags:\n    - attack.defense-evasion\n    - attack.privilege-escalation\n    - attack.t1055.003\nlogsource:\n    product: windows\n    category: create_remote_thread\ndetection:\n    selection:\n        TargetImage|endswith:\n            - '\\calc.exe'\n            - '\\calculator.exe'\n            - '\\mspaint.exe'\n            - '\\notepad.exe'\n            - '\\ping.exe'\n            - '\\sethc.exe'\n            - '\\spoolsv.exe'\n            - '\\wordpad.exe'\n            - '\\write.exe'\n    filter_main_csrss:\n        SourceImage: 'C:\\Windows\\System32\\csrss.exe'\n    filter_main_notepad:\n        SourceImage:\n            - 'C:\\Windows\\System32\\explorer.exe'\n            - 'C:\\Windows\\System32\\OpenWith.exe'\n        TargetImage: 'C:\\Windows\\System32\\notepad.exe'\n    filter_main_sethc:\n        SourceImage: 'C:\\Windows\\System32\\AtBroker.exe'\n        TargetImage: 'C:\\Windows\\System32\\Sethc.exe'\n    filter_optional_aurora_1:\n        StartFunction: 'EtwpNotificationThread'\n    filter_optional_aurora_2:\n        SourceImage|contains: 'unknown process'\n    filter_optional_vmtoolsd:\n        SourceImage: 'C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe'\n        StartFunction: 'GetCommandLineW'\n        TargetImage:\n            - 'C:\\Windows\\System32\\notepad.exe'\n            - 'C:\\Windows\\System32\\spoolsv.exe'\n    filter_optional_xerox_pjems:\n        SourceImage: 'C:\\Program Files\\Xerox\\XeroxPrintExperience\\CommonFiles\\XeroxPrintJobEventManagerService.exe'\n        StartFunction: 'LoadLibraryW'\n        TargetImage: 'C:\\Windows\\System32\\spoolsv.exe'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"create_remote_thread\\create_remote_thread_win_susp_uncommon_source_image.yml","content":"title: Remote Thread Creation By Uncommon Source Image\nid: 66d31e5f-52d6-40a4-9615-002d3789a119\nrelated:\n    - id: 02d1d718-dd13-41af-989d-ea85c7fab93f\n      type: derived\nstatus: test\ndescription: Detects uncommon processes creating remote threads.\nreferences:\n    - Personal research, statistical analysis\n    - https://lolbas-project.github.io\nauthor: Perez Diego (@darkquassar), oscd.community\ndate: 2019-10-27\nmodified: 2025-07-08\ntags:\n    - attack.privilege-escalation\n    - attack.defense-evasion\n    - attack.t1055\nlogsource:\n    product: windows\n    category: create_remote_thread\ndetection:\n    selection:\n        SourceImage|endswith:\n            - '\\explorer.exe'\n            - '\\iexplore.exe'\n            - '\\msiexec.exe'\n            - '\\powerpnt.exe'\n            - '\\schtasks.exe'\n            - '\\winlogon.exe'\n    filter_main_winlogon_1:\n        SourceImage: 'C:\\Windows\\System32\\winlogon.exe'\n        TargetImage:\n            - 'C:\\Windows\\System32\\services.exe' # happens on Windows 7\n            - 'C:\\Windows\\System32\\wininit.exe' # happens on Windows 7\n            - 'C:\\Windows\\System32\\csrss.exe' # multiple OS\n            - 'C:\\Windows\\System32\\LogonUI.exe' # multiple OS\n            - 'C:\\Windows\\System32\\wlrmdr.exe'\n            - 'C:\\Windows\\System32\\AtBroker.exe'\n            - 'C:\\Windows\\System32\\dwm.exe'\n            - 'C:\\Windows\\System32\\fontdrvhost.exe'\n            - 'C:\\Windows\\System32\\userinit.exe'\n    filter_main_winlogon_2:\n        SourceImage: 'C:\\Windows\\System32\\winlogon.exe'\n        TargetParentProcessId: 4\n    filter_main_schtasks_conhost:\n        SourceImage:\n            - 'C:\\Windows\\System32\\schtasks.exe'\n            - 'C:\\Windows\\SysWOW64\\schtasks.exe'\n        TargetImage: 'C:\\Windows\\System32\\conhost.exe'\n    filter_main_explorer:\n        SourceImage: 'C:\\Windows\\explorer.exe'\n        TargetImage|startswith:\n            - 'C:\\Program Files (x86)\\'\n            - 'C:\\Program Files\\'\n            - 'C:\\Windows\\System32\\'\n            - 'C:\\Windows\\SysWOW64\\'\n    filter_main_system:\n        TargetImage: 'System'\n    filter_main_msiexec_1:\n        # Note: MSI installers will trigger this\n        SourceImage|endswith: '\\msiexec.exe'\n        TargetImage|contains:\n            - '\\AppData\\Local\\'\n            - 'C:\\Program Files (x86)\\'\n            - 'C:\\Program Files\\'\n            - 'C:\\Windows\\Microsoft.NET\\Framework64\\' # C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\ngen.exe\n    filter_main_msiexec_2:\n        SourceImage|endswith: '\\msiexec.exe'\n        TargetImage:\n            - 'C:\\Windows\\System32\\msiexec.exe'\n            - 'C:\\Windows\\SysWOW64\\msiexec.exe'\n    filter_main_iexplore:\n        SourceImage: 'C:\\Program Files\\Internet Explorer\\iexplore.exe'\n        TargetImage:\n            - 'C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe'\n            - 'C:\\Windows\\System32\\rundll32.exe'\n    filter_main_powerpnt:\n        SourceImage|endswith: '\\POWERPNT.EXE'\n        TargetImage|contains:\n            - 'C:\\Program Files\\Microsoft Office\\' # C:\\Program Files\\Microsoft Office\\root\\vfs\\ProgramFilesCommonX64\\Microsoft Shared\\Office16\\AI\\ai.exe\n            - 'C:\\Program Files (x86)\\Microsoft Office\\'\n    filter_optional_aurora_smartconsole1:\n        SourceImage: 'C:\\Program Files\\internet explorer\\iexplore.exe'\n        SourceCommandLine|contains|all:\n            - 'https://'\n            - '.checkpoint.com/documents/'\n            - 'SmartConsole_OLH/'\n            - 'default.htm#cshid='\n    filter_optional_aurora_smartconsole2:\n        SourceImage: 'C:\\Program Files\\internet explorer\\iexplore.exe'\n        SourceParentImage|startswith:\n            - 'C:\\Program Files\\'\n            - 'C:\\Program Files (x86)\\'\n        SourceParentImage|contains|all:\n            - '\\CheckPoint\\SmartConsole\\'\n            - '\\SmartConsole.exe'\n    filter_optional_powerpnt:\n        # Raised by the following issue: https://github.com/SigmaHQ/sigma/issues/2479\n        SourceImage|contains: '\\Microsoft Office\\'\n        SourceImage|endswith: '\\POWERPNT.EXE'\n        TargetImage: 'C:\\Windows\\System32\\csrss.exe'\n    filter_main_null:\n        TargetImage: null\n    filter_main_empty:\n        TargetImage: ''\n    filter_optional_onedrive:\n        SourceImage: 'C:\\Windows\\explorer.exe'\n        TargetImage|endswith: '\\AppData\\Local\\Microsoft\\OneDrive\\OneDrive.exe'\n    filter_optional_aurora:\n        SourceImage: 'C:\\Windows\\explorer.exe'\n        TargetImage|endswith: '\\aurora-dashboard.exe'\n    filter_optional_officesetup:\n        SourceImage: 'C:\\Windows\\explorer.exe'\n        TargetImage|endswith: '\\OfficeSetup.exe'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - This rule is best put in testing first in order to create a baseline that reflects the data in your environment.\nlevel: medium\n"},{"path":"create_remote_thread\\create_remote_thread_win_susp_relevant_source_image.yml","content":"title: Rare Remote Thread Creation By Uncommon Source Image\nid: 02d1d718-dd13-41af-989d-ea85c7fab93f\nrelated:\n    - id: 66d31e5f-52d6-40a4-9615-002d3789a119\n      type: derived\nstatus: test\ndescription: Detects uncommon processes creating remote threads.\nreferences:\n    - Personal research, statistical analysis\n    - https://lolbas-project.github.io\nauthor: Perez Diego (@darkquassar), oscd.community\ndate: 2019-10-27\nmodified: 2025-10-18\ntags:\n    - attack.privilege-escalation\n    - attack.defense-evasion\n    - attack.t1055\nlogsource:\n    product: windows\n    category: create_remote_thread\ndetection:\n    selection:\n        SourceImage|endswith:\n            - '\\bash.exe'\n            - '\\cscript.exe'\n            - '\\cvtres.exe'\n            - '\\defrag.exe'\n            - '\\dialer.exe'\n            - '\\dnx.exe'\n            - '\\esentutl.exe'\n            - '\\excel.exe'\n            - '\\expand.exe'\n            - '\\find.exe'\n            - '\\findstr.exe'\n            - '\\forfiles.exe'\n            - '\\gpupdate.exe'\n            - '\\hh.exe'\n            - '\\installutil.exe'\n            - '\\lync.exe'\n            - '\\makecab.exe'\n            - '\\mDNSResponder.exe'\n            - '\\monitoringhost.exe' # Loads .NET CLR by default and thus a favorite for process injection for .NET in-memory offensive tools.\n            - '\\msbuild.exe'\n            - '\\mshta.exe'\n            - '\\mspaint.exe'\n            - '\\outlook.exe'\n            - '\\ping.exe'\n            - '\\provtool.exe'\n            - '\\python.exe'\n            - '\\regsvr32.exe'\n            - '\\robocopy.exe'\n            - '\\runonce.exe'\n            - '\\sapcimc.exe'\n            - '\\smartscreen.exe'\n            - '\\spoolsv.exe'\n            - '\\tstheme.exe'\n            - '\\userinit.exe'\n            - '\\vssadmin.exe'\n            - '\\vssvc.exe'\n            - '\\w3wp.exe'\n            - '\\winscp.exe'\n            - '\\winword.exe'\n            - '\\wmic.exe'\n            - '\\wscript.exe'\n    filter_main_conhost:\n        SourceImage:\n            - 'C:\\Windows\\System32\\Defrag.exe'\n            - 'C:\\Windows\\System32\\makecab.exe'\n        TargetImage: 'C:\\Windows\\System32\\conhost.exe'\n    filter_main_provtol_svchost:\n        SourceImage: 'C:\\Windows\\System32\\provtool.exe'\n        TargetImage: 'C:\\Windows\\System32\\svchost.exe'\n    filter_main_userinit:\n        SourceImage: 'C:\\Windows\\System32\\userinit.exe'\n        TargetImage: 'C:\\Windows\\explorer.exe'\n    filter_main_winword:\n        SourceImage|endswith: '\\WINWORD.EXE'\n        TargetImage|startswith:\n            - 'C:\\Program Files (x86)\\' # C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\n            - 'C:\\Program Files\\' # C:\\Program Files\\Microsoft Office\\root\\vfs\\ProgramFilesCommonX64\\Microsoft Shared\\Office16\\AI\\ai.exe\n    filter_main_ms_office:\n        # Raised by following issue: https://github.com/SigmaHQ/sigma/issues/5529\n        SourceImage|startswith:\n            - 'C:\\Program Files\\Microsoft Office\\'\n            - 'C:\\Program Files (x86)\\Microsoft Office\\'\n        TargetImage: 'System'\n    filter_optional_explorer_vmtools:\n        SourceImage|endswith: '\\SysWOW64\\explorer.exe'\n        TargetImage:\n            - 'C:\\Program Files (x86)\\VMware\\VMware Tools\\vmtoolsd.exe'\n            - 'C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe'\n    condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*\nfalsepositives:\n    - This rule is best put in testing first in order to create a baseline that reflects the data in your environment.\nlevel: high\n"},{"path":"create_remote_thread\\create_remote_thread_win_susp_password_dumper_lsass.yml","content":"title: Password Dumper Remote Thread in LSASS\nid: f239b326-2f41-4d6b-9dfa-c846a60ef505\nstatus: stable\ndescription: |\n    Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage.\n    The process in field Process is the malicious program. A single execution can lead to hundreds of events.\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/WCE.htm\nauthor: Thomas Patzke\ndate: 2017-02-19\nmodified: 2021-06-21\ntags:\n    - attack.credential-access\n    - attack.s0005\n    - attack.t1003.001\nlogsource:\n    product: windows\n    category: create_remote_thread\ndetection:\n    selection:\n        TargetImage|endswith: '\\lsass.exe'\n        StartModule: ''\n    condition: selection\nfalsepositives:\n    - Antivirus products\nlevel: high\n"},{"path":"create_remote_thread\\create_remote_thread_win_powershell_susp_targets.yml","content":"title: Remote Thread Creation Via PowerShell In Uncommon Target\nid: 99b97608-3e21-4bfe-8217-2a127c396a0e\nrelated:\n    - id: eeb2e3dc-c1f4-40dd-9bd5-149ee465ad50\n      type: similar\nstatus: test\ndescription: Detects the creation of a remote thread from a Powershell process in an uncommon target process\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2018/06/bring-your-own-land-novel-red-teaming-technique.html\nauthor: Florian Roth (Nextron Systems)\ndate: 2018-06-25\nmodified: 2023-11-10\ntags:\n    - attack.defense-evasion\n    - attack.execution\n    - attack.t1218.011\n    - attack.t1059.001\nlogsource:\n    product: windows\n    category: create_remote_thread\ndetection:\n    selection:\n        SourceImage|endswith:\n            - '\\powershell.exe'\n            - '\\pwsh.exe'\n        TargetImage|endswith:\n            # Note: Please add additional potential interesting targets to increase coverage\n            - '\\rundll32.exe'\n            - '\\regsvr32.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n"},{"path":"create_remote_thread\\create_remote_thread_win_powershell_lsass.yml","content":"title: Potential Credential Dumping Attempt Via PowerShell Remote Thread\nid: fb656378-f909-47c1-8747-278bf09f4f4f\nrelated:\n    - id: 3f07b9d1-2082-4c56-9277-613a621983cc\n      type: obsolete\n    - id: 0f920ebe-7aea-4c54-b202-9aa0c609cfe5\n      type: similar\nstatus: test\ndescription: Detects remote thread creation by PowerShell processes into \"lsass.exe\"\nreferences:\n    - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse\nauthor: oscd.community, Natalia Shornikova\ndate: 2020-10-06\nmodified: 2022-12-18\ntags:\n    - attack.credential-access\n    - attack.t1003.001\nlogsource:\n    product: windows\n    category: create_remote_thread\ndetection:\n    selection:\n        SourceImage|endswith:\n            - '\\powershell.exe'\n            - '\\pwsh.exe'\n        TargetImage|endswith: '\\lsass.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"create_remote_thread\\create_remote_thread_win_mstsc_susp_location.yml","content":"title: Remote Thread Creation In Mstsc.Exe From Suspicious Location\nid: c0aac16a-b1e7-4330-bab0-3c27bb4987c7\nstatus: test\ndescription: |\n    Detects remote thread creation in the \"mstsc.exe\" process by a process located in a potentially suspicious location.\n    This technique is often used by attackers in order to hook some APIs used by DLLs loaded by \"mstsc.exe\" during RDP authentications in order to steal credentials.\nreferences:\n    - https://github.com/S12cybersecurity/RDPCredentialStealer/blob/1b8947cdd065a06c1b62e80967d3c7af895fcfed/APIHookInjectorBin/APIHookInjectorBin/Inject.h#L25\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-07-28\nmodified: 2024-01-22\ntags:\n    - attack.credential-access\nlogsource:\n    product: windows\n    category: create_remote_thread\ndetection:\n    selection:\n        TargetImage|endswith: '\\mstsc.exe'\n        SourceImage|contains:\n            - ':\\Temp\\'\n            - ':\\Users\\Public\\'\n            - ':\\Windows\\PerfLogs\\'\n            - ':\\Windows\\Tasks\\'\n            - ':\\Windows\\Temp\\'\n            - '\\AppData\\Local\\Temp\\'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"create_remote_thread\\create_remote_thread_win_keepass.yml","content":"title: Remote Thread Created In KeePass.EXE\nid: 77564cc2-7382-438b-a7f6-395c2ae53b9a\nstatus: test\ndescription: Detects remote thread creation in \"KeePass.exe\" which could indicates potential password dumping activity\nreferences:\n    - https://www.cisa.gov/uscert/ncas/alerts/aa20-259a\n    - https://github.com/denandz/KeeFarce\n    - https://github.com/GhostPack/KeeThief\nauthor: Timon Hackenjos\ndate: 2022-04-22\nmodified: 2023-05-05\ntags:\n    - attack.credential-access\n    - attack.t1555.005\nlogsource:\n    product: windows\n    category: create_remote_thread\ndetection:\n    selection:\n        TargetImage|endswith: '\\KeePass.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"create_remote_thread\\create_remote_thread_win_hktl_cobaltstrike.yml","content":"title: HackTool - Potential CobaltStrike Process Injection\nid: 6309645e-122d-4c5b-bb2b-22e4f9c2fa42\nstatus: test\ndescription: Detects a potential remote threat creation with certain characteristics which are typical for Cobalt Strike beacons\nreferences:\n    - https://medium.com/@olafhartong/cobalt-strike-remote-threads-detection-206372d11d0f\n    - https://blog.cobaltstrike.com/2018/04/09/cobalt-strike-3-11-the-snake-that-eats-its-tail/\nauthor: Olaf Hartong, Florian Roth (Nextron Systems), Aleksey Potapov, oscd.community\ndate: 2018-11-30\nmodified: 2023-05-05\ntags:\n    - attack.privilege-escalation\n    - attack.defense-evasion\n    - attack.t1055.001\nlogsource:\n    product: windows\n    category: create_remote_thread\ndetection:\n    selection:\n        StartAddress|endswith:\n            - '0B80'\n            - '0C7C'\n            - '0C88'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"},{"path":"create_remote_thread\\create_remote_thread_win_hktl_cactustorch.yml","content":"title: HackTool - CACTUSTORCH Remote Thread Creation\nid: 2e4e488a-6164-4811-9ea1-f960c7359c40\nstatus: test\ndescription: Detects remote thread creation from CACTUSTORCH as described in references.\nreferences:\n    - https://twitter.com/SBousseaden/status/1090588499517079552 # Deleted\n    - https://github.com/mdsecactivebreach/CACTUSTORCH\nauthor: '@SBousseaden (detection), Thomas Patzke (rule)'\ndate: 2019-02-01\nmodified: 2023-05-05\ntags:\n    - attack.privilege-escalation\n    - attack.defense-evasion\n    - attack.execution\n    - attack.t1055.012\n    - attack.t1059.005\n    - attack.t1059.007\n    - attack.t1218.005\nlogsource:\n    product: windows\n    category: create_remote_thread\ndetection:\n    selection:\n        SourceImage|endswith:\n            - '\\System32\\cscript.exe'\n            - '\\System32\\wscript.exe'\n            - '\\System32\\mshta.exe'\n            - '\\winword.exe'\n            - '\\excel.exe'\n        TargetImage|contains: '\\SysWOW64\\'\n        StartModule: null\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"}]