[{"path":"sysmon\\sysmon_file_executable_detected.yml","content":"title: Sysmon File Executable Creation Detected\nid: 693a44e9-7f26-4cb6-b787-214867672d3a\nstatus: test\ndescription: Triggers on any Sysmon \"FileExecutableDetected\" event, which triggers every time a PE that is monitored by the config is created.\nreferences:\n    - https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon\n    - https://medium.com/@olafhartong/sysmon-15-0-file-executable-detected-40fd64349f36\nauthor: frack113\ndate: 2023-07-20\ntags:\n    - attack.defense-evasion\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 29  # this is fine, we want to match any FileExecutableDetected event\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: medium\n"},{"path":"sysmon\\sysmon_file_block_shredding.yml","content":"title: Sysmon Blocked File Shredding\nid: c3e5c1b1-45e9-4632-b242-27939c170239\nstatus: test\ndescription: Triggers on any Sysmon \"FileBlockShredding\" event, which indicates a violation of the configured shredding policy.\nreferences:\n    - https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon\nauthor: frack113\ndate: 2023-07-20\ntags:\n    - attack.defense-evasion\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 28  # this is fine, we want to match any FileBlockShredding event\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"sysmon\\sysmon_file_block_executable.yml","content":"title: Sysmon Blocked Executable\nid: 23b71bc5-953e-4971-be4c-c896cda73fc2\nstatus: test\ndescription: Triggers on any Sysmon \"FileBlockExecutable\" event, which indicates a violation of the configured block policy\nreferences:\n    - https://medium.com/@olafhartong/sysmon-14-0-fileblockexecutable-13d7ba3dff3e\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-16\nmodified: 2023-09-16\ntags:\n    - attack.defense-evasion\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 27  # this is fine, we want to match any FileBlockExecutable event\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n"},{"path":"sysmon\\sysmon_config_modification_status.yml","content":"title: Sysmon Configuration Modification\nid: 1f2b5353-573f-4880-8e33-7d04dcf97744\nstatus: test\ndescription: Detects when an attacker tries to hide from Sysmon by disabling or stopping it\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md\n    - https://talesfrominfosec.blogspot.com/2017/12/killing-sysmon-silently.html\nauthor: frack113\ndate: 2021-06-04\nmodified: 2022-08-02\ntags:\n    - attack.defense-evasion\n    - attack.t1564\nlogsource:\n    product: windows\n    category: sysmon_status\ndetection:\n    selection_stop:\n        State: Stopped\n    selection_conf:\n        - 'Sysmon config state changed'\n    filter:\n        State: Started\n    condition: 1 of selection_* and not filter\nfalsepositives:\n    - Legitimate administrative action\nlevel: high\n"},{"path":"sysmon\\sysmon_config_modification_error.yml","content":"title: Sysmon Configuration Error\nid: 815cd91b-7dbc-4247-841a-d7dd1392b0a8\nstatus: test\ndescription: Detects when an adversary is trying to hide it's action from Sysmon logging based on error messages\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md\n    - https://talesfrominfosec.blogspot.com/2017/12/killing-sysmon-silently.html\nauthor: frack113\ndate: 2021-06-04\nmodified: 2022-07-07\ntags:\n    - attack.defense-evasion\n    - attack.t1564\nlogsource:\n    product: windows\n    category: sysmon_error\ndetection:\n    selection_error:\n        Description|contains:\n            - 'Failed to open service configuration with error'\n            - 'Failed to connect to the driver to update configuration'\n    filter_generic_english:\n        Description|contains|all:\n            - 'Failed to open service configuration with error'\n            - 'Last error: The media is write protected.'\n    filter_by_errorcode:\n        Description|contains:\n            - 'Failed to open service configuration with error 19'\n            - 'Failed to open service configuration with error 93'\n    condition: selection_error and not 1 of filter*\nfalsepositives:\n    - Legitimate administrative action\nlevel: high\n"},{"path":"sysmon\\sysmon_config_modification.yml","content":"title: Sysmon Configuration Change\nid: 8ac03a65-6c84-4116-acad-dc1558ff7a77\nstatus: test\ndescription: Detects a Sysmon configuration change, which could be the result of a legitimate reconfiguration or someone trying manipulate the configuration\nreferences:\n    - https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon\nauthor: frack113\ndate: 2022-01-12\ntags:\n    - attack.defense-evasion\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 16\n    # To avoid FP just add\n    # filter:\n    #      ConfigurationFileHash: 'SHA256=The_Hash_Of_Your_Valid_Config_XML'\n    # condition: selection and not filter\n    condition: selection\nfalsepositives:\n    - Legitimate administrative action\nlevel: medium\n"}]