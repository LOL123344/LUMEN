[{"path":"applocker\\eid_8007_applocker_msi-script_blocked.yml","content":"---\r\ntitle: AppLocker - MSI/Script blocked\r\ngroup: AppLocker Blocked\r\ndescription: AppLocker - MSI/Script prevented from running\r\ndate: 2023-07-03\r\nversion: 1.0\r\nauthors:\r\n  - Catarina de Faria\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: TargetUser\r\n    to: Event.UserData.RuleAndFileData.TargetUser\r\n  - name: FullFilePath\r\n    to: Event.UserData.RuleAndFileData.FullFilePath\r\n    \r\n\r\nfilter:\r\n  condition: applocker_msi_scripts_blocked\r\n\r\n  applocker_msi_scripts_blocked:\r\n    Event.System.EventID: 8007\r\n    Event.System.Channel: Microsoft-Windows-AppLocker/MSI and Script\r\n"},{"path":"applocker\\eid_8004_applocker_exe-dll_blocked.yml","content":"---\r\ntitle: AppLocker - EXE/DLL blocked\r\ngroup: AppLocker Blocked\r\ndescription: AppLocker - EXE/DLL prevented from running\r\nauthors:\r\n  - Catarina de Faria\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: TargetUser\r\n    to: Event.UserData.RuleAndFileData.TargetUser\r\n  - name: FullFilePath\r\n    to: Event.UserData.RuleAndFileData.FullFilePath\r\n\r\n\r\nfilter:\r\n  condition: applocker_exe_dll_blocked\r\n\r\n  applocker_exe_dll_blocked:\r\n    Event.System.EventID: 8004\r\n    Event.System.Channel: Microsoft-Windows-AppLocker/EXE and DLL\r\n"},{"path":"applocker\\eid_8002_privilege_escalation.yml","content":"---\r\ntitle: AppLocker - LOLBin allowed (Privilege Escalation)\r\ngroup: AppLocker Allowed\r\ndescription: AppLocker - LOLBin allowed to run (Privilege Escalation)\r\ndate: 2023-07-03\r\nversion: 1.0\r\nauthors:\r\n  - Catarina de Faria\r\n\r\n\r\nkind: evtx\r\nlevel: medium\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: TargetUser\r\n    to: Event.UserData.RuleAndFileData.TargetUser\r\n  - name: FullFilePath\r\n    to: Event.UserData.RuleAndFileData.FullFilePath\r\n\r\n\r\nfilter:\r\n  condition: applocker_exe_dll and lolbin\r\n\r\n  applocker_exe_dll:\r\n    Event.System.EventID: 8002\r\n    Event.System.Channel: Microsoft-Windows-AppLocker/EXE and DLL\r\n  lolbin:\r\n    Event.UserData.RuleAndFileData.FullFilePath:\r\n      - C:\\Windows\\System32\\runas.exe\r\n"},{"path":"applocker\\eid_8002_lolbin_lateral_mouvement.yml","content":"---\r\ntitle: AppLocker - LOLBin allowed (Lateral Mouvement)\r\ngroup: AppLocker Allowed\r\ndescription: AppLocker - LOLBin allowed to run (Lateral Mouvement)\r\ndate: 2023-07-03\r\nversion: 1.0\r\nauthors:\r\n  - Catarina de Faria\r\n\r\n\r\nkind: evtx\r\nlevel: medium\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: TargetUser\r\n    to: Event.UserData.RuleAndFileData.TargetUser\r\n  - name: FullFilePath\r\n    to: Event.UserData.RuleAndFileData.FullFilePath\r\n\r\n\r\nfilter:\r\n  condition: applocker_exe_dll and lolbin\r\n\r\n  applocker_exe_dll:\r\n    Event.System.EventID: 8002\r\n    Event.System.Channel: Microsoft-Windows-AppLocker/EXE and DLL\r\n  lolbin:\r\n    Event.UserData.RuleAndFileData.FullFilePath:\r\n      - C:\\Windows\\System32\\mstsc.exe\r\n"},{"path":"applocker\\eid_8002_applocker_reconnaissance_allowed.yml","content":"---\r\ntitle: AppLocker - LOLBin allowed (Reconnaissance)\r\ngroup: AppLocker Allowed\r\ndescription: AppLocker - Reconnaissance LOLBin allowed to run\r\ndate: 2023-07-03\r\nversion: 1.0\r\nauthors:\r\n  - Catarina de Faria\r\n\r\n\r\nkind: evtx\r\nlevel: medium\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: TargetUser\r\n    to: Event.UserData.RuleAndFileData.TargetUser\r\n  - name: FullFilePath\r\n    to: Event.UserData.RuleAndFileData.FullFilePath\r\n\r\n\r\nfilter:\r\n  condition: applocker_exe_dll and recon_lolbin\r\n\r\n  applocker_exe_dll:\r\n    Event.System.EventID: 8002\r\n    Event.System.Channel: Microsoft-Windows-AppLocker/EXE and DLL\r\n  recon_lolbin:\r\n    Event.UserData.RuleAndFileData.FullFilePath:\r\n      - C:\\Windows\\system32\\whoami.exe\r\n      - C:\\Windows\\System32\\gpresult.exe\r\n      - C:\\Windows\\System32\\net.exe\r\n      - C:\\Windows\\System32\\net1.exe\r\n      - C:\\Windows\\System32\\query.exe\r\n      - C:\\Windows\\System32\\ping.exe\r\n      - C:\\Windows\\System32\\findstr.exe\r\n      - C:\\Windows\\System32\\klist.exe\r\n      - C:\\Windows\\System32\\nslookup.exe\r\n"},{"path":"applocker\\eid_8002_applocker_lolbins_allowed_to_run.yml","content":"---\r\ntitle: AppLocker - LOLBin allowed (LOTL attacks)\r\ngroup: AppLocker Allowed\r\ndescription: AppLocker - LOLBin allowed to run (LOTL attacks)\r\ndate: 2023-07-03\r\nversion: 1.0\r\nauthors:\r\n  - Catarina de Faria\r\n\r\n\r\nkind: evtx\r\nlevel: medium\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: TargetUser\r\n    to: Event.UserData.RuleAndFileData.TargetUser\r\n  - name: FullFilePath\r\n    to: Event.UserData.RuleAndFileData.FullFilePath\r\n\r\n\r\nfilter:\r\n  condition: applocker_exe_dll and lolbin\r\n\r\n  applocker_exe_dll:\r\n    Event.System.EventID: 8002\r\n    Event.System.Channel: Microsoft-Windows-AppLocker/EXE and DLL\r\n  lolbin:\r\n    Event.UserData.RuleAndFileData.FullFilePath:\r\n      - C:\\Windows\\System32\\ftp.exe \r\n      - C:\\Windows\\System32\\wbem\\WMIC.exe\r\n      - \"*msbuild.exe\"\r\n      - C:\\Windows\\system32\\runas.exe\r\n"}]