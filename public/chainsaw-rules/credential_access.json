[{"path":"credential_access\\weak_kerberos_ticket.yml","content":"---\r\ntitle: Weak Kerberos ticket encryption algorithm\r\ngroup: Credential Access\r\ndescription: A weak ticket encryption type was used and could indicate either an insecure configuration or a kerberoasting attack.\r\nauthors:\r\n  - Lucas Echard\r\n\r\n\r\nkind: evtx\r\nlevel: high\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User\r\n    to: Event.EventData.TargetUserName\r\n  - name: Service Name\r\n    to: Event.EventData.ServiceName\r\n  - name: IP Address\r\n    to: Event.EventData.IpAddress\r\n\r\n\r\nfilter:\r\n  condition: weak_kerberos_ticket\r\n\r\n  weak_kerberos_ticket:\r\n    Event.System.EventID: 4769\r\n    Event.System.Channel: \"Security\"\r\n    Event.EventData.TicketEncryptionType:\r\n      - \"0x17\"\r\n      - \"0x18\"\r\n    Event.EventData.Status: \"0x0\"\r\n"},{"path":"credential_access\\kerberoasting_administrator.yml","content":"---\r\ntitle: Kerberos service ticket requested for Administrator\r\ngroup: Credential Access\r\ndescription: A kerberos service ticket targeting the Administator account was requested, which could be related to a kerberoasting attack. This is suspicious since domain administrators should not be used as service accounts and therefore should not have SPNs assigned.\r\nauthors:\r\n  - Lucas Echard\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User\r\n    to: Event.EventData.TargetUserName\r\n  - name: Service Name\r\n    to: Event.EventData.ServiceName\r\n  - name: IP Address\r\n    to: Event.EventData.IpAddress\r\n\r\n\r\nfilter:\r\n  condition: kerberos_ticket\r\n\r\n  kerberos_ticket:\r\n    Event.System.EventID: 4769\r\n    Event.System.Channel: \"Security\"\r\n    Event.EventData.ServiceSid: \"*-500\"\r\n    Event.EventData.Status: \"0x0\"\r\n"}]