[{"path":"persistence\\T1547.004 - Winlogon System Shell Changed.yml","content":"---\r\ntitle: T1547.004 - Winlogon System Shell Changed\r\ngroup: Persistence\r\ndescription: The process userinit.exe launched a different process than explorer.exe which indicates the Winlogon\\Shell registry value was changed.\r\nauthors:\r\n  - JakePeralta\r\n# Requires 'Audit process tracking' to be turned on in the GPO\r\n\r\nkind: evtx\r\nlevel: medium\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Domain Name\r\n    to: Event.EventData.SubjectDomainName\r\n  - name: User Name\r\n    to: Event.EventData.SubjectUserName\r\n  - name: Logon ID\r\n    to: Event.EventData.SubjectLogonId\r\n  - name: Parent Process Name\r\n    to: Event.EventData.ParentProcessName\r\n  - name: Parent Process Command Line\r\n    to: Event.EventData.CommandLine\r\n  - name: New Process Name\r\n    to: Event.EventData.NewProcessName\r\n  - name: New Process ID\r\n    to: Event.EventData.NewProcessId\r\n\r\n\r\nfilter:\r\n  condition: parent_process_userinit and not child_process_explorer\r\n  \r\n  parent_process_userinit:\r\n    Event.System.Channel: Security\r\n    Event.System.Provider: Microsoft-Windows-Security-Auditing\r\n    Event.System.EventID: 4688\r\n    Event.EventData.ParentProcessName: '*\\userinit.exe'\r\n  \r\n  child_process_explorer:\r\n    Event.EventData.NewProcessName: 'C:\\Windows\\explorer.exe'\r\n"},{"path":"persistence\\T1053.005 - Scheduled Task was Created.yml","content":"---\r\ntitle: T1053.005 - Scheduled Task was Created\r\ngroup: Persistence\r\ndescription: A new scheduled task was created\r\nauthors:\r\n  - JakePeralta\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User Name\r\n    to: Event.EventData.UserContext\r\n  - name: Scheduled Task Name\r\n    to: Event.EventData.TaskName\r\n\r\n\r\nfilter:\r\n  Event.System.Channel: Microsoft-Windows-TaskScheduler/Operational\r\n  Event.System.EventID: 106\r\n"}]