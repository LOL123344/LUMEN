[{"path":"powershell\\eid_4104_powershell_script_executed.yml","content":"---\r\ntitle: PowerShell - Script Block Auditing\r\ngroup: PowerShell Script\r\ndescription: PowerShell - Script Block Auditing\r\nauthors: \r\n  - Catarina de Faria\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Information\r\n    to: Event.EventData.Path\r\n\r\nfilter:\r\n  condition: powershell_script_block and not filepath_empty\r\n\r\n  powershell_script_block:\r\n      Event.System.EventID: 4104\r\n      Event.System.Channel: Microsoft-Windows-PowerShell/Operational\r\n  filepath_empty:\r\n      Event.EventData.Path: ''\r\n\r\n"},{"path":"powershell\\eid_403_powershell_engine_state_stopped.yml","content":"---\r\ntitle: PowerShell - Engine state is changed from Available to Stopped\r\ngroup: PowerShell Engine State\r\ndescription: PowerShell - Engine state is changed from Available to Stopped\r\nauthors: \r\n  - Reece394\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: HostName\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: HostName\r\n    from: Event.EventData.Data[2].HostName\r\n  - name: HostVersion\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: HostVersion\r\n    from: Event.EventData.Data[2].HostVersion\r\n  - name: HostApplication\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: HostApplication\r\n    from: Event.EventData.Data[2].HostApplication\r\n  - name: PipelineId\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: PipelineId\r\n    from: Event.EventData.Data[2].PipelineId\r\n  - name: CommandName\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: CommandName\r\n    from: Event.EventData.Data[2].CommandName\r\n  - name: CommandType\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: CommandType\r\n    from: Event.EventData.Data[2].CommandType\r\n  - name: ScriptName\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: ScriptName\r\n    from: Event.EventData.Data[2].ScriptName\r\n  - name: CommandPath\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: CommandPath\r\n    from: Event.EventData.Data[2].CommandPath\r\n  - name: CommandLine\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: CommandLine\r\n    from: Event.EventData.Data[2].CommandLine\r\nfilter:\r\n  condition: powershell\r\n\r\n  powershell:\r\n      Event.System.EventID: 403\r\n      Event.System.Channel: Windows PowerShell\r\n\r\n"},{"path":"powershell\\eid_400_powershell_engine_state_available.yml","content":"---\r\ntitle: PowerShell - Engine state is changed from None to Available\r\ngroup: PowerShell Engine State\r\ndescription: PowerShell - Engine state is changed from None to Available\r\nauthors: \r\n  - Reece394\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: HostName\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: HostName\r\n    from: Event.EventData.Data[2].HostName\r\n  - name: HostVersion\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: HostVersion\r\n    from: Event.EventData.Data[2].HostVersion\r\n  - name: HostApplication\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: HostApplication\r\n    from: Event.EventData.Data[2].HostApplication\r\n  - name: PipelineId\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: PipelineId\r\n    from: Event.EventData.Data[2].PipelineId\r\n  - name: CommandName\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: CommandName\r\n    from: Event.EventData.Data[2].CommandName\r\n  - name: CommandType\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: CommandType\r\n    from: Event.EventData.Data[2].CommandType\r\n  - name: ScriptName\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: ScriptName\r\n    from: Event.EventData.Data[2].ScriptName\r\n  - name: CommandPath\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: CommandPath\r\n    from: Event.EventData.Data[2].CommandPath\r\n  - name: CommandLine\r\n    container:\r\n     field: Event.EventData.Data[2]\r\n     format: kv\r\n     delimiter: \"\\r\\n\\t\"\r\n     separator: '='\r\n    to: CommandLine\r\n    from: Event.EventData.Data[2].CommandLine\r\nfilter:\r\n  condition: powershell\r\n\r\n  powershell:\r\n      Event.System.EventID: 400\r\n      Event.System.Channel: Windows PowerShell\r\n\r\n"}]