[{"path":"microsoft_rasvpn_events\\eid_20272_20275_rasvpn_server_logoff.yml","content":"---\r\ntitle: Microsoft Remote Access VPN - Server - User logoff\r\ngroup: Microsoft Remote Access VPN\r\ndescription: Microsoft Remote Access VPN - Server - User logoff EID 20272 usually followed by EID 20275\r\nauthors: \r\n  - Théo Letailleur\r\n  - Synacktiv\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to: Event.System.Channel\r\n  - name: Provider\r\n    to: Event.System.Provider\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Data\r\n    to: Event.EventData.Data\r\n\r\nfilter:\r\n  condition: user_active_time_vpn or ip_user_disconnected\r\n\r\n  user_active_time_vpn:\r\n      Event.System.EventID: 20272\r\n      Event.System.Channel: System\r\n      Event.System.Provider: RemoteAccess\r\n  ip_user_disconnected:\r\n      Event.System.EventID: 20275\r\n      Event.System.Channel: System\r\n      Event.System.Provider: RemoteAccess"},{"path":"microsoft_rasvpn_events\\eid_20271_rasvpn_server_authentication_error.yml","content":"---\r\ntitle: Microsoft Remote Access VPN - Server - Authentication error\r\ngroup: Microsoft Remote Access VPN\r\ndescription: Microsoft Remote Access VPN - Server - Authentication error EID 20271\r\nauthors: \r\n  - Théo Letailleur\r\n  - Synacktiv\r\n\r\nkind: evtx\r\nlevel: low\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to: Event.System.Channel\r\n  - name: Provider\r\n    to: Event.System.Provider\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Data\r\n    to: Event.EventData.Data\r\n\r\nfilter:\r\n  condition: ntauth_failure\r\n\r\n  ntauth_failure:\r\n      Event.System.EventID: 20271\r\n      Event.System.Channel: System\r\n      Event.System.Provider: RemoteAccess"},{"path":"microsoft_rasvpn_events\\eid_20253_20255_connection_error.yml","content":"---\r\ntitle: Microsoft Remote Access VPN - Server - Connection error\r\ngroup: Microsoft Remote Access VPN\r\ndescription: Microsoft Remote Access VPN - Server - Connection error EID 20253 or EID 20255\r\nauthors: \r\n  - Théo Letailleur\r\n  - Synacktiv\r\n\r\nkind: evtx\r\nlevel: low\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to: Event.System.Channel\r\n  - name: Provider\r\n    to: Event.System.Provider\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Data\r\n    to: Event.EventData.Data\r\n\r\nfilter:\r\n  condition: auth_no_projections or ppp_failure\r\n\r\n  auth_no_projections:\r\n      Event.System.EventID: 20253\r\n      Event.System.Channel: System\r\n      Event.System.Provider: RemoteAccess\r\n  ppp_failure:\r\n      Event.System.EventID: 20255\r\n      Event.System.Channel: System\r\n      Event.System.Provider: RemoteAccess"},{"path":"microsoft_rasvpn_events\\eid_20250_20274_rasvpn_server_logon.yml","content":"---\r\ntitle: Microsoft Remote Access VPN - Server - User logon\r\ngroup: Microsoft Remote Access VPN\r\ndescription: Microsoft Remote Access VPN - Server - User logon successful EID 20250 followed by EID 20274\r\nauthors: \r\n  - Théo Letailleur\r\n  - Synacktiv\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to: Event.System.Channel\r\n  - name: Provider\r\n    to: Event.System.Provider\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Data\r\n    to: Event.EventData.Data\r\n\r\nfilter:\r\n  condition: auth_success or ip_user_connected\r\n\r\n  auth_success:\r\n      Event.System.EventID: 20250\r\n      Event.System.Channel: System\r\n      Event.System.Provider: RemoteAccess\r\n  ip_user_connected:\r\n      Event.System.EventID: 20274\r\n      Event.System.Channel: System\r\n      Event.System.Provider: RemoteAccess\r\n"},{"path":"microsoft_rasvpn_events\\eid_20226_rasvpn_client_connection_termination.yml","content":"---\r\ntitle: Microsoft Remote Access VPN - Client - Connection termination\r\ngroup: Microsoft Remote Access VPN\r\ndescription: Microsoft Remote Access VPN - Client - Connection termination. EID 20226\r\nauthors: \r\n  - Théo Letailleur\r\n  - Synacktiv\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to: Event.System.Channel\r\n  - name: Provider\r\n    to: Event.System.Provider\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Data\r\n    to: Event.EventData.Data\r\n\r\nfilter:\r\n  condition: rasconnection_terminated\r\n\r\n  rasconnection_terminated:\r\n      Event.System.EventID: 20226\r\n      Event.System.Channel: Application\r\n      Event.System.Provider: RasClient"},{"path":"microsoft_rasvpn_events\\eid_20221_to_20225_rasvpn_client_connection_establishment.yml","content":"---\r\ntitle: Microsoft Remote Access VPN - Client - Connection establishment\r\ngroup: Microsoft Remote Access VPN\r\ndescription: Microsoft Remote Access VPN - Client - Connection establishment. Suite of EIDs 20221->20222->20223->20224->20225\r\nauthors: \r\n  - Théo Letailleur\r\n  - Synacktiv\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to: Event.System.Channel\r\n  - name: Provider\r\n    to: Event.System.Provider\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Data\r\n    to: Event.EventData.Data\r\n\r\nfilter:\r\n  condition: preconnect_info or connecting_device or device_connected or link_established or rasconnection_established\r\n\r\n  preconnect_info:\r\n      Event.System.EventID: 20221\r\n      Event.System.Channel: Application\r\n      Event.System.Provider: RasClient\r\n  connecting_device:\r\n      Event.System.EventID: 20222\r\n      Event.System.Channel: Application\r\n      Event.System.Provider: RasClient\r\n  device_connected:\r\n      Event.System.EventID: 20223\r\n      Event.System.Channel: Application\r\n      Event.System.Provider: RasClient\r\n  link_established:\r\n      Event.System.EventID: 20224\r\n      Event.System.Channel: Application\r\n      Event.System.Provider: RasClient\r\n  rasconnection_established:\r\n      Event.System.EventID: 20225\r\n      Event.System.Channel: Application\r\n      Event.System.Provider: RasClient"},{"path":"microsoft_rasvpn_events\\eid_20220_20227_rasvpn_client_connection_error.yml","content":"---\r\ntitle: Microsoft Remote Access VPN - Client - Connection error\r\ngroup: Microsoft Remote Access VPN\r\ndescription: Microsoft Remote Access VPN - Client - Connection error. EID 20220 or 20227.\r\nauthors: \r\n  - Théo Letailleur\r\n  - Synacktiv\r\n\r\nkind: evtx\r\nlevel: low\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to: Event.System.Channel\r\n  - name: Provider\r\n    to: Event.System.Provider\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Data\r\n    to: Event.EventData.Data\r\n\r\nfilter:\r\n  condition: invalid_server_cert or rasconnection_failed\r\n\r\n  invalid_server_cert:\r\n      Event.System.EventID: 20220\r\n      Event.System.Channel: Application\r\n      Event.System.Provider: RasClient\r\n\r\n  rasconnection_failed:\r\n      Event.System.EventID: 20227\r\n      Event.System.Channel: Application\r\n      Event.System.Provider: RasClient"}]