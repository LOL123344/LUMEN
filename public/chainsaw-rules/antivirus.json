[{"path":"antivirus\\windows_security_essentials.yml","content":"---\r\ntitle: Windows Security Essentials\r\ngroup: Antivirus\r\ndescription: Events from Windows Security Essentials.\r\nauthors:\r\n  - Reece394\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User\r\n    to: Event.EventData.Data[19]\r\n  - name: Threat Name\r\n    to: Event.EventData.Data[7]\r\n  - name: Threat Path\r\n    to: Event.EventData.Data\r\n\r\n\r\nfilter:\r\n  Event.System.Provider: Microsoft Antimalware\r\n  Event.System.EventID:\r\n  # Windows Security Essentials was observed using the same EventIDs as Microsoft Defender.\r\n  # From https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/troubleshoot-microsoft-defender-antivirus\r\n  - 1006 # The antimalware engine found malware or other potentially unwanted software.\r\n  - 1007 # The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.\r\n  - 1008 # The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.\r\n  - 1009 # The antimalware platform restored an item from quarantine.\r\n  - 1010 # The antimalware platform couldn't restore an item from quarantine.\r\n  - 1011 # The antimalware platform deleted an item from quarantine.\r\n  - 1012 # The antimalware platform couldn't delete an item from quarantine.\r\n  - 1015 # The antimalware platform detected suspicious behavior.\r\n  - 1116 # The antimalware platform detected malware or other potentially unwanted software.\r\n  - 1117 # The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.\r\n  - 1118 # The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.\r\n  - 1119 # The antimalware platform encountered a critical error when trying to take action on malware or other potentially unwanted software. There are more details in the event message.\r\n"},{"path":"antivirus\\windows_defender.yml","content":"---\r\ntitle: Windows Defender\r\ngroup: Antivirus\r\ndescription: Events from Windows Defender.\r\nauthors:\r\n  - FranticTyping\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User\r\n    to: Event.EventData.Detection User\r\n  - name: Threat Name\r\n    to: Event.EventData.Threat Name\r\n  - name: Threat Path\r\n    to: Event.EventData.Path\r\n\r\n\r\nfilter:\r\n  Event.System.Provider: Microsoft-Windows-Windows Defender\r\n  Event.System.EventID:\r\n  # From https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/troubleshoot-microsoft-defender-antivirus\r\n  - 1006 # The antimalware engine found malware or other potentially unwanted software.\r\n  - 1007 # The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.\r\n  - 1008 # The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.\r\n  - 1009 # The antimalware platform restored an item from quarantine.\r\n  - 1010 # The antimalware platform couldn't restore an item from quarantine.\r\n  - 1011 # The antimalware platform deleted an item from quarantine.\r\n  - 1012 # The antimalware platform couldn't delete an item from quarantine.\r\n  - 1015 # The antimalware platform detected suspicious behavior.\r\n  - 1116 # The antimalware platform detected malware or other potentially unwanted software.\r\n  - 1117 # The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.\r\n  - 1118 # The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.\r\n  - 1119 # The antimalware platform encountered a critical error when trying to take action on malware or other potentially unwanted software. There are more details in the event message.\r\n  - 1127 # Controlled Folder Access(CFA) blocked an untrusted process from making changes to the memory.\r\n"},{"path":"antivirus\\symantec.yml","content":"---\r\ntitle: Symantec Endpoint\r\ngroup: Antivirus\r\ndescription: Events from Symantec Endpoint Protection.\r\nauthors:\r\n  - Reece394\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Threat Name\r\n    to: Event.EventData.Data\r\n\r\nfilter:\r\n  Event.System.Provider: Symantec Endpoint Protection Client\r\n  Event.System.EventID:\r\n  # From https://knowledge.broadcom.com/external/article/170359/endpoint-protection-140x-event-log-entri.html\r\n  - 5 # Virus Found\r\n  - 6 # Scan Omission\r\n  - 12 # Configuration Changed\r\n  - 13 # Symantec AntiVirus Shutdown\r\n  - 14 # Symantec AntiVirus Startup\r\n  - 17 # Scan Action Auto-Changed. Occurs when Symantec AntiVirus has deleted or quarantined more than five infected files within the last minute\r\n  - 18 # Sent To Quarantine Server\r\n  - 19 # Delivered To Symantec Security Response\r\n  - 45 # SymProtect Action. Occurs when SymProtect blocks a tamper attempt.\r\n  - 46 # Detection Start\r\n  - 47 # Detection Action\r\n  - 48 # Pending Remediation Action\r\n  - 49 # Failed Remediation Action\r\n  - 50 # Successful Remediation Action\r\n  - 51 # Detection Finish\r\n  - 71 # Threat Now Whitelisted\r\n  - 72 # Interesting Process Found Start\r\n  - 75 # Interesting Process Found Finish\r\n  - 77 # SONAR Detected Threat Now Known\r\n  - 88 # ELAM enabled\r\n  - 89 # ELAM disabled\r\n  - 91 # ELAM blocked driver\r\n  - 92 # SymProtect enabled\r\n  - 93 # SymProtect disabled\r\n  - 95 # File is restored. The file is restored from quarantine.\r\n  - 34056 # Symantec Endpoint Protection Tamper Protection Disabled\r\n"},{"path":"antivirus\\sophos.yml","content":"---\r\ntitle: Sophos Antivirus\r\ngroup: Antivirus\r\ndescription: Events from Sophos' Antivirus products.\r\nauthors:\r\n  - FranticTyping\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Threat Type\r\n    to: Event.EventData.Data[0]\r\n  - name: Threat Name\r\n    to: Event.EventData.Data[2]\r\n  - name: Threat Path\r\n    to: Event.EventData.Data[1]\r\n  - name: SHA1\r\n    container:\r\n      field: Event.EventData.Data[4]\r\n      format: json\r\n    to: sha1FileHash  \r\n\r\nfilter:\r\n  Event.System.Provider:\r\n    - Sophos Anti-Virus\r\n    - Sophos System Protection"},{"path":"antivirus\\mcafee.yml","content":"---\r\ntitle: McAfee and Trellix Endpoint\r\ngroup: Antivirus\r\ndescription: Events from McAfee and Trellix Endpoint Security.\r\nauthors:\r\n  - Reece394\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Threat Name\r\n    to: Event.EventData.Data\r\n\r\nfilter:\r\n  Event.System.Provider:\r\n    - McAfee Endpoint Security\r\n    - Trellix Endpoint Security\r\n  Event.System.EventID:\r\n  - 2 # Warning\r\n  - 3 # Error"},{"path":"antivirus\\kaspersky.yml","content":"---\r\ntitle: Kaspersky Antivirus\r\ngroup: Antivirus\r\ndescription: Events from Kaspersky's Antivirus products.\r\nauthors:\r\n  - FranticTyping\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Threat Name\r\n    to: Event.EventData.Data[1]\r\n  - name: Threat Path\r\n    to: Event.EventData.Data[0]\r\n\r\n\r\nfilter:\r\n  Event.System.Provider:\r\n    - Real-time file protection\r\n    - OnDemandScan\r\n    - avp\r\n"},{"path":"antivirus\\f-secure_legacy.yml","content":"---\r\ntitle: F-Secure Antivirus Legacy\r\ngroup: Antivirus\r\ndescription: Events from F-Secure Client Security. Version 11 and 12 Tested\r\nauthors:\r\n  - Reece394\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User\r\n    to: Event.EventData.UserName \r\n  - name: Threat Name\r\n    to: Event.EventData.MessageText\r\n  - name: Threat Path\r\n    to: Event.EventData.Data\r\n\r\nfilter:\r\n  Event.System.Provider:\r\n    - FSecure-FSecure-F-Secure Anti-Virus\r\n    - FSecure-FSecure Application-F-Secure Anti-Virus\r\n    - FSecure-FSecure-F-Secure DeepGuard"},{"path":"antivirus\\f-secure.yml","content":"---\r\ntitle: F-Secure Antivirus\r\ngroup: Antivirus\r\ndescription: Events from F-Secure's Antivirus products.\r\nauthors:\r\n  - FranticTyping\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Threat Name\r\n    from: threat_name\r\n    container:\r\n      field: Event.EventData.rv\r\n      format: json\r\n    to: iname\r\n  - name: Threat Path\r\n    from: threat_path\r\n    container:\r\n      field: Event.EventData.rv\r\n      format: json\r\n    to: obj.ref\r\n  - name: SHA1\r\n    from: sha1\r\n    container:\r\n      field: Event.EventData.rv\r\n      format: json\r\n    to: obj.sha1\r\n\r\n\r\nfilter:\r\n  Event.System.Provider: F-Secure Ultralight SDK\r\n"}]