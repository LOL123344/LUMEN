[{"path":"rdp_attacks\\event_id_4624_logontype_10.yaml","content":"title: RDP logon\r\ngroup: rdp_attacks\r\ndescription: An account was successfully logged onto via RDP\r\nauthors:\r\n  - ElizaBolton\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: event id\r\n    to: Event.System.EventID\r\n  - name: logon type \r\n    to: Event.EventData.LogonType  \r\n  - name: username\r\n    to: Event.EventData.TargetUserName\r\n  - name: computer\r\n    to: Event.System.Computer\r\n  - name: ip address\r\n    to: Event.EventData.IpAddress\r\n  - name: record id\r\n    to: Event.System.EventRecordID\r\n\r\n\r\n\r\nfilter:  \r\n  Event.System.EventID: 4624\r\n  Event.EventData.LogonType: 10\r\n"},{"path":"rdp_attacks\\event_id_25.yaml","content":"title: RDP Session Connected\r\ngroup: rdp_attacks\r\ndescription: User has connected to an RDP session\r\nauthors:\r\n  - ElizaBolton\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: event id\r\n    to: Event.System.EventID\r\n  - name: computer\r\n    to: Event.System.Computer\r\n  - name: ip address\r\n    to: Event.UserData.EventXML.Address\r\n  - name: username\r\n    to: Event.UserData.EventXML.User\r\n  - name: provider\r\n    to: Event.System.Provider\r\n\r\n    \r\nfilter:\r\n  condition: RDP_RELATED and not LOCAL\r\n\r\n\r\n  RDP_RELATED:\r\n    Event.System.EventID: 25\r\n    Event.System.Provider: Microsoft-Windows-TerminalServices-LocalSessionManager\r\n  LOCAL: \r\n    Event.UserData.EventXML.Address: \"LOCAL\"\r\n    "},{"path":"rdp_attacks\\event_id_24.yaml","content":"title: RDP Session Disconnected\r\ngroup: rdp_attacks\r\ndescription: User has disconnected from an RDP session\r\nauthors:\r\n  - ElizaBolton\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: event id\r\n    to: Event.System.EventID\r\n  - name: computer\r\n    to: Event.System.Computer\r\n  - name: ip address\r\n    to: Event.UserData.EventXML.Address\r\n  - name: username\r\n    to: Event.UserData.EventXML.User\r\n  - name: provider\r\n    to: Event.System.Provider\r\n\r\n\r\nfilter:\r\n  condition: RDP_RELATED and not LOCAL\r\n\r\n\r\n  RDP_RELATED:\r\n    Event.System.EventID: 24\r\n    Event.System.Provider: Microsoft-Windows-TerminalServices-LocalSessionManager\r\n  LOCAL: \r\n    Event.UserData.EventXML.Address: \"LOCAL\""},{"path":"rdp_attacks\\event_id_1149.yaml","content":"title: User Authentication Succeeded \r\ngroup: rdp_attacks\r\ndescription: User has successfully authenticated an rdp logon\r\nauthors:\r\n  - ElizaBolton\r\n\r\n\r\nkind: evtx\r\nlevel: critical\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: event id\r\n    to: Event.System.EventID\r\n  - name: record id\r\n    to: Event.System.EventRecordID\r\n  - name: computer\r\n    to: Event.System.Computer\r\n  - name: username\r\n    to: Event.UserData.EventXML.Param1\r\n  - name: domain\r\n    to: Event.UserData.EventXML.Param2\r\n  - name: ip address\r\n    to: Event.UserData.EventXML.Param3\r\n  - name: provider\r\n    to: Event.System.Provider\r\n\r\n\r\nfilter:\r\n  Event.System.EventID: 1149\r\n  Event.System.Provider: Microsoft-Windows-TerminalServices-RemoteConnectionManager\r\n"},{"path":"rdp_attacks\\eid_39_rdp_session_disconnected.yml","content":"---\r\ntitle: RDS - Session <A> has been disconnected by session <B>\r\ngroup: RDP Events\r\ndescription: RDS - Session <A> has been disconnected by session <B>\r\nauthors:\r\n  - Catarina de Faria\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Information\r\n    to: Event.UserData.EventXML\r\n\r\nfilter:\r\n  condition: session_disconnected and not local\r\n\r\n  session_disconnected:\r\n    Event.System.EventID: 39\r\n    Event.System.Channel: Microsoft-Windows-TerminalServices-LocalSessionManager/Operational\r\n  local:\r\n    Event.UserData.EventXML.Address: \"LOCAL\"\r\n"},{"path":"rdp_attacks\\eid_23_rdp_session_logoff.yml","content":"\r\n---\r\ntitle: RDS - Session logoff succeeded \r\ngroup: RDP Events\r\ndescription: RDS - Session logoff succeeded\r\nauthors: \r\n  - Catarina de Faria\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Information\r\n    to: Event.UserData.EventXML\r\n\r\nfilter:\r\n  condition: rdp_session_logoff\r\n\r\n  rdp_session_logoff:\r\n      Event.System.EventID: 23\r\n      Event.System.Channel: Microsoft-Windows-TerminalServices-LocalSessionManager/Operational\r\n\r\n"},{"path":"rdp_attacks\\eid_22_file_explorer_shell_appeared_in_rdp_session.yml","content":"---\r\ntitle: RDS - File Explorer shell start notification received\r\ngroup: RDP Events\r\ndescription: The Explorer shell has been successfully started (the Windows desktop appears in the userâ€™s RDP session).\r\nauthors:\r\n  - Catarina de Faria\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Information\r\n    to: Event.UserData.EventXML\r\n\r\nfilter:\r\n  condition: desktop_appeared and not local\r\n\r\n  desktop_appeared:\r\n    Event.System.EventID: 22\r\n    Event.System.Channel: Microsoft-Windows-TerminalServices-LocalSessionManager/Operational\r\n  local:\r\n    Event.UserData.EventXML.Address: \"LOCAL\"\r\n"},{"path":"rdp_attacks\\eid_21_rdp_session_logon_succeeded.yml","content":"---\r\ntitle: RDS - Session logon succeeded\r\ngroup: RDP Events\r\ndescription: RDS - Session logon succeeded\r\ndate: 2023-07-03\r\nversion: 1.0\r\nauthors:\r\n  - Catarina de Faria\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Channel\r\n    to : Event.System.Channel\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Information\r\n    to: Event.UserData.EventXML\r\n\r\nfilter:\r\n  condition: logon_succeeded and not local\r\n\r\n  logon_succeeded:\r\n    Event.System.EventID: 21\r\n    Event.System.Channel: Microsoft-Windows-TerminalServices-LocalSessionManager/Operational\r\n  local:\r\n    Event.UserData.EventXML.Address: \"LOCAL\"\r\n"}]