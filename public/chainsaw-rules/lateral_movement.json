[{"path":"lateral_movement\\unlock_logon.yml","content":"---\r\ntitle: Unlock Logon\r\ngroup: Lateral Movement\r\ndescription: An Unlock based logon.\r\nauthors:\r\n  - FranticTyping\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User\r\n    to: Event.EventData.TargetUserName\r\n  - name: Logon Type\r\n    to: Event.EventData.LogonType\r\n  - name: IP Address\r\n    to: Event.EventData.IpAddress\r\n\r\n\r\nfilter:\r\n  condition: unlock and not local_ips_or_machine_accounts\r\n\r\n  unlock:\r\n    Event.System.EventID: 4624\r\n    Event.EventData.LogonType: 7\r\n  local_ips_or_machine_accounts:\r\n    - Event.EventData.IpAddress:\r\n        - '-'\r\n        - 127.0.0.1\r\n        - ::1\r\n    - Event.EventData.TargetUserName: $*\r\n"},{"path":"lateral_movement\\T1021.004 - Lateral Movement via SSH.yml","content":"---\r\ntitle: T1021.004 - Lateral Movement via SSH\r\ngroup: Lateral Movement\r\ndescription: SSH traffic was detected\r\nauthors:\r\n  - JakePeralta\r\n# Requires 'Audit Filtering Platform Connection' to be turned on in the GPO\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: Process Name\r\n    to: Event.EventData.Application\r\n  - name: Process ID\r\n    to: Event.EventData.ProcessID\r\n  - name: Interface Index\r\n    to: Event.EventData.InterfaceIndex\r\n  - name: Source Address\r\n    to: Event.EventData.SourceAddress\r\n  - name: Source Port\r\n    to: Event.EventData.SourcePort\r\n  - name: Dest Address\r\n    to: Event.EventData.DestAddress\r\n  - name: Dest Port\r\n    to: Event.EventData.DestPort\r\n\r\n\r\nfilter:\r\n  Event.System.Channel: Security\r\n  Event.System.Provider: Microsoft-Windows-Security-Auditing\r\n  Event.System.EventID: 5156\r\n  Event.EventData.DestPort: '22'\r\n"},{"path":"lateral_movement\\service_logon.yml","content":"---\r\ntitle: Service Logon\r\ngroup: Lateral Movement\r\ndescription: An Service based logon\r\nauthors:\r\n  - FranticTyping\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User\r\n    to: Event.EventData.TargetUserName\r\n  - name: Logon Type\r\n    to: Event.EventData.LogonType\r\n  - name: IP Address\r\n    to: Event.EventData.IpAddress\r\n\r\n\r\nfilter:\r\n  condition: service and not local_ips_or_machine_accounts\r\n\r\n  service:\r\n    Event.System.EventID: 4624\r\n    Event.EventData.LogonType: 5\r\n  local_ips_or_machine_accounts:\r\n    - Event.EventData.IpAddress:\r\n        - '-'\r\n        - 127.0.0.1\r\n        - ::1\r\n    - Event.EventData.TargetUserName: $*\r\n"},{"path":"lateral_movement\\rdp_logon.yml","content":"---\r\ntitle: RDP Logon\r\ngroup: Lateral Movement\r\ndescription: An RDP based logon.\r\nauthors:\r\n  - FranticTyping\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User\r\n    to: Event.EventData.TargetUserName\r\n  - name: Logon Type\r\n    to: Event.EventData.LogonType\r\n  - name: IP Address\r\n    to: Event.EventData.IpAddress\r\n\r\n\r\nfilter:\r\n  condition: rdp and not local_ips_or_machine_accounts\r\n\r\n  rdp:\r\n    Event.System.EventID: 4624\r\n    Event.EventData.LogonType: 10\r\n  local_ips_or_machine_accounts:\r\n    - Event.EventData.IpAddress:\r\n        - '-'\r\n        - 127.0.0.1\r\n        - ::1\r\n    - Event.EventData.TargetUserName: $*\r\n"},{"path":"lateral_movement\\network_logon.yml","content":"---\r\ntitle: Network Logon\r\ngroup: Lateral Movement\r\ndescription: An Network based logon\r\nauthors:\r\n  - FranticTyping\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User\r\n    to: Event.EventData.TargetUserName\r\n  - name: Logon Type\r\n    to: Event.EventData.LogonType\r\n  - name: IP Address\r\n    to: Event.EventData.IpAddress\r\n\r\n\r\nfilter:\r\n  condition: network and not local_ips_or_machine_accounts\r\n\r\n  network:\r\n    Event.System.EventID: 4624\r\n    Event.EventData.LogonType: 3\r\n  local_ips_or_machine_accounts:\r\n    - Event.EventData.IpAddress:\r\n        - '-'\r\n        - 127.0.0.1\r\n        - ::1\r\n    - Event.EventData.TargetUserName: $*\r\n"},{"path":"lateral_movement\\interactive_logon.yml","content":"---\r\ntitle: Interactive Logon\r\ngroup: Lateral Movement\r\ndescription: An Interactive based logon.\r\nauthors:\r\n  - FranticTyping\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User\r\n    to: Event.EventData.TargetUserName\r\n  - name: Logon Type\r\n    to: Event.EventData.LogonType\r\n  - name: IP Address\r\n    to: Event.EventData.IpAddress\r\n\r\n\r\nfilter:\r\n  condition: interactive and not local_ips_or_machine_accounts\r\n\r\n  interactive:\r\n    Event.System.EventID: 4624\r\n    Event.EventData.LogonType: 2\r\n  local_ips_or_machine_accounts:\r\n    - Event.EventData.IpAddress:\r\n        - '-'\r\n        - 127.0.0.1\r\n        - ::1\r\n    - Event.EventData.TargetUserName: $*\r\n"},{"path":"lateral_movement\\batch_logon.yml","content":"---\r\ntitle: Batch Logon\r\ngroup: Lateral Movement\r\ndescription: An Batch based logon.\r\nauthors:\r\n  - FranticTyping\r\n\r\n\r\nkind: evtx\r\nlevel: info\r\nstatus: stable\r\ntimestamp: Event.System.TimeCreated\r\n\r\n\r\nfields:\r\n  - name: Event ID\r\n    to: Event.System.EventID\r\n  - name: Record ID\r\n    to: Event.System.EventRecordID\r\n  - name: Computer\r\n    to: Event.System.Computer\r\n  - name: User\r\n    to: Event.EventData.TargetUserName\r\n  - name: Logon Type\r\n    to: Event.EventData.LogonType\r\n  - name: IP Address\r\n    to: Event.EventData.IpAddress\r\n\r\n\r\nfilter:\r\n  condition: batch and not local_ips_or_machine_accounts\r\n\r\n  batch:\r\n    Event.System.EventID: 4624\r\n    Event.EventData.LogonType: 4\r\n  local_ips_or_machine_accounts:\r\n    - Event.EventData.IpAddress:\r\n        - '-'\r\n        - 127.0.0.1\r\n        - ::1\r\n    - Event.EventData.TargetUserName: $*\r\n"}]